<HTML>
<HEAD>
<TITLE>FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses</TITLE>
<META name="HTML-Generator" content="Dymola">
<META name="description" content="&quot;Base classes (not generally for direct use)&quot;">
<style type="text/css">
*       { font-size: 10pt; font-family: Arial,sans-serif; }
pre     { font-size:  9pt; font-family: Courier,monospace;}
h4      { font-size: 10pt; font-weight: bold; color: green; }
h3      { font-size: 11pt; font-weight: bold; color: green; }
h2      { font-size: 13pt; font-weight: bold; color: green; }
address {                  font-weight: normal} 
td      { solid #000; vertical-align:top; }
th      { solid #000; vertical-align:top; font-weight: bold; }
table   { solid #000; border-collapse: collapse;}
</style>
</HEAD>
<BODY><P>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE BaseClasses<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses"></A><A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers"
>FCSys.WorkInProgress.Blocks.Discrete.Controllers</A>.BaseClasses</H2>
<B>Base classes (not generally for direct use)</B>
<P>
<P><H3>Information</H3></P>
Extends from <A HREF="file:////opt/dymola/Modelica/Library/Modelica 3.2/help/Modelica_Icons_BasesPackage.html#Modelica.Icons.BasesPackage"
>Modelica.Icons.BasesPackage</A> (Icon for packages containing base classes).
<P><H3>Package Content</H3><p>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2 >
<TR><TH >Name</TH><TH>Description</TH></TR>
<TR><TD><IMG SRC="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.QPSolverS.png" ALT="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.QPSolver" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.QPSolver"
>QPSolver</A>
</TD><TD>Dynamic quadratic programming problem solver</TD></TR>
<TR><TD><IMG SRC="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.GetInfoS.png" ALT="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.GetInfo" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.GetInfo"
>GetInfo</A>
</TD><TD>Get information about the solution of a quadratic programming problem to find <b>x</b> that minimizes:
  <ul><li><b>0.5 x<sup>T</sup> H x + x<sup>T</sup> J</b></li></ul>
  <p>Subject to:
  <ul>
  <li><b>x<sub>min</sub> &le; x &le; x<sub>max</sub></b></li>
  <li><b>Gx<sub>min</sub> &le; G x &le; Gx<sub>max</sub></b></li>
  </ul></TD></TR>
<TR><TD><IMG SRC="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.GetInfoS.png" ALT="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.Hotstart" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.Hotstart"
>Hotstart</A>
</TD><TD>Restart a quadratic programming problem to find <b>x</b> that minimizes:
  <ul><li><b>0.5 x<sup>T</sup> H x + x<sup>T</sup> J</b></li></ul>
  <p>Subject to:
  <ul>
  <li><b>x<sub>min</sub> &le; x &le; x<sub>max</sub></b></li>
  <li><b>Gx<sub>min</sub> &le; G x &le; Gx<sub>max</sub></b></li>
  </ul></TD></TR>
<TR><TD><IMG SRC="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.GetInfoS.png" ALT="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.Init" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.Init"
>Init</A>
</TD><TD>Initialize a quadratic programming problem to find <b>x</b> that minimizes:
  <ul><li><b>0.5 x<sup>T</sup> H x + x<sup>T</sup> J</b></li></ul>
  <p>Subject to:
  <ul>
  <li><b>x<sub>min</sub> &le; x &le; x<sub>max</sub></b></li>
  <li><b>Gx<sub>min</sub> &le; G x &le; Gx<sub>max</sub></b></li>
  </ul></TD></TR>
<TR><TD><A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.qpOASESmem"
>qpOASESmem</A>
</TD><TD>Construct/destruct a memory object for a quadratic programming problem</TD></TR>
<TR><TD><IMG SRC="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.ObservabilityMatrixS.png" ALT="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.ObservabilityMatrix" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.ObservabilityMatrix"
>ObservabilityMatrix</A>
</TD><TD>Calculate observability matrix</TD></TR>
<TR><TD><IMG SRC="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.ObservabilityMatrixS.png" ALT="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.ThetaPredictionMatrix" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.ThetaPredictionMatrix"
>ThetaPredictionMatrix</A>
</TD><TD>Calculate Theta prediction matrix</TD></TR>
<TR><TD><IMG SRC="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.ObservabilityMatrixS.png" ALT="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.YPredictionMatrix" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.YPredictionMatrix"
>YPredictionMatrix</A>
</TD><TD>Calculate Y prediction matrix</TD></TR>
</TABLE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE QPSolver<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.QPSolverI.png" ALT="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.QPSolver" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.QPSolver"></A><A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses"
>FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses</A>.QPSolver</H2>
<B>Dynamic quadratic programming problem solver</B><p>
<IMG SRC="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.QPSolverD.png" ALT="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.QPSolver">
<P><H3>Information</H3></P>
<PRE></pre><p>Dynamically solves a quadratic programming problem to find <b>x</b> that minimizes:
  <ul><li><b>0.5 x<sup>T</sup> H x + x<sup>T</sup> J</b></li></ul>
  <p>Subject to:
  <ul>
  <li><b>y_min &le; y &le; y_max</b></li>
  <li><b>xA_min &le; A x &le; xA_max</b></li>
  </ul>
  where <b>x</b> consists of <b>n_x/n_y</b> repetitions of <b>y</b> (<b>x = {y, y, &hellip;}</b>).  <b>n_y</b> is a parameter and <b>n_x</b> is determined by the size of <b>H</b>.
  <p><b>y</b> is a dynamic output.  <b>H</b> and <b>A</b> are parameters.  <b>J</b>, <b>y_min</b>, <b>y_max</b>, <b>xA_min</b>, and <b>xA_max</b> can be chosen as parameters or as dynamic inputs.</p><pre></PRE><P>
Extends from <A HREF="FCSys_WorkInProgress_Blocks_Discrete_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.BaseClasses.DiscreteBlock"
>FCSys.WorkInProgress.Blocks.Discrete.BaseClasses.DiscreteBlock</A> (Base class of discrete blocks).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>&nbsp;</TD><TD>samplePeriod</TD><TD>&nbsp;</TD><TD>Sample period of species</TD></TR>
<TR><TD>&nbsp;</TD><TD>startTime</TD><TD>0</TD><TD>First sample time instant</TD></TR>
<TR><TD>Real</TD><TD>H[:, size(H, 1)]</TD><TD>&nbsp;</TD><TD>Hessian matrix</TD></TR>
<TR><TD>Integer</TD><TD>n_y</TD><TD>1</TD><TD>Length of the output vector</TD></TR>
<TR><TD>Boolean</TD><TD>JAsParam</TD><TD>false</TD><TD>Use parameter for J</TD></TR>
<TR><TD>Real</TD><TD>J[n_x]</TD><TD>zeros(n_x)</TD><TD>Jacobian vector</TD></TR>
<TR><TD>Boolean</TD><TD>yMinAsParam</TD><TD>true</TD><TD>Use parameter for y_min</TD></TR>
<TR><TD>Real</TD><TD>y_min[n_y]</TD><TD>-ones(n_y)</TD><TD>Lower bound of output</TD></TR>
<TR><TD>Boolean</TD><TD>yMaxAsParam</TD><TD>true</TD><TD>Use parameter for y_max</TD></TR>
<TR><TD>Real</TD><TD>y_max[n_y]</TD><TD>ones(n_y)</TD><TD>Upper bound of output</TD></TR>
<TR><TD>Real</TD><TD>G[:, size(H, 1)]</TD><TD>&nbsp;</TD><TD>Constraint matrix</TD></TR>
<TR><TD>Boolean</TD><TD>GxMinAsParam</TD><TD>true</TD><TD>Use parameter for Gx<sub>min</sub></TD></TR>
<TR><TD>Real</TD><TD>Gx_min[size(G, 1)]</TD><TD>-ones(size(G, 1))</TD><TD>Lower bound of <b>G x</b></TD></TR>
<TR><TD>Boolean</TD><TD>AxMaxAsParam</TD><TD>true</TD><TD>Use parameter for Gx<sub>max</sub></TD></TR>
<TR><TD>Real</TD><TD>Gx_max[size(G, 1)]</TD><TD>ones(size(G, 1))</TD><TD>Upper bound of <b>G x</b></TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>input <A HREF="FCSys_Connectors.html#FCSys.Connectors.RealInput"
>RealInput</A></TD><TD>J_set[n_x]</TD><TD>Jacobian vector of the quadratic programming problem</TD></TR>
<TR><TD>input <A HREF="FCSys_Connectors.html#FCSys.Connectors.RealInput"
>RealInput</A></TD><TD>y_min_set[n_y]</TD><TD>Lower bound of output</TD></TR>
<TR><TD>input <A HREF="FCSys_Connectors.html#FCSys.Connectors.RealInput"
>RealInput</A></TD><TD>y_max_set[n_y]</TD><TD>Upper bound of output</TD></TR>
<TR><TD>input <A HREF="FCSys_Connectors.html#FCSys.Connectors.RealInput"
>RealInput</A></TD><TD>Gx_min_set[n_bG]</TD><TD>Lower bound of <b>A x</b></TD></TR>
<TR><TD>input <A HREF="FCSys_Connectors.html#FCSys.Connectors.RealInput"
>RealInput</A></TD><TD>Gx_max_set[n_bG]</TD><TD>Upper bound of <b>A x</b></TD></TR>
<TR><TD>output <A HREF="FCSys_Connectors.html#FCSys.Connectors.RealOutput"
>RealOutput</A></TD><TD>y[n_y]</TD><TD>Solution of the optimization</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">block</font> QPSolver <font color="darkgreen">&quot;Dynamic quadratic programming problem solver&quot;</font>
  <font color="blue">extends </font><A HREF="FCSys_WorkInProgress_Blocks_Discrete_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.BaseClasses.DiscreteBlock"
>FCSys.WorkInProgress.Blocks.Discrete.BaseClasses.DiscreteBlock</A>;
  <font color="blue">parameter </font>Real H[:, <font color="red">size</font>(H, 1)] <font color="darkgreen">&quot;Hessian matrix&quot;</font>;
  <font color="blue">parameter </font>Integer n_y=1 <font color="darkgreen">&quot;Length of the output vector&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Integer n_x=<font color="red">size</font>(H, 1) <font color="darkgreen">
    &quot;</pre>Number of degrees of freedom (i.e., length of <b>x</b> vector)<pre>&quot;</font>;
  <font color="blue">parameter </font>Boolean JAsParam=false <font color="darkgreen">&quot;Use parameter for J&quot;</font>;
  <font color="blue">parameter </font>Real J[n_x]=<font color="red">zeros</font>(n_x) <font color="darkgreen">&quot;Jacobian vector&quot;</font>;
  <font color="blue">parameter </font>Boolean yMinAsParam=true <font color="darkgreen">&quot;Use parameter for y_min&quot;</font>;
  <font color="blue">parameter </font>Real y_min[n_y]=-<font color="red">ones</font>(n_y) <font color="darkgreen">&quot;Lower bound of output&quot;</font>;
  <font color="blue">parameter </font>Boolean yMaxAsParam=true <font color="darkgreen">&quot;Use parameter for y_max&quot;</font>;
  <font color="blue">parameter </font>Real y_max[n_y]=<font color="red">ones</font>(n_y) <font color="darkgreen">&quot;Upper bound of output&quot;</font>;
  <font color="blue">parameter </font>Real G[:, <font color="red">size</font>(H, 1)] <font color="darkgreen">&quot;Constraint matrix&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Integer n_bG=<font color="red">size</font>(G, 1);
  <font color="blue">parameter </font>Boolean GxMinAsParam=true <font color="darkgreen">
    &quot;</pre>Use parameter for Gx<sub>min</sub><pre>&quot;</font>;
  <font color="blue">parameter </font>Real Gx_min[<font color="red">size</font>(G, 1)]=-<font color="red">ones</font>(<font color="red">size</font>(G, 1)) <font color="darkgreen">
    &quot;</pre>Lower bound of <b>G x</b><pre>&quot;</font>;
  <font color="blue">parameter </font>Boolean AxMaxAsParam=true <font color="darkgreen">
    &quot;</pre>Use parameter for Gx<sub>max</sub><pre>&quot;</font>;
  <font color="blue">parameter </font>Real Gx_max[<font color="red">size</font>(G, 1)]=<font color="red">ones</font>(<font color="red">size</font>(G, 1)) <font color="darkgreen">
    &quot;</pre>Upper bound of <b>G x</b><pre>&quot;</font>;
<textblock type="annotcomp" expanded="false">  <A HREF="FCSys_Connectors.html#FCSys.Connectors.RealInput"
>Connectors.RealInput</A> J_set[n_x] <font color="blue">if </font>(<font color="blue">not </font>JAsParam) <font color="darkgreen">
    &quot;Jacobian vector of the quadratic programming problem&quot;</font>;
  <A HREF="FCSys_Connectors.html#FCSys.Connectors.RealInput"
>Connectors.RealInput</A> y_min_set[n_y] <font color="blue">if </font>(<font color="blue">not </font>yMinAsParam) <font color="darkgreen">
    &quot;Lower bound of output&quot;</font>;
  <A HREF="FCSys_Connectors.html#FCSys.Connectors.RealInput"
>Connectors.RealInput</A> y_max_set[n_y] <font color="blue">if </font>(<font color="blue">not </font>yMaxAsParam) <font color="darkgreen">
    &quot;Upper bound of output&quot;</font>;
  <A HREF="FCSys_Connectors.html#FCSys.Connectors.RealInput"
>Connectors.RealInput</A> Gx_min_set[n_bG] <font color="blue">if </font>(<font color="blue">not </font>GxMinAsParam) <font color="darkgreen">
    &quot;</pre>Lower bound of <b>A x</b><pre>&quot;</font>;
  <A HREF="FCSys_Connectors.html#FCSys.Connectors.RealInput"
>Connectors.RealInput</A> Gx_max_set[n_bG] <font color="blue">if </font>(<font color="blue">not </font>AxMaxAsParam) <font color="darkgreen">
    &quot;</pre>Upper bound of <b>A x</b><pre>&quot;</font>;
  <A HREF="FCSys_Connectors.html#FCSys.Connectors.RealOutput"
>Connectors.RealOutput</A> y[n_y] <font color="darkgreen">&quot;Solution of the optimization&quot;</font>;</textblock>

<font color="blue">protected </font>
  Real x_min[n_x] <font color="darkgreen">&quot;</pre>Lower bound of <b>x</b><pre>&quot;</font>;
  Real x_max[n_x] <font color="darkgreen">&quot;</pre>Upper bound of <b>x</b><pre>&quot;</font>;
  Real obj;
  Real x[n_x] <font color="darkgreen">&quot;Solution of quadratic programming problem&quot;</font>;
  Real z[n_x + n_bG];
  Integer n_WSR <font color="darkgreen">&quot;Number of working set recalculations&quot;</font>;
  Integer ret <font color="darkgreen">&quot;Return status&quot;</font>;
  <A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.qpOASESmem"
>FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.qpOASESmem</A> mem=<font color="red">
      qpOASESmem</font>(
      mode=<font color="blue">if </font>n_bG == 0<font color="blue"> then </font>&quot;Simple bounds&quot;<font color="blue"> else </font>&quot;Normal&quot;,
      n_x=n_x,
      n_bG=n_bG) <font color="darkgreen">&quot;Memory object for the quadratic programming problem&quot;</font>;
<textblock type="annotcomp" expanded="false">  <A HREF="FCSys_Connectors.html#FCSys.Connectors.RealInput"
>Connectors.RealInput</A> J_internal[n_x] <font color="darkgreen">
    &quot;Internal connector for the Jacobian vector of the quadratic problem&quot;</font>;
  <A HREF="FCSys_Connectors.html#FCSys.Connectors.RealInput"
>Connectors.RealInput</A> y_min_internal[n_y] <font color="darkgreen">
    &quot;Internal connector for lower bound of output&quot;</font>;
  <A HREF="FCSys_Connectors.html#FCSys.Connectors.RealInput"
>Connectors.RealInput</A> y_max_internal[n_y] <font color="darkgreen">
    &quot;Internal connector for upper bound of output&quot;</font>;
  <A HREF="FCSys_Connectors.html#FCSys.Connectors.RealInput"
>Connectors.RealInput</A> Gx_min_internal[n_bG] <font color="darkgreen">
    &quot;</pre>Internal connector for lower bound of <b>A x</b><pre>&quot;</font>;
  <A HREF="FCSys_Connectors.html#FCSys.Connectors.RealInput"
>Connectors.RealInput</A> Gx_max_internal[n_bG] <font color="darkgreen">
    &quot;</pre>Internal connector for upper bound of <b>A x</b><pre>&quot;</font>;</textblock>

<font color="blue">algorithm </font>
  <font color="blue">when </font>(sampleTrigger)<font color="blue"> then</font>
    <font color="blue">for </font>i<font color="blue"> in </font>1:<font color="red">integer</font>(n_x/n_y)<font color="blue"> loop</font>
      x_min[n_y*(i - 1) + 1:n_y*i] := y_min_internal;
      x_max[n_y*(i - 1) + 1:n_y*i] := y_max_internal;
    <font color="blue">end for</font>;
    <font color="blue">if </font>(firstTrigger)<font color="blue"> then</font>
      <font color="red">FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.Init</font>(
        mem=mem,
        H=H,
        J=J_internal,
        G=G,
        x_min=x_min,
        x_max=x_max,
        Gx_min=Gx_min_internal,
        Gx_max=Gx_max_internal);
    <font color="blue">else</font>
      <font color="red">FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.Hotstart</font>(
        mem=mem,
        J=J_internal,
        x_min=x_min,
        x_max=x_max,
        Gx_min=Gx_min_internal,
        Gx_max=Gx_max_internal);
    <font color="blue">end if</font>;
    (obj,x,z,n_WSR,ret) := <font color="red">
      FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.GetInfo</font>(
      mem=mem,
      n_x=n_x,
      n_bG=n_bG);
    y := x[1:n_y];
  <font color="blue">end when</font>;

<font color="blue">equation </font>
  <font color="blue">if </font>JAsParam<font color="blue"> then</font>
    J_internal = J;
  <font color="blue">end if</font>;
  <font color="blue">if </font>yMinAsParam<font color="blue"> then</font>
    y_min_internal = y_min;
  <font color="blue">end if</font>;
  <font color="blue">if </font>yMaxAsParam<font color="blue"> then</font>
    y_max_internal = y_max;
  <font color="blue">end if</font>;
  <font color="blue">if </font>GxMinAsParam<font color="blue"> then</font>
    Gx_min_internal = Gx_min;
  <font color="blue">end if</font>;
  <font color="blue">if </font>AxMaxAsParam<font color="blue"> then</font>
    Gx_max_internal = Gx_max;
  <font color="blue">end if</font>;
<textblock type="annotconnect" expanded="false">  <font color="red">connect</font>(y_max_internal, y_max_set);
  <font color="red">connect</font>(y_min_internal, y_min_set);
  <font color="red">connect</font>(Gx_max_internal, Gx_max_set);
  <font color="red">connect</font>(Gx_min_internal, Gx_min_set);
  <font color="red">connect</font>(J_internal, J_set);</textblock>
<textblock type="annotcomp" expanded="false"><font color="blue">end </font>QPSolver;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE GetInfo<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.GetInfoI.png" ALT="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.GetInfo" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.GetInfo"></A><A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses"
>FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses</A>.GetInfo</H2>
<B>Get information about the solution of a quadratic programming problem to find <b>x</b> that minimizes:
  <ul><li><b>0.5 x<sup>T</sup> H x + x<sup>T</sup> J</b></li></ul>
  <p>Subject to:
  <ul>
  <li><b>x<sub>min</sub> &le; x &le; x<sub>max</sub></b></li>
  <li><b>Gx<sub>min</sub> &le; G x &le; Gx<sub>max</sub></b></li>
  </ul></B><p>
<P><H3>Information</H3></P>
Extends from <A HREF="file:////opt/dymola/Modelica/Library/Modelica 3.2/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A> (Icon for functions).
<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.qpOASESmem"
>qpOASESmem</A></TD><TD>mem</TD><TD>&nbsp;</TD><TD>Quadratic problem object</TD></TR>
<TR><TD>Integer</TD><TD>n_x</TD><TD>&nbsp;</TD><TD>Number of degrees of freedom (i.e., length of <b>x</b> vector)</TD></TR>
<TR><TD>Integer</TD><TD>n_bG</TD><TD>0</TD><TD>Number of bounds of the form <b>Gx<sub>min</sub> &le; G x &le; Gx<sub>max</sub></b></TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>obj</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>x[n_x]</TD><TD>Solution of problem</TD></TR>
<TR><TD>Real</TD><TD>y[n_x + n_bG]</TD><TD>&nbsp;</TD></TR>
<TR><TD>Integer</TD><TD>n_WSR</TD><TD>Number of working set recalculations</TD></TR>
<TR><TD>Integer</TD><TD>ret</TD><TD>Return status</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> GetInfo <font color="darkgreen">&quot;</pre>Get information about the solution of a quadratic programming problem to find <b>x</b> that minimizes:
  <ul><li><b>0.5 x<sup>T</sup> H x + x<sup>T</sup> J</b></li></ul>
  <p>Subject to:
  <ul>
  <li><b>x<sub>min</sub> &le; x &le; x<sub>max</sub></b></li>
  <li><b>Gx<sub>min</sub> &le; G x &le; Gx<sub>max</sub></b></li>
  </ul><pre>&quot;</font>
  <font color="blue">extends </font><A HREF="file:////opt/dymola/Modelica/Library/Modelica 3.2/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A>;
  <font color="blue">input </font><A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.qpOASESmem"
>qpOASESmem</A> mem <font color="darkgreen">&quot;Quadratic problem object&quot;</font>;
  <font color="blue">input </font>Integer n_x <font color="darkgreen">
    &quot;</pre>Number of degrees of freedom (i.e., length of <b>x</b> vector)<pre>&quot;</font>;
  <font color="blue">input </font>Integer n_bG=0 <font color="darkgreen">
    &quot;</pre>Number of bounds of the form <b>Gx<sub>min</sub> &le; G x &le; Gx<sub>max</sub></b><pre>&quot;</font>;
  <font color="blue">output </font>Real obj;
  <font color="blue">output </font>Real[n_x] x <font color="darkgreen">&quot;Solution of problem&quot;</font>;
  <font color="blue">output </font>Real[n_x + n_bG] y;
  <font color="blue">output </font>Integer n_WSR <font color="darkgreen">&quot;Number of working set recalculations&quot;</font>;
  <font color="blue">output </font>Integer ret <font color="darkgreen">&quot;Return status&quot;</font>;
<font color="blue">external</font>&quot;C&quot; ret = <font color="red">qpoases_getInfo</font>(
    mem,
    obj,
    x,
    y,
    n_WSR);
<textblock type="annotcomp" expanded="false">  <font color="darkgreen">/*
   Note:  As of Dymola 7.4, may need to use this in Windows:
    Library=&quot;FCSys/bin/qpOASES&quot;
   and this in Linux:
    Library=&quot;qpOASES&quot;
  */</font>

<font color="blue">end </font>GetInfo;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Hotstart<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.GetInfoI.png" ALT="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.Hotstart" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.Hotstart"></A><A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses"
>FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses</A>.Hotstart</H2>
<B>Restart a quadratic programming problem to find <b>x</b> that minimizes:
  <ul><li><b>0.5 x<sup>T</sup> H x + x<sup>T</sup> J</b></li></ul>
  <p>Subject to:
  <ul>
  <li><b>x<sub>min</sub> &le; x &le; x<sub>max</sub></b></li>
  <li><b>Gx<sub>min</sub> &le; G x &le; Gx<sub>max</sub></b></li>
  </ul></B><p>
<P><H3>Information</H3></P>
Extends from <A HREF="file:////opt/dymola/Modelica/Library/Modelica 3.2/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A> (Icon for functions).
<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.qpOASESmem"
>qpOASESmem</A></TD><TD>mem</TD><TD>&nbsp;</TD><TD>Quadratic problem object</TD></TR>
<TR><TD>Real</TD><TD>H[:, :]</TD><TD>zeros(0, 0)</TD><TD>Hessian matrix of the quadratic problem</TD></TR>
<TR><TD>Real</TD><TD>J[:]</TD><TD>zeros(0)</TD><TD>Jacobian vector of the quadratic problem</TD></TR>
<TR><TD>Real</TD><TD>G[:, :]</TD><TD>zeros(0, 0)</TD><TD>Constraint matrix of the quadratic problem</TD></TR>
<TR><TD>Real</TD><TD>x_min[:]</TD><TD>zeros(0)</TD><TD>Lower bound of <b>x</b></TD></TR>
<TR><TD>Real</TD><TD>x_max[:]</TD><TD>zeros(0)</TD><TD>Upper bound of <b>x</b></TD></TR>
<TR><TD>Real</TD><TD>Gx_min[:]</TD><TD>zeros(0)</TD><TD>Lower bound of <b>G x</b></TD></TR>
<TR><TD>Real</TD><TD>Gx_max[:]</TD><TD>zeros(0)</TD><TD>Upper bound of <b>G x</b></TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Integer</TD><TD>ret</TD><TD>Return status</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> Hotstart <font color="darkgreen">&quot;</pre>Restart a quadratic programming problem to find <b>x</b> that minimizes:
  <ul><li><b>0.5 x<sup>T</sup> H x + x<sup>T</sup> J</b></li></ul>
  <p>Subject to:
  <ul>
  <li><b>x<sub>min</sub> &le; x &le; x<sub>max</sub></b></li>
  <li><b>Gx<sub>min</sub> &le; G x &le; Gx<sub>max</sub></b></li>
  </ul><pre>&quot;</font>
  <font color="blue">extends </font><A HREF="file:////opt/dymola/Modelica/Library/Modelica 3.2/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A>;
  <font color="blue">input </font><A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.qpOASESmem"
>qpOASESmem</A> mem <font color="darkgreen">&quot;Quadratic problem object&quot;</font>;
  <font color="blue">input </font>Real[:, :] H=<font color="red">zeros</font>(0, 0) <font color="darkgreen">&quot;Hessian matrix of the quadratic problem&quot;</font>;
  <font color="blue">input </font>Real[:] J=<font color="red">zeros</font>(0) <font color="darkgreen">&quot;Jacobian vector of the quadratic problem&quot;</font>;
  <font color="blue">input </font>Real[:, :] G=<font color="red">zeros</font>(0, 0) <font color="darkgreen">&quot;Constraint matrix of the quadratic problem&quot;</font>;
  <font color="blue">input </font>Real[:] x_min=<font color="red">zeros</font>(0) <font color="darkgreen">&quot;</pre>Lower bound of <b>x</b><pre>&quot;</font>;
  <font color="blue">input </font>Real[:] x_max=<font color="red">zeros</font>(0) <font color="darkgreen">&quot;</pre>Upper bound of <b>x</b><pre>&quot;</font>;
  <font color="blue">input </font>Real[:] Gx_min=<font color="red">zeros</font>(0) <font color="darkgreen">&quot;</pre>Lower bound of <b>G x</b><pre>&quot;</font>;
  <font color="blue">input </font>Real[:] Gx_max=<font color="red">zeros</font>(0) <font color="darkgreen">&quot;</pre>Upper bound of <b>G x</b><pre>&quot;</font>;
  <font color="blue">output </font>Integer ret <font color="darkgreen">&quot;Return status&quot;</font>;
<font color="blue">external</font>&quot;C&quot; ret = <font color="red">qpoases_hotstart</font>(
    mem,
    H,
    J,
    G,
    x_min,
    x_max,
    Gx_min,
    Gx_max);
<textblock type="annotcomp" expanded="false">  <font color="darkgreen">/*
   Note:  As of Dymola 7.4, may need to use this in Windows:
    Library=&quot;FCSys/bin/qpOASES&quot;
   and this in Linux:
    Library=&quot;qpOASES&quot;
  */</font>

<font color="blue">end </font>Hotstart;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Init<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.GetInfoI.png" ALT="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.Init" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.Init"></A><A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses"
>FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses</A>.Init</H2>
<B>Initialize a quadratic programming problem to find <b>x</b> that minimizes:
  <ul><li><b>0.5 x<sup>T</sup> H x + x<sup>T</sup> J</b></li></ul>
  <p>Subject to:
  <ul>
  <li><b>x<sub>min</sub> &le; x &le; x<sub>max</sub></b></li>
  <li><b>Gx<sub>min</sub> &le; G x &le; Gx<sub>max</sub></b></li>
  </ul></B><p>
<P><H3>Information</H3></P>
Extends from <A HREF="file:////opt/dymola/Modelica/Library/Modelica 3.2/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A> (Icon for functions).
<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.qpOASESmem"
>qpOASESmem</A></TD><TD>mem</TD><TD>&nbsp;</TD><TD>Quadratic problem object</TD></TR>
<TR><TD>Real</TD><TD>H[:, size(H, 1)]</TD><TD>&nbsp;</TD><TD>Hessian matrix of the quadratic problem</TD></TR>
<TR><TD>Real</TD><TD>J[:]</TD><TD>&nbsp;</TD><TD>Jacobian vector of the quadratic problem</TD></TR>
<TR><TD>Real</TD><TD>G[:, :]</TD><TD>zeros(0, 0)</TD><TD>Constraint matrix of the quadratic problem</TD></TR>
<TR><TD>Real</TD><TD>x_min[:]</TD><TD>zeros(0)</TD><TD>Lower bound of <b>x</b></TD></TR>
<TR><TD>Real</TD><TD>x_max[:]</TD><TD>zeros(0)</TD><TD>Upper bound of <b>x</b></TD></TR>
<TR><TD>Real</TD><TD>Gx_min[:]</TD><TD>zeros(0)</TD><TD>Lower bound of <b>G x</b></TD></TR>
<TR><TD>Real</TD><TD>Gx_max[:]</TD><TD>zeros(0)</TD><TD>Upper bound of <b>G x</b></TD></TR>
<TR><TD>Integer</TD><TD>n_x</TD><TD>size(x_min, 1)</TD><TD>Number of degrees of freedom (i.e., length of <b>x</b> vector)</TD></TR>
<TR><TD>Integer</TD><TD>n_bG</TD><TD>size(Gx_min, 1)</TD><TD>Number of bounds of the form <b>Gx<sub>min</sub> &le; G x &le; Gx<sub>max</sub></b></TD></TR>
<TR><TD>Integer</TD><TD>n_WSR_max</TD><TD>10</TD><TD>Maximum number of working set recalculations</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Integer</TD><TD>ret</TD><TD>Return status</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> Init <font color="darkgreen">&quot;</pre>Initialize a quadratic programming problem to find <b>x</b> that minimizes:
  <ul><li><b>0.5 x<sup>T</sup> H x + x<sup>T</sup> J</b></li></ul>
  <p>Subject to:
  <ul>
  <li><b>x<sub>min</sub> &le; x &le; x<sub>max</sub></b></li>
  <li><b>Gx<sub>min</sub> &le; G x &le; Gx<sub>max</sub></b></li>
  </ul><pre>&quot;</font>
  <font color="blue">extends </font><A HREF="file:////opt/dymola/Modelica/Library/Modelica 3.2/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A>;
  <font color="blue">input </font><A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.qpOASESmem"
>qpOASESmem</A> mem <font color="darkgreen">&quot;Quadratic problem object&quot;</font>;
  <font color="blue">input </font>Real[:, <font color="red">size</font>(H, 1)] H <font color="darkgreen">&quot;Hessian matrix of the quadratic problem&quot;</font>;
  <font color="blue">input </font>Real[:] J <font color="darkgreen">&quot;Jacobian vector of the quadratic problem&quot;</font>;
  <font color="blue">input </font>Real[:, :] G=<font color="red">zeros</font>(0, 0) <font color="darkgreen">&quot;Constraint matrix of the quadratic problem&quot;</font>;
  <font color="blue">input </font>Real[:] x_min=<font color="red">zeros</font>(0) <font color="darkgreen">&quot;</pre>Lower bound of <b>x</b><pre>&quot;</font>;
  <font color="blue">input </font>Real[:] x_max=<font color="red">zeros</font>(0) <font color="darkgreen">&quot;</pre>Upper bound of <b>x</b><pre>&quot;</font>;
  <font color="blue">input </font>Real[:] Gx_min=<font color="red">zeros</font>(0) <font color="darkgreen">&quot;</pre>Lower bound of <b>G x</b><pre>&quot;</font>;
  <font color="blue">input </font>Real[:] Gx_max=<font color="red">zeros</font>(0) <font color="darkgreen">&quot;</pre>Upper bound of <b>G x</b><pre>&quot;</font>;
  <font color="blue">input </font>Integer n_x=<font color="red">size</font>(x_min, 1) <font color="darkgreen">
    &quot;</pre>Number of degrees of freedom (i.e., length of <b>x</b> vector)<pre>&quot;</font>;
  <font color="blue">input </font>Integer n_bG=<font color="red">size</font>(Gx_min, 1) <font color="darkgreen">
    &quot;</pre>Number of bounds of the form <b>Gx<sub>min</sub> &le; G x &le; Gx<sub>max</sub></b><pre>&quot;</font>;
  <font color="blue">input </font>Integer n_WSR_max=10 <font color="darkgreen">&quot;Maximum number of working set recalculations&quot;</font>;
  <font color="blue">output </font>Integer ret <font color="darkgreen">&quot;Return status&quot;</font>;
<font color="blue">external</font>&quot;C&quot; ret = <font color="red">qpoases_init</font>(
    mem,
    H,
    J,
    G,
    x_min,
    x_max,
    Gx_min,
    Gx_max,
    n_x,
    n_bG,
    n_WSR_max);
<textblock type="annotcomp" expanded="false">  <font color="darkgreen">/*
   Note:  As of Dymola 7.4, may need to use this in Windows:
    Library=&quot;FCSys/bin/qpOASES&quot;
   and this in Linux:
    Library=&quot;qpOASES&quot;
  */</font>

<font color="blue">end </font>Init;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE qpOASESmem<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.qpOASESmem"></A><A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses"
>FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses</A>.qpOASESmem</H2>
<B>Construct/destruct a memory object for a quadratic programming problem</B><p>
<P><H3>Information</H3></P>
Extends from <A HREF="file:////opt/dymola/Modelica/help/ExternalObject.html#ExternalObject"
>ExternalObject</A>.
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">class</font> qpOASESmem <font color="darkgreen">
  &quot;Construct/destruct a memory object for a quadratic programming problem&quot;</font>
  <font color="blue">extends </font><A HREF="file:////opt/dymola/Modelica/help/ExternalObject.html#ExternalObject"
>ExternalObject</A>;
  <textblock type="model" expanded="false" path="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.qpOASESmem.constructor"><font color="blue">function</font> constructor <font color="darkgreen">&quot;</pre>Construct a memory object for a quadratic programming problem to find <b>x</b> that minimizes:
  <ul><li><b>0.5 x<sup>T</sup> H x + x<sup>T</sup> J</b></li></ul>
  <p>Subject to:
  <ul>
  <li><b>x<sub>min</sub> &le; x &le; x<sub>max</sub></b></li>
  <li><b>Gx<sub>min</sub> &le; G x &le; Gx<sub>max</sub></b></li>
  </ul><pre>&quot;</font>
    <font color="blue">extends </font><A HREF="file:////opt/dymola/Modelica/Library/Modelica 3.2/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A>;
    <font color="blue">input </font>String mode=&quot;Normal&quot; <font color="darkgreen">
      &quot;</pre>\"Simple bounds\" (when only bounds of type <b>x<sub>min</sub> &le; x &le; x<sub>max</sub></b>) are included or \"Normal\" (when bounds of type <b>Gx<sub>min</sub> &le; G*x &le; Gx<sub>max</sub></b> are also included) or **??<pre>&quot;</font>;
    <font color="blue">input </font>Integer n_x <font color="darkgreen">
      &quot;</pre>Number of degrees of freedom (i.e., length of <b>x</b> vector)<pre>&quot;</font>;
    <font color="blue">input </font>Integer n_bG=0 <font color="darkgreen">
      &quot;</pre>Number of bounds of the form <b>Gx<sub>min</sub> &le; G x &le; Gx<sub>max</sub></b><pre>&quot;</font>;
    <font color="blue">output </font><A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.qpOASESmem"
>qpOASESmem</A> mem <font color="darkgreen">&quot;Quadratic programming problem memory object&quot;</font>;
  <font color="blue">external</font>&quot;C&quot; mem = <font color="red">qpoases_create</font>(
        mode,
        n_x,
        n_bG);
<textblock type="annotcomp" expanded="false">    <font color="darkgreen">/*
   Note:  As of Dymola 7.4, may need to use this in Windows:
    Library=&quot;FCSys/bin/qpOASES&quot;
   and this in Linux:
    Library=&quot;qpOASES&quot;
  */</font>

  <font color="blue">end </font>constructor</textblock>;

  <textblock type="model" expanded="false" path="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.qpOASESmem.destructor"><font color="blue">function</font> destructor <font color="darkgreen">
    &quot;Destruct a memory object for a quadratic programming problem&quot;</font>
    <font color="blue">extends </font><A HREF="file:////opt/dymola/Modelica/Library/Modelica 3.2/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A>;
    <font color="blue">input </font><A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.qpOASESmem"
>qpOASESmem</A> mem <font color="darkgreen">&quot;Quadratic programming problem memory object&quot;</font>;
  <font color="blue">external</font>&quot;C&quot; <font color="red">qpoases_free</font>(mem);
<textblock type="annotcomp" expanded="false">    <font color="darkgreen">/*
   Note:  As of Dymola 7.4, may need to use this in Windows:
    Library=&quot;FCSys/bin/qpOASES&quot;
   and this in Linux:
    Library=&quot;qpOASES&quot;
  */</font>

  <font color="blue">end </font>destructor</textblock>;

<font color="blue">end </font>qpOASESmem;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ObservabilityMatrix<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.ObservabilityMatrixI.png" ALT="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.ObservabilityMatrix" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.ObservabilityMatrix"></A><A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses"
>FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses</A>.ObservabilityMatrix</H2>
<B>Calculate observability matrix</B><p>
<P><H3>Information</H3></P>
Extends from <A HREF="file:////opt/dymola/Modelica/Library/Modelica 3.2/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A> (Icon for functions).
<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>A[:, size(A, 1)]</TD><TD>&nbsp;</TD><TD>System matrix</TD></TR>
<TR><TD>Real</TD><TD>C[:, size(A, 1)]</TD><TD>&nbsp;</TD><TD>Output matrix</TD></TR>
<TR><TD>Integer</TD><TD>n_p</TD><TD>&nbsp;</TD><TD>Prediction horizon</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>L[n_p*size(C, 1), size(A, 1)]</TD><TD>Observability matrix</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> ObservabilityMatrix <font color="darkgreen">&quot;Calculate observability matrix&quot;</font>
  <font color="blue">extends </font><A HREF="file:////opt/dymola/Modelica/Library/Modelica 3.2/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A>;
  <font color="blue">input </font>Real[:, <font color="red">size</font>(A, 1)] A <font color="darkgreen">&quot;System matrix&quot;</font>;
  <font color="blue">input </font>Real[:, <font color="red">size</font>(A, 1)] C <font color="darkgreen">&quot;Output matrix&quot;</font>;
  <font color="blue">input </font>Integer n_p <font color="darkgreen">&quot;Prediction horizon&quot;</font>;
  <font color="blue">output </font>Real[n_p*<font color="red">size</font>(C, 1), <font color="red">size</font>(A, 1)] L <font color="darkgreen">&quot;Observability matrix&quot;</font>;

<font color="blue">protected </font>
  <font color="blue">constant </font>Integer n_sen=<font color="red">size</font>(C, 1) <font color="darkgreen">&quot;Number of sensors&quot;</font>;

<font color="blue">algorithm </font>
  <font color="darkgreen">// Only suitable for stable plants, since numerical problems for computing A^i may/will arise for unstable systems</font>
  <font color="darkgreen">// see Maciejowski, p. 56 (and [RWR98])</font>
  L[1:n_sen, :] := C*A;
  <font color="blue">for </font>i<font color="blue"> in </font>2:n_p<font color="blue"> loop</font>
    L[(i - 1)*n_sen + 1:i*n_sen, :] := L[(i - 2)*n_sen + 1:(i - 1)*n_sen, :]*A;
  <font color="blue">end for</font>;

<font color="blue">end </font>ObservabilityMatrix;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ThetaPredictionMatrix<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.ObservabilityMatrixI.png" ALT="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.ThetaPredictionMatrix" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.ThetaPredictionMatrix"></A><A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses"
>FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses</A>.ThetaPredictionMatrix</H2>
<B>Calculate Theta prediction matrix</B><p>
<P><H3>Information</H3></P>
Extends from <A HREF="file:////opt/dymola/Modelica/Library/Modelica 3.2/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A> (Icon for functions).
<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>Y[:, :]</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>
<TR><TD>Integer</TD><TD>n_c</TD><TD>&nbsp;</TD><TD>Control horizon</TD></TR>
<TR><TD>Integer</TD><TD>n_p</TD><TD>&nbsp;</TD><TD>Prediction horizon</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>Theta[size(Y, 1), n_c*size(Y, 2)]</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> ThetaPredictionMatrix <font color="darkgreen">&quot;Calculate Theta prediction matrix&quot;</font>
  <font color="blue">extends </font><A HREF="file:////opt/dymola/Modelica/Library/Modelica 3.2/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A>;
  <font color="blue">input </font>Real[:, :] Y;
  <font color="blue">input </font>Integer n_c <font color="darkgreen">&quot;Control horizon&quot;</font>;
  <font color="blue">input </font>Integer n_p <font color="darkgreen">&quot;Prediction horizon&quot;</font>;
  <font color="blue">output </font>Real[<font color="red">size</font>(Y, 1), n_c*<font color="red">size</font>(Y, 2)] Theta;

<font color="blue">protected </font>
  <font color="blue">constant </font>Integer n_act=<font color="red">size</font>(Y, 2) <font color="darkgreen">&quot;Number of actuators&quot;</font>;
  <font color="blue">constant </font>Integer n_sen=<font color="red">integer</font>(<font color="red">size</font>(Y, 1)/n_p) <font color="darkgreen">&quot;Number of sensors&quot;</font>;

<font color="blue">algorithm </font>
  Theta := <font color="red">zeros</font>(<font color="red">size</font>(Theta, 1), <font color="red">size</font>(Theta, 2));
  <font color="blue">for </font>i<font color="blue"> in </font>1:n_c<font color="blue"> loop</font>
    Theta[(i - 1)*n_sen + 1:<font color="red">size</font>(Theta, 1), (i - 1)*n_act + 1:i*n_act] := Y[1:<font color="red">
      size</font>(Y, 1) - (i - 1)*n_sen, :];
  <font color="blue">end for</font>;

<font color="blue">end </font>ThetaPredictionMatrix;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE YPredictionMatrix<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.ObservabilityMatrixI.png" ALT="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.YPredictionMatrix" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses.YPredictionMatrix"></A><A HREF="FCSys_WorkInProgress_Blocks_Discrete_Controllers_BaseClasses.html#FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses"
>FCSys.WorkInProgress.Blocks.Discrete.Controllers.BaseClasses</A>.YPredictionMatrix</H2>
<B>Calculate Y prediction matrix</B><p>
<P><H3>Information</H3></P>
Extends from <A HREF="file:////opt/dymola/Modelica/Library/Modelica 3.2/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A> (Icon for functions).
<P><H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>A[:, size(A, 1)]</TD><TD>&nbsp;</TD><TD>System matrix</TD></TR>
<TR><TD>Real</TD><TD>B[size(A, 1), :]</TD><TD>&nbsp;</TD><TD>Input matrix</TD></TR>
<TR><TD>Real</TD><TD>C[:, size(A, 1)]</TD><TD>&nbsp;</TD><TD>Output matrix</TD></TR>
<TR><TD>Integer</TD><TD>n_p</TD><TD>&nbsp;</TD><TD>Prediction horizon</TD></TR>
</TABLE>
<P><H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>Y[n_p*size(C, 1), size(B, 2)]</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> YPredictionMatrix <font color="darkgreen">&quot;Calculate Y prediction matrix&quot;</font>
  <font color="blue">extends </font><A HREF="file:////opt/dymola/Modelica/Library/Modelica 3.2/help/Modelica_Icons.html#Modelica.Icons.Function"
>Modelica.Icons.Function</A>;
  <font color="blue">input </font>Real[:, <font color="red">size</font>(A, 1)] A <font color="darkgreen">&quot;System matrix&quot;</font>;
  <font color="blue">input </font>Real[<font color="red">size</font>(A, 1), :] B <font color="darkgreen">&quot;Input matrix&quot;</font>;
  <font color="blue">input </font>Real[:, <font color="red">size</font>(A, 1)] C <font color="darkgreen">&quot;Output matrix&quot;</font>;
  <font color="blue">input </font>Integer n_p <font color="darkgreen">&quot;Prediction horizon&quot;</font>;
  <font color="blue">output </font>Real[n_p*<font color="red">size</font>(C, 1), <font color="red">size</font>(B, 2)] Y;

<font color="blue">protected </font>
  <font color="blue">constant </font>Integer n_act=<font color="red">size</font>(B, 2) <font color="darkgreen">&quot;Number of actuators&quot;</font>;
  <font color="blue">constant </font>Integer n_x=<font color="red">size</font>(A, 1) <font color="darkgreen">&quot;Number of states&quot;</font>;
  <font color="blue">constant </font>Integer n_sen=<font color="red">size</font>(C, 1) <font color="darkgreen">&quot;Number of sensors&quot;</font>;
  Real[n_sen, n_act] Y_new_part=<font color="red">zeros</font>(n_sen, n_act);
  Real[n_x, n_x] A_raised_i=<font color="red">identity</font>(n_x);

<font color="blue">algorithm </font>
  <font color="darkgreen">// Only suitable for stable plants, since numerical problems for computing A^i may/will arise for unstable systems</font>
  <font color="darkgreen">// see Maciejowski, p. 56 (and [RWR98])</font>
  <font color="blue">for </font>i<font color="blue"> in </font>0:n_p - 1<font color="blue"> loop</font>
    Y_new_part := Y_new_part + C*A_raised_i*B;
    Y[i*n_sen + 1:(i + 1)*n_sen, :] := Y_new_part;
    A_raised_i := A*A_raised_i;
  <font color="blue">end for</font>;

<font color="blue">end </font>YPredictionMatrix;
</PRE>
<HR>
<address>HTML-documentation generated by <a href="http://www.Dymola.com/">Dymola</a> Fri Mar 22 00:08:06 2013.
</address></BODY>
</HTML>
