<html>
<head>
<title>FCSys.Regions.Examples</title>
<meta name="title" content="Modelica fuel cell library">
<meta name="keywords" content="fuel cell library, FCSys, fuel cell, PEM, proton exchange membrane, polymer exchange membrane, PEMFC, Modelica, Dymola, open-source, electrochemistry">
<meta name="date" content="2013-8-6">
<meta name="description" content="Examples">
<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="stylesheets/ModelicaDoc.css">
<link rel="shortcut icon" href="images/favicon.ico">
<script type="text/javascript" src="javascripts/analytics.js"></script>
</head>
<body>
<div class="sidebar">
  <div class="sidebarwrapper">
  <a href="index.html"><p class="sidebar-title">FCSys</p></a>
  <p class="logo"><a href="index.html">
    <img src="images/icon.gif" class="logo" alt="Logo" width=150>
  </a></p>

<h3>Table of Contents</h3>

<ul>
    <li><a href="FCSys_UsersGuide.html">User's Guide</a></li>
    <li><a href="FCSys_Blocks.html">Blocks</a></li>
    <li><a href="FCSys_Conditions.html">Conditions</a></li>
    <li><a href="FCSys_Assemblies.html">Assemblies</a></li>
    <li><a href="FCSys_Regions.html">Regions</a></li>
    <li><a href="FCSys_Subregions.html">Subregions</a></li>
    <li><a href="FCSys_Phases.html">Phases</a></li>
    <li><a href="FCSys_Species.html">Species</a></li>
    <li><a href="FCSys_Connectors.html">Connectors</a></li>
    <li><a href="FCSys_Characteristics.html">Characteristics</a></li>
    <li><a href="FCSys_Units.html">Units</a></li>
    <li><a href="FCSys_Quantities.html">Quantities</a></li>
    <li><a href="FCSys_Utilities.html">Utilities</a></li>
    <li><a href="FCSys_Icons.html">Icons</a></li>
    </ul>

  <h3>Download</h3>
    <ul>
      <li><a href="https://github.com/kdavies4/FCSys/zipball/release" rel="nofollow">Latest version</a> (**Empty; please check back soon or contact kdavies4 at gmail.com.)</li>
    </ul>
  </div>
</div>

<div class="document">
  <div class="documentwrapper">
    <div class="bodywrapper">
      <div class="body">

<h2><a name="FCSys.Regions.Examples"></a><a href="FCSys_Regions.html#FCSys.Regions">FCSys.Regions</a>.Examples</h2>

<b>Examples</b>

<h3>Information</h3>

Extends from <a href="http://build.openmodelica.org/Documentation/Modelica.Icons.ExamplesPackage.html#Modelica.Icons.ExamplesPackage">Modelica.Icons.ExamplesPackage</a> (Icon for packages containing runnable examples).

<h3>Package Content</h3>

<table border=1 cellspacing=0 cellpadding=2 >
<tr><th>Name</th><th>Description</th></tr>
<tr><td><img src="images/FCSys.Regions.Examples.FPToFPS.png" alt="FCSys.Regions.Examples.FPToFP" width=20  height=20 align=top>&nbsp;<a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples.FPToFP">FPToFP</a>
</td><td>Test one flow plate to the other</td></tr>
<tr><td><img src="images/FCSys.Regions.Examples.FPToFPS.png" alt="FCSys.Regions.Examples.FPToFPCycle" width=20  height=20 align=top>&nbsp;<a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples.FPToFPCycle">FPToFPCycle</a>
</td><td>Test one flow plate to the other</td></tr>
<tr><td><img src="images/FCSys.Regions.Examples.FPToFPS.png" alt="FCSys.Regions.Examples.GDLToGDL" width=20  height=20 align=top>&nbsp;<a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples.GDLToGDL">GDLToGDL</a>
</td><td>Test one GDL to the other</td></tr>
<tr><td><img src="images/FCSys.Regions.Examples.FPToFPS.png" alt="FCSys.Regions.Examples.CLToCL" width=20  height=20 align=top>&nbsp;<a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples.CLToCL">CLToCL</a>
</td><td>Test one catalyst layer to the other</td></tr>
<tr><td><img src="images/FCSys.Regions.Examples.FPToFPS.png" alt="FCSys.Regions.Examples.AnFP" width=20  height=20 align=top>&nbsp;<a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples.AnFP">AnFP</a>
</td><td>Test the anode flow plate</td></tr>
<tr><td><img src="images/FCSys.Regions.Examples.FPToFPS.png" alt="FCSys.Regions.Examples.AnGDL" width=20  height=20 align=top>&nbsp;<a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples.AnGDL">AnGDL</a>
</td><td>Test the anode gas diffusion layer</td></tr>
<tr><td><img src="images/FCSys.Regions.Examples.FPToFPS.png" alt="FCSys.Regions.Examples.AnCL" width=20  height=20 align=top>&nbsp;<a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples.AnCL">AnCL</a>
</td><td>Test the anode catalyst layer</td></tr>
<tr><td><img src="images/FCSys.Regions.Examples.FPToFPS.png" alt="FCSys.Regions.Examples.PEM" width=20  height=20 align=top>&nbsp;<a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples.PEM">PEM</a>
</td><td>Test the proton exchange membrane</td></tr>
<tr><td><img src="images/FCSys.Regions.Examples.FPToFPS.png" alt="FCSys.Regions.Examples.CaCL" width=20  height=20 align=top>&nbsp;<a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples.CaCL">CaCL</a>
</td><td>Test the cathode catalyst layer</td></tr>
<tr><td><img src="images/FCSys.Regions.Examples.FPToFPS.png" alt="FCSys.Regions.Examples.CaGDL" width=20  height=20 align=top>&nbsp;<a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples.CaGDL">CaGDL</a>
</td><td>Test the cathode gas diffusion layer</td></tr>
<tr><td><img src="images/FCSys.Regions.Examples.FPToFPS.png" alt="FCSys.Regions.Examples.CaFP" width=20  height=20 align=top>&nbsp;<a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples.CaFP">CaFP</a>
</td><td>Test the cathode flow plate</td></tr>
<tr><td><img src="images/FCSys.Regions.Examples.FPToFPS.png" alt="FCSys.Regions.Examples.FPToFPO2" width=20  height=20 align=top>&nbsp;<a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples.FPToFPO2">FPToFPO2</a>
</td><td>Test one flow plate to the other</td></tr>
<tr><td><img src="images/FCSys.Regions.Examples.FPToFPLinearizeS.png" alt="FCSys.Regions.Examples.FPToFPLinearize" width=20  height=20 align=top>&nbsp;<a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples.FPToFPLinearize">FPToFPLinearize</a>
</td><td>Test one flow plate to the other</td></tr>
<tr><td><img src="images/FCSys.Regions.Examples.FPToFPSineS.png" alt="FCSys.Regions.Examples.FPToFPSine" width=20  height=20 align=top>&nbsp;<a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples.FPToFPSine">FPToFPSine</a>
</td><td>Test one flow plate to the other</td></tr>
<tr><td><img src="images/FCSys.Regions.Examples.FPToFPSineS.png" alt="FCSys.Regions.Examples.FPToFPPulse" width=20  height=20 align=top>&nbsp;<a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples.FPToFPPulse">FPToFPPulse</a>
</td><td>Test one flow plate to the other</td></tr>
<tr><td><img src="images/FCSys.Regions.Examples.ConnS.png" alt="FCSys.Regions.Examples.Conn" width=20  height=20 align=top>&nbsp;<a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples.Conn">Conn</a>
</td><td>&nbsp;</td></tr>
<tr><td><img src="images/FCSys.Regions.Examples.ModS.png" alt="FCSys.Regions.Examples.Mod" width=20  height=20 align=top>&nbsp;<a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples.Mod">Mod</a>
</td><td>&nbsp;</td></tr>
<tr><td><a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples.TestMod">TestMod</a>
</td><td>&nbsp;</td></tr>
<tr><td><img src="images/FCSys.Regions.Examples.FPToFPVoltageS.png" alt="FCSys.Regions.Examples.FPToFPVoltage" width=20  height=20 align=top>&nbsp;<a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples.FPToFPVoltage">FPToFPVoltage</a>
</td><td>Test one flow plate to the other</td></tr>
</table>
<hr>

<h2><img src="images/FCSys.Regions.Examples.FPToFPI.png" alt="FCSys.Regions.Examples.FPToFP" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Regions.Examples.FPToFP"></a><a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples">FCSys.Regions.Examples</a>.FPToFP</h2>
<b>Test one flow plate to the other</b><p>
<img src="images/FCSys.Regions.Examples.FPToFPD.png" alt="FCSys.Regions.Examples.FPToFP">

<h3>Information</h3>

Extends from <a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a> (Icon for runnable examples).
<p>

<h3>Parameters</h3>

<p>
<table border=1 cellspacing=0 cellpadding=2>
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>n_O2</td><td>0.21</td><td>[1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>anStoich</td><td>1.5</td><td>Anode stoichiometric ratio [1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>caStoich</td><td>2.0</td><td>Cathode stoichiometric ratio [1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>anInletRH</td><td>0.8</td><td>[1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>caInletRH</td><td>0.5</td><td>[1]</td></tr>
<tr><td>Real</td><td>T_degC</td><td>60</td><td>&nbsp;</td></tr>
<tr><td>Real</td><td>p_kPag</td><td>48.3</td><td>&nbsp;</td></tr>
<TR bgcolor="#e0e0e0"><TD colspan=4>Geometry</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Length</a></td><td>L_y[:]</td><td>fill(U.m/1, 1)</td><td>Lengths along the channel [l]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Length</a></td><td>L_z[:]</td><td>{5*U.mm}</td><td>Lengths across the channel [l]</td></tr>
</table>
<p>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> FPToFP <font color="darkgreen">&quot;Test one flow plate to the other&quot;</font>

  <font color="blue">extends </font><a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> n_O2=0.21;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> anStoich=1.5 <font color="darkgreen">&quot;Anode stoichiometric ratio&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> caStoich=2.0 <font color="darkgreen">&quot;Cathode stoichiometric ratio&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> anInletRH=0.8;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> caInletRH=0.5;
  <font color="blue">parameter </font>Real T_degC=60;
  <font color="blue">parameter </font>Real p_kPag=48.3;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.TemperatureAbsolute">Q.TemperatureAbsolute</a> T=<font color="red">U.from_degC</font>(T_degC);
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p=<font color="red">U.from_kPag</font>(p_kPag);
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p_H2O_an_in=anInletRH*<font color="red">
      Modelica.Media.Air.MoistAir.saturationPressureLiquid</font>(T/U.K)*U.Pa <font color="darkgreen">
    &quot;Pressure of H2O vapor&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p_H2O_ca_in=caInletRH*<font color="red">
      Modelica.Media.Air.MoistAir.saturationPressureLiquid</font>(T/U.K)*U.Pa <font color="darkgreen">
    &quot;Pressure of H2O vapor&quot;</font>;

  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Potential">Q.Potential</a> w[n_y, n_z]=(anBC.graphite.'e-'.face.mPhidot[1] ./ anBC.graphite.
      'e-'.face.rho - caBC.graphite.'e-'.face.mPhidot[1] ./ caBC.graphite.'e-'.face.rho)
      /PEM.A[Axis.x] <font color="darkgreen">&quot;Potential&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.CurrentAreic">Q.CurrentAreic</a> zJ[n_y, n_z]=-anBC.graphite.'e-'.face.phi[1] .* anBC.graphite.
      'e-'.face.rho <font color="darkgreen">&quot;Current density&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Number">Q.Number</a> zJ_Apercm2[n_y, n_z]=zJ*U.cm^2/U.A <font color="darkgreen">
    &quot;Electrical current density, in A/cm2&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Current">Q.Current</a> zI=<font color="red">sum</font>(zJ .* <font color="red">outerProduct</font>(L_y, L_z)) <font color="darkgreen">
    &quot;Total electrical current&quot;</font>;
  <a href="FCSys_Quantities.html#FCSys.Quantities.Current">Q.Current</a> I_H2_an_in=zI*anStoich/2;
  <a href="FCSys_Quantities.html#FCSys.Quantities.Current">Q.Current</a> I_O2_ca_in=zI*caStoich/4;

  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Q.Length</a> L_y[:]=<font color="red">fill</font>(U.m/1, 1) <font color="darkgreen">&quot;Lengths along the channel&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Q.Length</a> L_z[:]={5*U.mm} <font color="darkgreen">&quot;Lengths across the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Integer n_y=<font color="red">size</font>(L_y, 1) <font color="darkgreen">
    &quot;Number of regions along the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Integer n_z=<font color="red">size</font>(L_z, 1) <font color="darkgreen">
    &quot;Number of regions across the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_an_seg[anFP.n_x, n_z]=<font color="red">outerProduct</font>(anFP.L_x, L_z) <font color="darkgreen">
    &quot;Areas of the segments over the xz plane of the anode flow plate&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_ca_seg[caFP.n_x, n_z]=<font color="red">outerProduct</font>(caFP.L_x, L_z) <font color="darkgreen">
    &quot;Areas of the segments over the xz plane of the cathode flow plate&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_an=<font color="red">sum</font>(anFP.L_x)*<font color="red">sum</font>(L_z) <font color="darkgreen">
    &quot;Total cross-sectional area of the anode flow plate in the xz plane&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_ca=<font color="red">sum</font>(caFP.L_x)*<font color="red">sum</font>(L_z) <font color="darkgreen">
    &quot;Total cross-sectional area of the cathode flow plate in the xz plane&quot;</font>;

  <a href="FCSys_Regions_AnFPs.html#FCSys.Regions.AnFPs.AnFP">AnFPs.AnFP</a> anFP(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(
      gas(H2(p_IC=p - p_H2O_an_in), H2O(T_IC=T, p_IC=p_H2O_an_in)),
      liquid(H2O(T_IC=T)),
      graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_AnGDLs.html#FCSys.Regions.AnGDLs.AnGDL">AnGDLs.AnGDL</a> anGDL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(
      gas(H2(p_IC=p - p_H2O_an_in), H2O(
          T_IC=T,
          p_IC=p_H2O_an_in,
          initTransY=InitTranslational.velocitySS)),
      liquid(H2O(T_IC=T)),
      graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_AnCLs.html#FCSys.Regions.AnCLs.AnCL">AnCLs.AnCL</a> anCL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(
      ionomer(&#39;SO3-&#39;(T_IC=T)),
      gas(H2(p_IC=p - p_H2O_an_in), H2O(T_IC=T, p_IC=p_H2O_an_in)),
      liquid(H2O(T_IC=T)),
      graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_PEMs.html#FCSys.Regions.PEMs.PEM">PEMs.PEM</a> PEM(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(ionomer(&#39;H+&#39;(initTransX=InitTranslational.none), &#39;SO3-&#39;(T_IC=T))));

  <a href="FCSys_Regions_CaCLs.html#FCSys.Regions.CaCLs.CaCL">CaCLs.CaCL</a> caCL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(
      ionomer(&#39;SO3-&#39;(T_IC=T)),
      gas(
        H2O(T_IC=T, p_IC=p_H2O_ca_in),
        N2(p_IC=(p - p_H2O_ca_in)*(1 - environment.n_O2)),
        O2(p_IC=(p - p_H2O_ca_in)*environment.n_O2)),
      liquid(H2O(T_IC=T)),
      graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_CaGDLs.html#FCSys.Regions.CaGDLs.CaGDL">CaGDLs.CaGDL</a> caGDL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(
      gas(
        H2O(T_IC=T, p_IC=p_H2O_ca_in),
        N2(p_IC=(p - p_H2O_ca_in)*(1 - environment.n_O2)),
        O2(p_IC=(p - p_H2O_ca_in)*environment.n_O2)),
      liquid(H2O(T_IC=T)),
      graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_CaFPs.html#FCSys.Regions.CaFPs.CaFP">CaFPs.CaFP</a> caFP(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(
      gas(
        H2O(T_IC=T, p_IC=p_H2O_ca_in),
        N2(p_IC=(p - p_H2O_ca_in)*(1 - environment.n_O2)),
        O2(p_IC=(p - p_H2O_ca_in)*environment.n_O2)),
      liquid(H2O(T_IC=T)),
      graphite(&#39;C+&#39;(T_IC=T))));
  <font color="darkgreen">//initTransY=InitTranslational.velocitySS</font>
  <font color="darkgreen">//,initTransY=InitTranslational.velocitySS</font>

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> anBC[n_y, n_z](<font color="blue">each </font>
      graphite(
      &#39;inclC+&#39;=true,
      &#39;incle-&#39;=true,
      &#39;C+&#39;(<font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,
          thermalSet(y=T)),
      &#39;e-&#39;(<font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,
          thermalSet(y=T))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> caBC[n_y, n_z](<font color="blue">each </font>
      graphite(
      &#39;inclC+&#39;=true,
      &#39;incle-&#39;=true,
      &#39;C+&#39;(<font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,
          thermalSet(y=T)),
      &#39;e-&#39;(
        <font color="blue">redeclare </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.Ramp">Modelica.Blocks.Sources.Ramp</a> normalSet(
          height=-2.25*U.A/U.cm^2,
          duration=225.1,
          startTime=10.1),
        <font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,

        thermalSet(y=T))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusEfforts">Conditions.ByConnector.FaceBus.Single.FaceBusEfforts</a> anSource[anFP.n_x, n_z](
      gas(
      <font color="blue">each </font>inclH2=true,
      <font color="blue">each </font>inclH2O=true,
      H2(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(anSource.gas.H2.normalOut.y - <font color="red">fill</font>(
              I_H2_an_in/A_an,
              anFP.n_x,
              n_z)) .* A_an_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T)),
      H2O(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(anSource.gas.H2O.normalOut.y - <font color="red">fill</font>(
              I_H2_an_in*p_H2O_an_in/((p - p_H2O_an_in)*A_an),
              anFP.n_x,
              n_z)) .* A_an_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> anSink[anFP.n_x, n_z](gas(
      <font color="blue">each </font>inclH2=true,
      <font color="blue">each </font>inclH2O=true,
      H2(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_an_out_noneq*A_an_seg .* anSink.gas.H2.face.rho ./ (
              anSink.gas.H2.face.rho + anSink.gas.H2O.face.rho))),
      H2O(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_an_out_noneq*A_an_seg .* anSink.gas.H2O.face.rho ./ (
              anSink.gas.H2.face.rho + anSink.gas.H2O.face.rho)))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusEfforts">Conditions.ByConnector.FaceBus.Single.FaceBusEfforts</a> caSource[caFP.n_x, n_z](
      gas(
      <font color="blue">each </font>inclH2O=true,
      <font color="blue">each </font>inclN2=true,
      <font color="blue">each </font>inclO2=true,
      H2O(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(caSource.gas.H2O.normalOut.y - <font color="red">fill</font>(
              I_O2_ca_in*p_H2O_ca_in/((p - p_H2O_ca_in)*n_O2*A_ca),
              caFP.n_x,
              n_z)) .* A_ca_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T)),
      N2(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(caSource.gas.N2.normalOut.y - <font color="red">fill</font>(
              I_O2_ca_in*(1 - n_O2)/(n_O2*A_ca),
              caFP.n_x,
              n_z)) .* A_ca_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T)),
      O2(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(caSource.gas.O2.normalOut.y - <font color="red">fill</font>(
              I_O2_ca_in/A_ca,
              caFP.n_x,
              n_z)) .* A_ca_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.force</a>,

        <font color="blue">each </font>thermalSet(y=T))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> caSink[caFP.n_x, n_z](gas(
      <font color="blue">each </font>inclH2O=true,
      <font color="blue">each </font>inclN2=true,
      <font color="blue">each </font>inclO2=true,
      H2O(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_ca_out_noneq*A_ca_seg .* caSink.gas.H2O.face.rho ./ (
              caSink.gas.H2O.face.rho + caSink.gas.N2.face.rho + caSink.gas.O2.face.rho))),

      N2(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_ca_out_noneq*A_ca_seg .* caSink.gas.N2.face.rho ./ (
              caSink.gas.H2O.face.rho + caSink.gas.N2.face.rho + caSink.gas.O2.face.rho))),

      O2(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_ca_out_noneq*A_ca_seg .* caSink.gas.O2.face.rho ./ (
              caSink.gas.H2O.face.rho + caSink.gas.N2.face.rho + caSink.gas.O2.face.rho)))));

<font color="blue">inner </font><a href="FCSys_Conditions.html#FCSys.Conditions.Environment">Conditions.Environment</a> environment(analysis=true, p=48.3*U.kPa + U.atm)
    <font color="darkgreen">&quot;Environmental conditions&quot;</font>;

  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> anPressSet(y(unit=&quot;m/(l.T2)&quot;) = p) <font color="darkgreen">
    &quot;Setpoint for the total anode outlet pressure&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> caPressSet(y(unit=&quot;m/(l.T2)&quot;) = p) <font color="darkgreen">
    &quot;Setpoint for the total cathode outlet pressure&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> anThermoPress(y(unit=&quot;m/(l.T2)&quot;) = <font color="red">sum</font>
      ((anSink.gas.H2.materialOut.y + anSink.gas.H2O.materialOut.y) .* <font color="red">
      outerProduct</font>(anFP.L_x, L_z))/A_an) <font color="darkgreen">
    &quot;Thermodynamic pressure at the anode outlet&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> caThermoPress(y(unit=&quot;m/(l.T2)&quot;) = <font color="red">sum</font>
      ((caSink.gas.H2O.materialOut.y + caSink.gas.N2.materialOut.y + caSink.gas.O2.materialOut.y)
       .* A_ca_seg)/A_ca) <font color="darkgreen">&quot;Thermodynamic pressure at the cathode outlet&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Math.html#Modelica.Blocks.Math.Feedback">Modelica.Blocks.Math.Feedback</a> anNoneqSet;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Math.html#Modelica.Blocks.Math.Feedback">Modelica.Blocks.Math.Feedback</a> caNoneqSet;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Continuous.html#Modelica.Blocks.Continuous.FirstOrder">Modelica.Blocks.Continuous.FirstOrder</a> anValveDynamics(initType=Modelica.Blocks.Types.Init.InitialOutput,
      T=1) <font color="darkgreen">&quot;Dynamics of the anode exit valve&quot;</font>;

<font color="blue">protected </font>
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> p_an_out_noneq(unit=&quot;m/(l.T2)&quot;) <font color="darkgreen">
    &quot;Nonequilibrium pressure at the anode outlet&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> p_ca_out_noneq(unit=&quot;m/(l.T2)&quot;) <font color="darkgreen">
    &quot;Nonequilibrium pressure at the cathode outlet&quot;</font>;
<font color="blue">public </font>
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Continuous.html#Modelica.Blocks.Continuous.FirstOrder">Modelica.Blocks.Continuous.FirstOrder</a> caValveDynamics(initType=Modelica.Blocks.Types.Init.InitialOutput,
      T=1) <font color="darkgreen">&quot;Dynamics of the cathode exit valve&quot;</font>;
<font color="blue">equation </font>

  <font color="red">connect</font>(anFP.xPositive, anGDL.xNegative);
  <font color="red">connect</font>(anGDL.xPositive, anCL.xNegative);

  <font color="red">connect</font>(anCL.xPositive, PEM.xNegative);

  <font color="red">connect</font>(PEM.xPositive, caCL.xNegative);

  <font color="red">connect</font>(caCL.xPositive, caGDL.xNegative);

  <font color="red">connect</font>(caGDL.xPositive, caFP.xNegative);

  <font color="red">connect</font>(anSource.face, anFP.yNegative);
  <font color="red">connect</font>(anSink.face, anFP.yPositive);
  <font color="red">connect</font>(caSource.face, caFP.yNegative);
  <font color="red">connect</font>(caSink.face, caFP.yPositive);
  <font color="red">connect</font>(anBC.face, anFP.xNegative);

  <font color="red">connect</font>(caFP.xPositive, caBC.face);

  <font color="red">connect</font>(anValveDynamics.y, p_an_out_noneq);
  <font color="red">connect</font>(caPressSet.y, caNoneqSet.u1);
  <font color="red">connect</font>(caThermoPress.y, caNoneqSet.u2);
  <font color="red">connect</font>(anPressSet.y, anNoneqSet.u1);
  <font color="red">connect</font>(anNoneqSet.u2, anThermoPress.y);
  <font color="red">connect</font>(anNoneqSet.y, anValveDynamics.u);
  <font color="red">connect</font>(caValveDynamics.y, p_ca_out_noneq);
  <font color="red">connect</font>(caNoneqSet.y, caValveDynamics.u);
<font color="blue">end </font>FPToFP;
</pre>
<hr>

<h2><img src="images/FCSys.Regions.Examples.FPToFPI.png" alt="FCSys.Regions.Examples.FPToFPCycle" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Regions.Examples.FPToFPCycle"></a><a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples">FCSys.Regions.Examples</a>.FPToFPCycle</h2>
<b>Test one flow plate to the other</b><p>
<img src="images/FCSys.Regions.Examples.FPToFPCycleD.png" alt="FCSys.Regions.Examples.FPToFPCycle">

<h3>Information</h3>

Extends from <a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a> (Icon for runnable examples).
<p>

<h3>Parameters</h3>

<p>
<table border=1 cellspacing=0 cellpadding=2>
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>n_O2</td><td>0.21</td><td>[1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>anStoich</td><td>1.5</td><td>Anode stoichiometric ratio [1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>caStoich</td><td>2.0</td><td>Cathode stoichiometric ratio [1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>anInletRH</td><td>0.8</td><td>[1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>caInletRH</td><td>0.5</td><td>[1]</td></tr>
<tr><td>Real</td><td>T_degC</td><td>60</td><td>&nbsp;</td></tr>
<tr><td>Real</td><td>p_kPag</td><td>48.3</td><td>&nbsp;</td></tr>
<TR bgcolor="#e0e0e0"><TD colspan=4>Geometry</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Length</a></td><td>L_y[:]</td><td>{U.m}</td><td>Lengths along the channel [l]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Length</a></td><td>L_z[:]</td><td>{5*U.mm}</td><td>Lengths across the channel [l]</td></tr>
</table>
<p>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> FPToFPCycle <font color="darkgreen">&quot;Test one flow plate to the other&quot;</font>

  <font color="blue">extends </font><a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> n_O2=0.21;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> anStoich=1.5 <font color="darkgreen">&quot;Anode stoichiometric ratio&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> caStoich=2.0 <font color="darkgreen">&quot;Cathode stoichiometric ratio&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> anInletRH=0.8;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> caInletRH=0.5;
  <font color="blue">parameter </font>Real T_degC=60;
  <font color="blue">parameter </font>Real p_kPag=48.3;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.TemperatureAbsolute">Q.TemperatureAbsolute</a> T=<font color="red">U.from_degC</font>(T_degC);
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p=<font color="red">U.from_kPag</font>(p_kPag);
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p_H2O_an_in=anInletRH*<font color="red">
      Modelica.Media.Air.MoistAir.saturationPressureLiquid</font>(T/U.K)*U.Pa <font color="darkgreen">
    &quot;Pressure of H2O vapor&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p_H2O_ca_in=caInletRH*<font color="red">
      Modelica.Media.Air.MoistAir.saturationPressureLiquid</font>(T/U.K)*U.Pa <font color="darkgreen">
    &quot;Pressure of H2O vapor&quot;</font>;

  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Potential">Q.Potential</a> w[n_y, n_z]=(anBC.graphite.'e-'.face.mPhidot[1] ./ anBC.graphite.
      'e-'.face.rho - caBC.graphite.'e-'.face.mPhidot[1] ./ caBC.graphite.'e-'.face.rho)
      /PEM.A[Axis.x] <font color="darkgreen">&quot;Potential&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.CurrentAreic">Q.CurrentAreic</a> zJ[n_y, n_z]=-anBC.graphite.'e-'.face.phi[1] .* anBC.graphite.
      'e-'.face.rho <font color="darkgreen">&quot;Current density&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Number">Q.Number</a> zJ_Apercm2[n_y, n_z]=zJ*U.cm^2/U.A <font color="darkgreen">
    &quot;Electrical current density, in A/cm2&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Current">Q.Current</a> zI=<font color="red">sum</font>(zJ .* <font color="red">outerProduct</font>(L_y, L_z)) <font color="darkgreen">
    &quot;Total electrical current&quot;</font>;

  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Q.Length</a> L_y[:]={U.m} <font color="darkgreen">&quot;Lengths along the channel&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Q.Length</a> L_z[:]={5*U.mm} <font color="darkgreen">&quot;Lengths across the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Integer n_y=<font color="red">size</font>(L_y, 1) <font color="darkgreen">
    &quot;Number of regions along the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Integer n_z=<font color="red">size</font>(L_z, 1) <font color="darkgreen">
    &quot;Number of regions across the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_an_seg[anFP.n_x, n_z]=<font color="red">outerProduct</font>(anFP.L_x, L_z) <font color="darkgreen">
    &quot;Areas of the segments over the xz plane of the anode flow plate&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_ca_seg[caFP.n_x, n_z]=<font color="red">outerProduct</font>(caFP.L_x, L_z) <font color="darkgreen">
    &quot;Areas of the segments over the xz plane of the cathode flow plate&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_an=<font color="red">sum</font>(anFP.L_x)*<font color="red">sum</font>(L_z) <font color="darkgreen">
    &quot;Total cross-sectional area of the anode flow plate in the xz plane&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_ca=<font color="red">sum</font>(caFP.L_x)*<font color="red">sum</font>(L_z) <font color="darkgreen">
    &quot;Total cross-sectional area of the cathode flow plate in the xz plane&quot;</font>;

  <a href="FCSys_Regions_AnFPs.html#FCSys.Regions.AnFPs.AnFP">AnFPs.AnFP</a> anFP(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(gas(H2O(T_IC=T)), graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_AnGDLs.html#FCSys.Regions.AnGDLs.AnGDL">AnGDLs.AnGDL</a> anGDL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(gas(H2O(T_IC=T)), graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_AnCLs.html#FCSys.Regions.AnCLs.AnCL">AnCLs.AnCL</a> anCL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(
      ionomer(&#39;SO3-&#39;(T_IC=T)),
      gas(H2O(T_IC=T)),
      graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_PEMs.html#FCSys.Regions.PEMs.PEM">PEMs.PEM</a> PEM(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(ionomer(&#39;H+&#39;(initTransX=InitTranslational.none), &#39;SO3-&#39;(T_IC=T))));

  <a href="FCSys_Regions_CaCLs.html#FCSys.Regions.CaCLs.CaCL">CaCLs.CaCL</a> caCL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(
      ionomer(&#39;SO3-&#39;(T_IC=T)),
      gas(H2O(T_IC=T)),
      graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_CaGDLs.html#FCSys.Regions.CaGDLs.CaGDL">CaGDLs.CaGDL</a> caGDL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(gas(H2O(T_IC=T)), graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_CaFPs.html#FCSys.Regions.CaFPs.CaFP">CaFPs.CaFP</a> caFP(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(gas(H2O(T_IC=T)), graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> anBC[n_y, n_z](<font color="blue">each </font>
      graphite(
      &#39;inclC+&#39;=true,
      &#39;incle-&#39;=true,
      &#39;C+&#39;(<font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,
          thermalSet(y=T)),
      &#39;e-&#39;(<font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,
          thermalSet(y=T))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> caBC[n_y, n_z](<font color="blue">each </font>
      graphite(
      &#39;inclC+&#39;=true,
      &#39;incle-&#39;=true,
      &#39;C+&#39;(<font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,
          thermalSet(y=T)),
      &#39;e-&#39;(
        <font color="blue">redeclare </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,

        thermalSet(y=T),
        <font color="blue">redeclare </font><a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.Pulse">Modelica.Blocks.Sources.Pulse</a> normalSet(
          amplitude=-0.8*U.A/U.cm^2,
          width=5,
          period=10))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusEfforts">Conditions.ByConnector.FaceBus.Single.FaceBusEfforts</a> anSource[anFP.n_x, n_z](
      gas(
      <font color="blue">each </font>inclH2=true,
      <font color="blue">each </font>inclH2O=true,
      H2(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(anSource.gas.H2.normalOut.y - <font color="red">fill</font>(
              zI*anStoich/(2*A_an),
              anFP.n_x,
              n_z)) .* A_an_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T)),
      H2O(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(anSource.gas.H2O.normalOut.y - <font color="red">fill</font>(
              zI*anStoich*p_H2O_an_in/(2*(environment.p - environment.p_H2O)*
                A_an),
              anFP.n_x,
              n_z)) .* A_an_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> anSink[anFP.n_x, n_z](gas(
      <font color="blue">each </font>inclH2=true,
      <font color="blue">each </font>inclH2O=true,
      H2(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_an_out_noneq*A_an_seg .* anSink.gas.H2.face.rho ./ (
              anSink.gas.H2.face.rho + anSink.gas.H2O.face.rho))),
      H2O(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_an_out_noneq*A_an_seg .* anSink.gas.H2O.face.rho ./ (
              anSink.gas.H2.face.rho + anSink.gas.H2O.face.rho)))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusEfforts">Conditions.ByConnector.FaceBus.Single.FaceBusEfforts</a> caSource[caFP.n_x, n_z](
      gas(
      <font color="blue">each </font>inclH2O=true,
      <font color="blue">each </font>inclN2=true,
      <font color="blue">each </font>inclO2=true,
      H2O(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(caSource.gas.H2O.normalOut.y - <font color="red">fill</font>(
              zI*caStoich*p_H2O_ca_in/(4*p*n_O2*A_ca),
              caFP.n_x,
              n_z)) .* A_ca_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T)),
      N2(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(caSource.gas.N2.normalOut.y - <font color="red">fill</font>(
              zI*caStoich*(p - p*n_O2 - p_H2O_ca_in)/(4*p*n_O2*A_ca),
              caFP.n_x,
              n_z)) .* A_ca_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T)),
      O2(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(caSource.gas.O2.normalOut.y - <font color="red">fill</font>(
              zI*caStoich/(4*A_ca),
              caFP.n_x,
              n_z)) .* A_ca_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.force</a>,

        <font color="blue">each </font>thermalSet(y=T))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> caSink[caFP.n_x, n_z](gas(
      <font color="blue">each </font>inclH2O=true,
      <font color="blue">each </font>inclN2=true,
      <font color="blue">each </font>inclO2=true,
      H2O(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_ca_out_noneq*A_ca_seg .* caSink.gas.H2O.face.rho ./ (
              caSink.gas.H2O.face.rho + caSink.gas.N2.face.rho + caSink.gas.O2.face.rho))),

      N2(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_ca_out_noneq*A_ca_seg .* caSink.gas.N2.face.rho ./ (
              caSink.gas.H2O.face.rho + caSink.gas.N2.face.rho + caSink.gas.O2.face.rho))),

      O2(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_ca_out_noneq*A_ca_seg .* caSink.gas.O2.face.rho ./ (
              caSink.gas.H2O.face.rho + caSink.gas.N2.face.rho + caSink.gas.O2.face.rho)))));

<font color="blue">inner </font><a href="FCSys_Conditions.html#FCSys.Conditions.Environment">Conditions.Environment</a> environment(analysis=true) <font color="darkgreen">
    &quot;Environmental conditions&quot;</font>;

  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> anPressSet(y(unit=&quot;m/(l.T2)&quot;) =
      environment.p) <font color="darkgreen">&quot;Setpoint for the total anode outlet pressure&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> caPressSet(y(unit=&quot;m/(l.T2)&quot;) =
      environment.p) <font color="darkgreen">&quot;Setpoint for the total cathode outlet pressure&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> anThermoPress(y(unit=&quot;m/(l.T2)&quot;) = <font color="red">sum</font>
      ((anSink.gas.H2.materialOut.y + anSink.gas.H2O.materialOut.y) .* <font color="red">
      outerProduct</font>(anFP.L_x, L_z))/A_an) <font color="darkgreen">
    &quot;Thermodynamic pressure at the anode outlet&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> caThermoPress(y(unit=&quot;m/(l.T2)&quot;) = <font color="red">sum</font>
      ((caSink.gas.H2O.materialOut.y + caSink.gas.N2.materialOut.y + caSink.gas.O2.materialOut.y)
       .* A_ca_seg)/A_ca) <font color="darkgreen">&quot;Thermodynamic pressure at the cathode outlet&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Math.html#Modelica.Blocks.Math.Feedback">Modelica.Blocks.Math.Feedback</a> anNoneqSet;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Math.html#Modelica.Blocks.Math.Feedback">Modelica.Blocks.Math.Feedback</a> caNoneqSet;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Continuous.html#Modelica.Blocks.Continuous.FirstOrder">Modelica.Blocks.Continuous.FirstOrder</a> anValveDynamics(initType=Modelica.Blocks.Types.Init.InitialOutput,
      T=2) <font color="darkgreen">&quot;Dynamics of the anode exit valve&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Continuous.html#Modelica.Blocks.Continuous.FirstOrder">Modelica.Blocks.Continuous.FirstOrder</a> caValveDynamics(initType=Modelica.Blocks.Types.Init.InitialOutput,
      T=2) <font color="darkgreen">&quot;Dynamics of the cathode exit valve&quot;</font>;

<font color="blue">protected </font>
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> p_an_out_noneq(unit=&quot;m/(l.T2)&quot;) <font color="darkgreen">
    &quot;Nonequilibrium pressure at the anode outlet&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> p_ca_out_noneq(unit=&quot;m/(l.T2)&quot;) <font color="darkgreen">
    &quot;Nonequilibrium pressure at the cathode outlet&quot;</font>;
<font color="blue">equation </font>

  <font color="red">connect</font>(anFP.xPositive, anGDL.xNegative);
  <font color="red">connect</font>(anGDL.xPositive, anCL.xNegative);

  <font color="red">connect</font>(anCL.xPositive, PEM.xNegative);

  <font color="red">connect</font>(PEM.xPositive, caCL.xNegative);

  <font color="red">connect</font>(caCL.xPositive, caGDL.xNegative);

  <font color="red">connect</font>(caGDL.xPositive, caFP.xNegative);

  <font color="red">connect</font>(anSource.face, anFP.yNegative);
  <font color="red">connect</font>(anSink.face, anFP.yPositive);
  <font color="red">connect</font>(caSource.face, caFP.yNegative);
  <font color="red">connect</font>(caSink.face, caFP.yPositive);
  <font color="red">connect</font>(anBC.face, anFP.xNegative);

  <font color="red">connect</font>(caFP.xPositive, caBC.face);

  <font color="red">connect</font>(anValveDynamics.y, p_an_out_noneq);
  <font color="red">connect</font>(caValveDynamics.y, p_ca_out_noneq);
  <font color="red">connect</font>(caPressSet.y, caNoneqSet.u1);
  <font color="red">connect</font>(caThermoPress.y, caNoneqSet.u2);
  <font color="red">connect</font>(caNoneqSet.y, caValveDynamics.u);
  <font color="red">connect</font>(anPressSet.y, anNoneqSet.u1);
  <font color="red">connect</font>(anNoneqSet.u2, anThermoPress.y);
  <font color="red">connect</font>(anNoneqSet.y, anValveDynamics.u);
<font color="blue">end </font>FPToFPCycle;
</pre>
<hr>

<h2><img src="images/FCSys.Regions.Examples.FPToFPI.png" alt="FCSys.Regions.Examples.GDLToGDL" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Regions.Examples.GDLToGDL"></a><a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples">FCSys.Regions.Examples</a>.GDLToGDL</h2>
<b>Test one GDL to the other</b><p>
<img src="images/FCSys.Regions.Examples.GDLToGDLD.png" alt="FCSys.Regions.Examples.GDLToGDL">

<h3>Information</h3>

Extends from <a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a> (Icon for runnable examples).
<p>

<h3>Parameters</h3>

<p>
<table border=1 cellspacing=0 cellpadding=2>
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<TR bgcolor="#e0e0e0"><TD colspan=4>Geometry</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Length</a></td><td>L_y[:]</td><td>fill(U.m/2, 2)</td><td>Lengths along the channel [l]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Length</a></td><td>L_z[:]</td><td>{5*U.mm}</td><td>Lengths across the channel [l]</td></tr>
</table>
<p>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> GDLToGDL <font color="darkgreen">&quot;Test one GDL to the other&quot;</font>

  <font color="blue">extends </font><a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a>;

  <a href="FCSys_Quantities.html#FCSys.Quantities.Potential">Q.Potential</a> w <font color="darkgreen">&quot;Electrical potential&quot;</font>;
  <a href="FCSys_Quantities.html#FCSys.Quantities.Current">Q.Current</a> zI=<font color="red">sum</font>(zJ .* anGDL.subregions[1, :, :].A[Axis.x]) <font color="darkgreen">
    &quot;Electrical current&quot;</font>;
  <a href="FCSys_Quantities.html#FCSys.Quantities.CurrentAreic">Q.CurrentAreic</a> zJ[n_y, n_z]=-anBC.graphite.'e-'.face.phi[1] .* anBC.graphite.
      'e-'.face.rho <font color="darkgreen">&quot;Electrical current density&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Number">Q.Number</a> zJ_Apercm2=(zI/(<font color="red">sum</font>(L_y)*<font color="red">sum</font>(L_z)))*U.cm^2/U.A <font color="darkgreen">
    &quot;Average electrical current density, in A/cm2&quot;</font>;

  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Q.Length</a> L_y[:]=<font color="red">fill</font>(U.m/2, 2) <font color="darkgreen">&quot;Lengths along the channel&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Q.Length</a> L_z[:]={5*U.mm} <font color="darkgreen">&quot;Lengths across the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Integer n_y=<font color="red">size</font>(L_y, 1) <font color="darkgreen">
    &quot;Number of regions along the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Integer n_z=<font color="red">size</font>(L_z, 1) <font color="darkgreen">
    &quot;Number of regions across the channel&quot;</font>;
  <a href="FCSys_Regions_AnGDLs.html#FCSys.Regions.AnGDLs.AnGDL">AnGDLs.AnGDL</a> anGDL(<font color="blue">final </font>L_y=L_y, <font color="blue">final </font>L_z=L_z);
  <a href="FCSys_Regions_AnCLs.html#FCSys.Regions.AnCLs.AnCL">AnCLs.AnCL</a> anCL(<font color="blue">final </font>L_y=L_y, <font color="blue">final </font>L_z=L_z);

  <a href="FCSys_Regions_PEMs.html#FCSys.Regions.PEMs.PEM">PEMs.PEM</a> PEM(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(ionomer(&#39;H+&#39;(initTransX=InitTranslational.none,phi(stateSelect={
                StateSelect.always,StateSelect.default,StateSelect.default})))));

  <a href="FCSys_Regions_CaCLs.html#FCSys.Regions.CaCLs.CaCL">CaCLs.CaCL</a> caCL(<font color="blue">final </font>L_y=L_y, <font color="blue">final </font>L_z=L_z);

  <a href="FCSys_Regions_CaGDLs.html#FCSys.Regions.CaGDLs.CaGDL">CaGDLs.CaGDL</a> caGDL(<font color="blue">final </font>L_y=L_y, <font color="blue">final </font>L_z=L_z);

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusEfforts">Conditions.ByConnector.FaceBus.Single.FaceBusEfforts</a> anBC[n_y, n_z](
    <font color="blue">each </font>gas(
      inclH2=true,
      inclH2O=true,
      H2(materialSet(y=(environment.p - environment.p_H2O)/environment.T)),
      H2O(materialSet(y=environment.p_H2O/environment.T))),
    <font color="blue">each </font>graphite(&#39;incle-&#39;=true, &#39;e-&#39;(
        <font color="blue">redeclare </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=0),
        <font color="blue">redeclare </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">Conditions.ByConnector.Face.Single.TranslationalNormal.force</a>)),

    <font color="blue">each </font>liquid(inclH2O=anGDL.subregions[1, 1, 1].liquid.inclH2O, H2O(<font color="blue">
          redeclare </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,
          materialSet(y=0))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusEfforts">Conditions.ByConnector.FaceBus.Single.FaceBusEfforts</a> caBC[n_y, n_z](
    <font color="blue">each </font>gas(
      inclH2O=true,
      inclN2=true,
      inclO2=true,
      H2O(materialSet(y=environment.p_H2O/environment.T)),
      N2(materialSet(y=(environment.p - environment.p_H2O - environment.p_O2)/
              environment.T)),
      O2(materialSet(y=environment.p_O2/environment.T))),
    graphite(<font color="blue">each </font>&#39;incle-&#39;=true, &#39;e-&#39;(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">Conditions.ByConnector.Face.Single.Material.current</a>,

        <font color="blue">each </font>materialSet(y=0),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">Conditions.ByConnector.Face.Single.TranslationalNormal.force</a>,

        normalSet(y=-w*anGDL.subregions[1, :, :].A[Axis.x] .* caBC.graphite.
              'e-'.face.rho))),
    <font color="blue">each </font>liquid(inclH2O=caGDL.subregions[1, 1, 1].liquid.inclH2O, H2O(<font color="blue">
          redeclare </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,
          materialSet(y=0))));

  <font color="blue">inner </font><a href="FCSys_Conditions.html#FCSys.Conditions.Environment">Conditions.Environment</a> environment(analysis=true) <font color="darkgreen">
    &quot;Environmental conditions&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.Ramp">Modelica.Blocks.Sources.Ramp</a> derVoltageSet(
    duration=225,
    startTime=10,
    height=-0.01*U.V/U.s);
<font color="blue">initial </font><font color="blue">equation </font>
  zJ = <font color="red">zeros</font>(n_y, n_z);
<font color="blue">equation </font>
  <font color="red">der</font>(w)/U.s = derVoltageSet.y;
  <font color="red">connect</font>(anGDL.xPositive, anCL.xNegative);

  <font color="red">connect</font>(anCL.xPositive, PEM.xNegative);

  <font color="red">connect</font>(PEM.xPositive, caCL.xNegative);

  <font color="red">connect</font>(caCL.xPositive, caGDL.xNegative);

  <font color="red">connect</font>(anBC.face, anGDL.xNegative);

  <font color="red">connect</font>(caGDL.xPositive, caBC.face);

<font color="blue">end </font>GDLToGDL;
</pre>
<hr>

<h2><img src="images/FCSys.Regions.Examples.FPToFPI.png" alt="FCSys.Regions.Examples.CLToCL" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Regions.Examples.CLToCL"></a><a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples">FCSys.Regions.Examples</a>.CLToCL</h2>
<b>Test one catalyst layer to the other</b><p>
<img src="images/FCSys.Regions.Examples.CLToCLD.png" alt="FCSys.Regions.Examples.CLToCL">

<h3>Information</h3>

Extends from <a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a> (Icon for runnable examples).
<p>

<h3>Parameters</h3>

<p>
<table border=1 cellspacing=0 cellpadding=2>
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<TR bgcolor="#e0e0e0"><TD colspan=4>Geometry</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Length</a></td><td>L_y[:]</td><td>fill(U.m/1, 1)</td><td>Lengths along the channel [l]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Length</a></td><td>L_z[:]</td><td>{5*U.mm}</td><td>Lengths across the channel [l]</td></tr>
</table>
<p>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> CLToCL <font color="darkgreen">&quot;Test one catalyst layer to the other&quot;</font>

  <font color="blue">extends </font><a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a>;

  <a href="FCSys_Quantities.html#FCSys.Quantities.Potential">Q.Potential</a> w <font color="darkgreen">&quot;Electrical potential&quot;</font>;
  <a href="FCSys_Quantities.html#FCSys.Quantities.Current">Q.Current</a> zI=<font color="red">sum</font>(zJ .* anCL.subregions[1, :, :].A[Axis.x]) <font color="darkgreen">
    &quot;Electrical current&quot;</font>;
  <a href="FCSys_Quantities.html#FCSys.Quantities.CurrentAreic">Q.CurrentAreic</a> zJ[n_y, n_z]=-anBC.graphite.'e-'.face.phi[1] .* anBC.graphite.
      'e-'.face.rho <font color="darkgreen">&quot;Electrical current density&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Number">Q.Number</a> zJ_Apercm2=(zI/(<font color="red">sum</font>(L_y)*<font color="red">sum</font>(L_z)))*U.cm^2/U.A <font color="darkgreen">
    &quot;Average electrical current density, in A/cm2&quot;</font>;

  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Q.Length</a> L_y[:]=<font color="red">fill</font>(U.m/1, 1) <font color="darkgreen">&quot;Lengths along the channel&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Q.Length</a> L_z[:]={5*U.mm} <font color="darkgreen">&quot;Lengths across the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Integer n_y=<font color="red">size</font>(L_y, 1) <font color="darkgreen">
    &quot;Number of regions along the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Integer n_z=<font color="red">size</font>(L_z, 1) <font color="darkgreen">
    &quot;Number of regions across the channel&quot;</font>;

  <a href="FCSys_Regions_AnCLs.html#FCSys.Regions.AnCLs.AnCL">AnCLs.AnCL</a> anCL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(ionomer(&#39;H+&#39;(initMaterial=InitScalar.none))));

  <a href="FCSys_Regions_PEMs.html#FCSys.Regions.PEMs.PEM">PEMs.PEM</a> PEM(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(ionomer(&#39;H+&#39;(initTransX=InitTranslational.none))));

  <a href="FCSys_Regions_CaCLs.html#FCSys.Regions.CaCLs.CaCL">CaCLs.CaCL</a> caCL(<font color="blue">final </font>L_y=L_y, <font color="blue">final </font>L_z=L_z);

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusEfforts">Conditions.ByConnector.FaceBus.Single.FaceBusEfforts</a> anBC[n_y, n_z](
    <font color="blue">each </font>gas(
      inclH2=true,
      inclH2O=true,
      H2(materialSet(y=(environment.p - environment.p_H2O)/environment.T)),
      H2O(materialSet(y=environment.p_H2O/environment.T))),
    <font color="blue">each </font>graphite(&#39;incle-&#39;=true, &#39;e-&#39;(<font color="blue">redeclare </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">Conditions.ByConnector.Face.Single.TranslationalNormal.force</a>)),

    <font color="blue">each </font>liquid(inclH2O=anCL.subregions[1, 1, 1].liquid.inclH2O, H2O(<font color="blue">redeclare </font><font color="blue">
          function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,
          materialSet(y=0))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusEfforts">Conditions.ByConnector.FaceBus.Single.FaceBusEfforts</a> caBC[n_y, n_z](
    <font color="blue">each </font>gas(
      inclH2O=true,
      inclN2=true,
      inclO2=true,
      H2O(materialSet(y=environment.p_H2O/environment.T)),
      N2(materialSet(y=(environment.p - environment.p_H2O - environment.p_O2)/
              environment.T)),
      O2(materialSet(y=environment.p_O2/environment.T))),
    graphite(<font color="blue">each </font>&#39;incle-&#39;=true, &#39;e-&#39;(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">Conditions.ByConnector.Face.Single.TranslationalNormal.force</a>,
          normalSet(y=-w*anCL.subregions[1, :, :].A[Axis.x] .* caBC.graphite.
              'e-'.face.rho))),
    <font color="blue">each </font>liquid(inclH2O=caCL.subregions[1, 1, 1].liquid.inclH2O, H2O(<font color="blue">redeclare </font><font color="blue">
          function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,
          materialSet(y=0))));

  <font color="blue">inner </font><a href="FCSys_Conditions.html#FCSys.Conditions.Environment">Conditions.Environment</a> environment(analysis=true) <font color="darkgreen">
    &quot;Environmental conditions&quot;</font>;

  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.Ramp">Modelica.Blocks.Sources.Ramp</a> currSet(
    height=2.25*50*U.A,
    duration=225,
    startTime=10);
<font color="blue">equation </font>
  zI = currSet.y;
  <font color="red">connect</font>(anCL.xPositive, PEM.xNegative);
  <font color="red">connect</font>(PEM.xPositive, caCL.xNegative);

  <font color="red">connect</font>(anBC.face, anCL.xNegative);
  <font color="red">connect</font>(caBC.face, caCL.xPositive);
<font color="blue">end </font>CLToCL;
</pre>
<hr>

<h2><img src="images/FCSys.Regions.Examples.FPToFPI.png" alt="FCSys.Regions.Examples.AnFP" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Regions.Examples.AnFP"></a><a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples">FCSys.Regions.Examples</a>.AnFP</h2>
<b>Test the anode flow plate</b><p>
<img src="images/FCSys.Regions.Examples.AnFPD.png" alt="FCSys.Regions.Examples.AnFP">

<h3>Information</h3>

Extends from <a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a> (Icon for runnable examples).
<p>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> AnFP <font color="darkgreen">&quot;Test the anode flow plate&quot;</font>

  <font color="blue">extends </font><a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a>;

  <a href="FCSys_Regions_AnFPs.html#FCSys.Regions.AnFPs.AnFP">AnFPs.AnFP</a> anFP(L_x={1,1}*U.m);

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> anBC[anFP.n_y, anFP.n_z](<font color="blue">
      each </font>graphite(&#39;inclC+&#39;=true,&#39;incle-&#39;=true));
  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> caBC[anFP.n_y, anFP.n_z](
    <font color="blue">each </font>gas(inclH2=true, inclH2O=true),
    <font color="blue">each </font>graphite(&#39;incle-&#39;=true),
    <font color="blue">each </font>liquid(inclH2O=anFP.subregions[1, 1, 1].liquid.inclH2O));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> anSource[anFP.n_x, anFP.n_z]
    (<font color="blue">each </font>gas(inclH2=true, inclH2O=true));
  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> anSink[anFP.n_x, anFP.n_z]
    (<font color="blue">each </font>gas(inclH2=true, inclH2O=true));
  <font color="blue">inner </font><a href="FCSys_Conditions.html#FCSys.Conditions.Environment">Conditions.Environment</a> environment(analysis=true) <font color="darkgreen">
    &quot;Environmental conditions&quot;</font>;

<font color="blue">equation </font>
  <font color="red">connect</font>(anBC.face, anFP.xNegative);

  <font color="red">connect</font>(caBC.face, anFP.xPositive);

  <font color="red">connect</font>(anSource.face, anFP.yNegative);
  <font color="red">connect</font>(anSink.face, anFP.yPositive);
<font color="blue">end </font>AnFP;
</pre>
<hr>

<h2><img src="images/FCSys.Regions.Examples.FPToFPI.png" alt="FCSys.Regions.Examples.AnGDL" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Regions.Examples.AnGDL"></a><a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples">FCSys.Regions.Examples</a>.AnGDL</h2>
<b>Test the anode gas diffusion layer</b><p>
<img src="images/FCSys.Regions.Examples.AnGDLD.png" alt="FCSys.Regions.Examples.AnGDL">

<h3>Information</h3>

Extends from <a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a> (Icon for runnable examples).
<p>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> AnGDL <font color="darkgreen">&quot;Test the anode gas diffusion layer&quot;</font>

  <font color="blue">extends </font><a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a>;

  <a href="FCSys_Regions_AnGDLs.html#FCSys.Regions.AnGDLs.AnGDL">AnGDLs.AnGDL</a> anGDL;

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> anBC[anGDL.n_y, anGDL.n_z]
    (
    <font color="blue">each </font>gas(inclH2=true, inclH2O=true),
    <font color="blue">each </font>graphite(&#39;incle-&#39;=true),
    <font color="blue">each </font>liquid(inclH2O=anGDL.subregions[1, 1, 1].liquid.inclH2O));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> caBC[anGDL.n_y, anGDL.n_z]
    (
    <font color="blue">each </font>gas(inclH2=true, inclH2O=true),
    <font color="blue">each </font>graphite(&#39;incle-&#39;=true),
    <font color="blue">each </font>liquid(inclH2O=anGDL.subregions[1, 1, 1].liquid.inclH2O));
  <font color="blue">inner </font><a href="FCSys_Conditions.html#FCSys.Conditions.Environment">Conditions.Environment</a> environment(analysis=true) <font color="darkgreen">
    &quot;Environmental conditions&quot;</font>;

<font color="blue">equation </font>
  <font color="red">connect</font>(anBC.face, anGDL.xNegative);

  <font color="red">connect</font>(anGDL.xPositive, caBC.face);

<font color="blue">end </font>AnGDL;
</pre>
<hr>

<h2><img src="images/FCSys.Regions.Examples.FPToFPI.png" alt="FCSys.Regions.Examples.AnCL" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Regions.Examples.AnCL"></a><a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples">FCSys.Regions.Examples</a>.AnCL</h2>
<b>Test the anode catalyst layer</b><p>
<img src="images/FCSys.Regions.Examples.AnCLD.png" alt="FCSys.Regions.Examples.AnCL">

<h3>Information</h3>

Extends from <a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a> (Icon for runnable examples).
<p>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> AnCL <font color="darkgreen">&quot;Test the anode catalyst layer&quot;</font>

  <font color="blue">extends </font><a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a>;

  <font color="darkgreen">/*
  output Q.Potential w[1, n_y, n_z]=-anCL.subregions.reaction.chemical.mu/2
    &quot;Reaction potential&quot;;
  output Q.Current zI[1, n_y, n_z]=anCL.subregions.graphite.&#39;e-&#39;.chemical.Ndot
    &quot;Electrical current due to reaction&quot;;
  output Q.Number zJ_Apercm2[1, n_y, n_z]=(zI*U.cm^2) ./ (anCL.subregions[:, :,
      :].A[Axis.x]*U.A) &quot;Electrical current density, in A/cm2&quot;;
  output Q.Power Qdot=sum(anCL.subregions.graphite.&#39;C+&#39;.Edot_DE)
    &quot;Rate of heat generation&quot;;
  output Q.Power P=sum(w .* zI) &quot;Electrical power&quot;;
  output Q.NumberAbsolute eta=P/(P + Qdot) &quot;Efficiency&quot;;
  */</font>
  <font color="darkgreen">// **Fix Qdot, P, eta</font>
  <a href="FCSys_Regions_AnCLs.html#FCSys.Regions.AnCLs.AnCL">AnCLs.AnCL</a> anCL;

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusEfforts">Conditions.ByConnector.FaceBus.Single.FaceBusEfforts</a> anBC[anCL.n_y, anCL.n_z]
    (
    <font color="blue">each </font>gas(
      inclH2=true,
      inclH2O=true,
      H2(materialSet(y=(environment.p - environment.p_H2O)/environment.T)),
      H2O(materialSet(y=environment.p_H2O/environment.T))),
    <font color="blue">each </font>graphite(&#39;incle-&#39;=true, &#39;e-&#39;(<font color="blue">redeclare </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,
          <font color="blue">redeclare </font><a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.Ramp">Modelica.Blocks.Sources.Ramp</a> normalSet(
          height=-U.A/U.cm^2,
          duration=100.1,
          startTime=0.1))),
    <font color="blue">each </font>liquid(inclH2O=anCL.subregions[1, 1, 1].liquid.inclH2O));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusEfforts">Conditions.ByConnector.FaceBus.Single.FaceBusEfforts</a> caBC[anCL.n_y, anCL.n_z]
    (<font color="blue">each </font>ionomer(
      &#39;inclH+&#39;=true,
      inclH2O=true,
      &#39;H+&#39;(<font color="blue">redeclare </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">Conditions.ByConnector.Face.Single.TranslationalNormal.force</a>)));

<font color="blue">inner </font><a href="FCSys_Conditions.html#FCSys.Conditions.Environment">Conditions.Environment</a> environment(analysis=true) <font color="darkgreen">
    &quot;Environmental conditions&quot;</font>;
<font color="blue">equation </font>
  <font color="red">connect</font>(anBC.face, anCL.xNegative);

  <font color="red">connect</font>(anCL.xPositive, caBC.face);

<font color="blue">end </font>AnCL;
</pre>
<hr>

<h2><img src="images/FCSys.Regions.Examples.FPToFPI.png" alt="FCSys.Regions.Examples.PEM" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Regions.Examples.PEM"></a><a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples">FCSys.Regions.Examples</a>.PEM</h2>
<b>Test the proton exchange membrane</b><p>
<img src="images/FCSys.Regions.Examples.PEMD.png" alt="FCSys.Regions.Examples.PEM">

<h3>Information</h3>

Extends from <a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a> (Icon for runnable examples).
<p>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> PEM <font color="darkgreen">&quot;Test the proton exchange membrane&quot;</font>

  <font color="blue">extends </font><a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a>;

  <a href="FCSys_Regions_PEMs.html#FCSys.Regions.PEMs.PEM">PEMs.PEM</a> PEM;

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> anBC[PEM.n_y, PEM.n_z](<font color="blue">
      each </font>ionomer(&#39;inclH+&#39;=true,inclH2O=true));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> caBC[PEM.n_y, PEM.n_z](<font color="blue">
      each </font>ionomer(&#39;inclH+&#39;=true,inclH2O=true));
  <font color="blue">inner </font><a href="FCSys_Conditions.html#FCSys.Conditions.Environment">Conditions.Environment</a> environment(analysis=true) <font color="darkgreen">
    &quot;Environmental conditions&quot;</font>;

<font color="blue">equation </font>
  <font color="red">connect</font>(anBC.face, PEM.xNegative);

  <font color="red">connect</font>(PEM.xPositive, caBC.face);

<font color="blue">end </font>PEM;
</pre>
<hr>

<h2><img src="images/FCSys.Regions.Examples.FPToFPI.png" alt="FCSys.Regions.Examples.CaCL" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Regions.Examples.CaCL"></a><a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples">FCSys.Regions.Examples</a>.CaCL</h2>
<b>Test the cathode catalyst layer</b><p>
<img src="images/FCSys.Regions.Examples.CaCLD.png" alt="FCSys.Regions.Examples.CaCL">

<h3>Information</h3>

Extends from <a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a> (Icon for runnable examples).
<p>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> CaCL <font color="darkgreen">&quot;Test the cathode catalyst layer&quot;</font>

  <font color="blue">extends </font><a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a>;

  <font color="darkgreen">/*
  output Q.Potential w[1, n_y, n_z]=-caCL.subregions.reaction.chemical.mu/2
    &quot;Reaction potential&quot;;
  output Q.Current zI[1, n_y, n_z]=caCL.subregions.graphite.&#39;e-&#39;.chemical.Ndot
    &quot;Electrical current due to reaction&quot;;
  output Q.Number zJ_Apercm2[1, n_y, n_z]=(zI*U.cm^2) ./ (caCL.subregions[:, :,
      :].A[Axis.x]*U.A) &quot;Electrical current density, in A/cm2&quot;;
  output Q.Power Qdot=sum(caCL.subregions.graphite.&#39;C+&#39;.Edot_DE)
    &quot;Rate of heat generation&quot;;
  output Q.Power P=sum(w .* zI) &quot;Electrical power&quot;;
  output Q.NumberAbsolute eta=P/(P + Qdot) &quot;Efficiency&quot;;
  // **Fix Qdot, P, eta

  // **Add and use variable for w in Subregion model.
*/</font>

  <a href="FCSys_Regions_CaCLs.html#FCSys.Regions.CaCLs.CaCL">CaCLs.CaCL</a> caCL;
  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusEfforts">Conditions.ByConnector.FaceBus.Single.FaceBusEfforts</a> anBC[caCL.n_y, caCL.n_z]
    (<font color="blue">each </font>ionomer(
      &#39;inclH+&#39;=true,
      inclH2O=true,
      &#39;H+&#39;(<font color="blue">redeclare </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">Conditions.ByConnector.Face.Single.TranslationalNormal.force</a>)));

<a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusEfforts">Conditions.ByConnector.FaceBus.Single.FaceBusEfforts</a> caBC[caCL.n_y, caCL.n_z]
    (
    <font color="blue">each </font>gas(
      inclH2O=true,
      inclO2=true,
      H2O(materialSet(y=environment.p_H2O/environment.T)),
      O2(materialSet(y=environment.p_O2/environment.T))),
    <font color="blue">each </font>graphite(&#39;incle-&#39;=true, &#39;e-&#39;(<font color="blue">redeclare </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,
          <font color="blue">redeclare </font><a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.Ramp">Modelica.Blocks.Sources.Ramp</a> normalSet(
          height=-U.A/U.cm^2,
          duration=100.1,
          startTime=0.1))),
    <font color="blue">each </font>liquid(inclH2O=caCL.subregions[1, 1, 1].liquid.inclH2O));

  <font color="blue">inner </font><a href="FCSys_Conditions.html#FCSys.Conditions.Environment">Conditions.Environment</a> environment(analysis=true) <font color="darkgreen">
    &quot;Environmental conditions&quot;</font>;

<font color="blue">equation </font>
  <font color="red">connect</font>(anBC.face, caCL.xNegative);

  <font color="red">connect</font>(caBC.face, caCL.xPositive);
<font color="blue">end </font>CaCL;
</pre>
<hr>

<h2><img src="images/FCSys.Regions.Examples.FPToFPI.png" alt="FCSys.Regions.Examples.CaGDL" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Regions.Examples.CaGDL"></a><a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples">FCSys.Regions.Examples</a>.CaGDL</h2>
<b>Test the cathode gas diffusion layer</b><p>
<img src="images/FCSys.Regions.Examples.CaGDLD.png" alt="FCSys.Regions.Examples.CaGDL">

<h3>Information</h3>

Extends from <a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a> (Icon for runnable examples).
<p>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> CaGDL <font color="darkgreen">&quot;Test the cathode gas diffusion layer&quot;</font>

  <font color="blue">extends </font><a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a>;

  <a href="FCSys_Regions_CaGDLs.html#FCSys.Regions.CaGDLs.CaGDL">CaGDLs.CaGDL</a> caGDL;
  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> anBC[caGDL.n_y, caGDL.n_z]
    (
    <font color="blue">each </font>gas(
      inclH2O=true,
      inclN2=true,
      inclO2=true),
    <font color="blue">each </font>graphite(&#39;incle-&#39;=true),
    <font color="blue">each </font>liquid(inclH2O=caGDL.subregions[1, 1, 1].liquid.inclH2O));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> caBC[caGDL.n_y, caGDL.n_z]
    (
    <font color="blue">each </font>gas(
      inclH2O=true,
      inclN2=true,
      inclO2=true),
    <font color="blue">each </font>graphite(&#39;incle-&#39;=true),
    <font color="blue">each </font>liquid(inclH2O=caGDL.subregions[1, 1, 1].liquid.inclH2O));
  <font color="blue">inner </font><a href="FCSys_Conditions.html#FCSys.Conditions.Environment">Conditions.Environment</a> environment(analysis=true) <font color="darkgreen">
    &quot;Environmental conditions&quot;</font>;

<font color="blue">equation </font>
  <font color="red">connect</font>(anBC.face, caGDL.xNegative);

  <font color="red">connect</font>(caBC.face, caGDL.xPositive);
<font color="blue">end </font>CaGDL;
</pre>
<hr>

<h2><img src="images/FCSys.Regions.Examples.FPToFPI.png" alt="FCSys.Regions.Examples.CaFP" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Regions.Examples.CaFP"></a><a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples">FCSys.Regions.Examples</a>.CaFP</h2>
<b>Test the cathode flow plate</b><p>
<img src="images/FCSys.Regions.Examples.CaFPD.png" alt="FCSys.Regions.Examples.CaFP">

<h3>Information</h3>

Extends from <a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a> (Icon for runnable examples).
<p>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> CaFP <font color="darkgreen">&quot;Test the cathode flow plate&quot;</font>

  <font color="blue">extends </font><a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a>;

  <a href="FCSys_Regions_CaFPs.html#FCSys.Regions.CaFPs.CaFP">CaFPs.CaFP</a> caFP;

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> anBC[caFP.n_y, caFP.n_z](
    <font color="blue">each </font>gas(
      inclH2O=true,
      inclN2=true,
      inclO2=true),
    <font color="blue">each </font>graphite(&#39;incle-&#39;=true),
    <font color="blue">each </font>liquid(inclH2O=caFP.subregions[1, 1, 1].liquid.inclH2O));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> caBC[caFP.n_y, caFP.n_z](<font color="blue">
      each </font>graphite(&#39;inclC+&#39;=true,&#39;incle-&#39;=true));
  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> anSource[caFP.n_x, caFP.n_z]
    (<font color="blue">each </font>gas(
      inclH2O=true,
      inclN2=true,
      inclO2=true), <font color="blue">each </font>liquid(inclH2O=caFP.subregions[1, 1, 1].liquid.inclH2O));
  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> anSink[caFP.n_x, caFP.n_z]
    (<font color="blue">each </font>gas(
      inclH2O=true,
      inclN2=true,
      inclO2=true), <font color="blue">each </font>liquid(inclH2O=caFP.subregions[1, 1, 1].liquid.inclH2O));
  <font color="blue">inner </font><a href="FCSys_Conditions.html#FCSys.Conditions.Environment">Conditions.Environment</a> environment(analysis=true) <font color="darkgreen">
    &quot;Environmental conditions&quot;</font>;

<font color="blue">equation </font>
  <font color="red">connect</font>(anBC.face, caFP.xNegative);

  <font color="red">connect</font>(caFP.xPositive, caBC.face);

  <font color="red">connect</font>(anSource.face, caFP.yNegative);
  <font color="red">connect</font>(anSink.face, caFP.yPositive);
<font color="blue">end </font>CaFP;
</pre>
<hr>

<h2><img src="images/FCSys.Regions.Examples.FPToFPI.png" alt="FCSys.Regions.Examples.FPToFPO2" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Regions.Examples.FPToFPO2"></a><a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples">FCSys.Regions.Examples</a>.FPToFPO2</h2>
<b>Test one flow plate to the other</b><p>
<img src="images/FCSys.Regions.Examples.FPToFPO2D.png" alt="FCSys.Regions.Examples.FPToFPO2">

<h3>Information</h3>

Extends from <a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a> (Icon for runnable examples).
<p>

<h3>Parameters</h3>

<p>
<table border=1 cellspacing=0 cellpadding=2>
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>anStoich</td><td>1.5</td><td>Anode stoichiometric ratio [1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>caStoich</td><td>2.0</td><td>Cathode stoichiometric ratio [1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>anInletRH</td><td>0.8</td><td>[1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>caInletRH</td><td>0.5</td><td>[1]</td></tr>
<tr><td>Real</td><td>T_degC</td><td>60</td><td>&nbsp;</td></tr>
<tr><td>Real</td><td>p_kPag</td><td>48.3</td><td>&nbsp;</td></tr>
<TR bgcolor="#e0e0e0"><TD colspan=4>Geometry</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Length</a></td><td>L_y[:]</td><td>{U.m}</td><td>Lengths along the channel [l]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Length</a></td><td>L_z[:]</td><td>{5*U.mm}</td><td>Lengths across the channel [l]</td></tr>
</table>
<p>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> FPToFPO2 <font color="darkgreen">&quot;Test one flow plate to the other&quot;</font>

  <font color="blue">extends </font><a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a>;

  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> n_O2=1;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> anStoich=1.5 <font color="darkgreen">&quot;Anode stoichiometric ratio&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> caStoich=2.0 <font color="darkgreen">&quot;Cathode stoichiometric ratio&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> anInletRH=0.8;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> caInletRH=0.5;
  <font color="blue">parameter </font>Real T_degC=60;
  <font color="blue">parameter </font>Real p_kPag=48.3;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.TemperatureAbsolute">Q.TemperatureAbsolute</a> T=<font color="red">U.from_degC</font>(T_degC);
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p=<font color="red">U.from_kPag</font>(p_kPag);
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p_H2O_an_in=anInletRH*<font color="red">
      Modelica.Media.Air.MoistAir.saturationPressureLiquid</font>(T/U.K)*U.Pa <font color="darkgreen">
    &quot;Pressure of H2O vapor&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p_H2O_ca_in=caInletRH*<font color="red">
      Modelica.Media.Air.MoistAir.saturationPressureLiquid</font>(T/U.K)*U.Pa <font color="darkgreen">
    &quot;Pressure of H2O vapor&quot;</font>;

  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Potential">Q.Potential</a> w[n_y, n_z]=caBC.graphite.'e-'.face.mPhidot[1] ./ (caBC.graphite.
      'e-'.face.rho*PEM.A[Axis.x]) - anBC.graphite.'e-'.face.mPhidot[1] ./ (
      anBC.graphite.'e-'.face.rho*PEM.A[Axis.x]) <font color="darkgreen">&quot;Potential&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.CurrentAreic">Q.CurrentAreic</a> zJ[n_y, n_z]=-anBC.graphite.'e-'.face.phi[1] .* anBC.graphite.
      'e-'.face.rho <font color="darkgreen">&quot;Current density&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Number">Q.Number</a> zJ_Apercm2[n_y, n_z]=zJ*U.cm^2/U.A <font color="darkgreen">
    &quot;Electrical current density, in A/cm2&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Current">Q.Current</a> zI=<font color="red">sum</font>(zJ .* <font color="red">outerProduct</font>(L_y, L_z)) <font color="darkgreen">
    &quot;Total electrical current&quot;</font>;

  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Q.Length</a> L_y[:]={U.m} <font color="darkgreen">&quot;Lengths along the channel&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Q.Length</a> L_z[:]={5*U.mm} <font color="darkgreen">&quot;Lengths across the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Integer n_y=<font color="red">size</font>(L_y, 1) <font color="darkgreen">
    &quot;Number of regions along the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Integer n_z=<font color="red">size</font>(L_z, 1) <font color="darkgreen">
    &quot;Number of regions across the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_an_seg[anFP.n_x, n_z]=<font color="red">outerProduct</font>(anFP.L_x, L_z) <font color="darkgreen">
    &quot;Areas of the segments over the xz plane of the anode flow plate&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_ca_seg[caFP.n_x, n_z]=<font color="red">outerProduct</font>(caFP.L_x, L_z) <font color="darkgreen">
    &quot;Areas of the segments over the xz plane of the cathode flow plate&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_an=<font color="red">sum</font>(anFP.L_x)*<font color="red">sum</font>(L_z) <font color="darkgreen">
    &quot;Total cross-sectional area of the anode flow plate in the xz plane&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_ca=<font color="red">sum</font>(caFP.L_x)*<font color="red">sum</font>(L_z) <font color="darkgreen">
    &quot;Total cross-sectional area of the cathode flow plate in the xz plane&quot;</font>;

  <a href="FCSys_Regions_AnFPs.html#FCSys.Regions.AnFPs.AnFP">AnFPs.AnFP</a> anFP(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(gas(H2O(T_IC=T)),graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_AnGDLs.html#FCSys.Regions.AnGDLs.AnGDL">AnGDLs.AnGDL</a> anGDL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(gas(H2O(T_IC=T)),graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_AnCLs.html#FCSys.Regions.AnCLs.AnCL">AnCLs.AnCL</a> anCL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(
      gas(H2O(T_IC=T)),
      graphite(&#39;C+&#39;(T_IC=T)),
      ionomer(&#39;SO3-&#39;(T_IC=T))));

  <a href="FCSys_Regions_PEMs.html#FCSys.Regions.PEMs.PEM">PEMs.PEM</a> PEM(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(ionomer(&#39;SO3-&#39;(T_IC=T),&#39;H+&#39;(initTransX=InitTranslational.none))));

  <a href="FCSys_Regions_CaCLs.html#FCSys.Regions.CaCLs.CaCL">CaCLs.CaCL</a> caCL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(
      gas(<font color="blue">final </font>inclN2=false, H2O(T_IC=T)),
      graphite(&#39;C+&#39;(T_IC=T)),
      ionomer(&#39;SO3-&#39;(T_IC=T))));

  <a href="FCSys_Regions_CaGDLs.html#FCSys.Regions.CaGDLs.CaGDL">CaGDLs.CaGDL</a> caGDL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(gas(<font color="blue">final </font>inclN2=false,H2O(T_IC=T)),graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_CaFPs.html#FCSys.Regions.CaFPs.CaFP">CaFPs.CaFP</a> caFP(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(gas(<font color="blue">final </font>inclN2=false,H2O(T_IC=T)),graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> anBC[n_y, n_z](<font color="blue">each </font>
      graphite(&#39;incle-&#39;=true, &#39;e-&#39;(
        <font color="blue">redeclare </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.Ramp">Modelica.Blocks.Sources.Ramp</a> normalSet(
          height=-2.25*U.A/U.cm^2,
          duration=225.1,
          startTime=0.1),
        <font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,

        thermalSet(y=T))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> caBC[n_y, n_z](<font color="blue">each </font>
      graphite(&#39;incle-&#39;=true, &#39;e-&#39;(<font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,
          thermalSet(y=T))));
  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusEfforts">Conditions.ByConnector.FaceBus.Single.FaceBusEfforts</a> anSource[anFP.n_x, n_z](
      gas(
      <font color="blue">each </font>inclH2=true,
      <font color="blue">each </font>inclH2O=true,
      H2(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(anSource.gas.H2.normalOut.y - <font color="red">fill</font>(
              zI*anStoich/(2*A_an),
              anFP.n_x,
              n_z)) .* A_an_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T)),
      H2O(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(anSource.gas.H2O.normalOut.y - <font color="red">fill</font>(
              zI*anStoich*p_H2O_an_in/(2*(environment.p - environment.p_H2O)*
                A_an),
              anFP.n_x,
              n_z)) .* A_an_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T))), <font color="blue">each </font>liquid(inclH2O=anFP.subregions[1, 1, 1].liquid.inclH2O));

<a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> anSink[anFP.n_x, n_z](gas(
      <font color="blue">each </font>inclH2=true,
      <font color="blue">each </font>inclH2O=true,
      H2(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_an_out_noneq*A_an_seg .* anSink.gas.H2.face.rho ./ (
              anSink.gas.H2.face.rho + anSink.gas.H2O.face.rho))),
      H2O(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_an_out_noneq*A_an_seg .* anSink.gas.H2O.face.rho ./ (
              anSink.gas.H2.face.rho + anSink.gas.H2O.face.rho)))), <font color="blue">each </font>liquid(
        inclH2O=anFP.subregions[1, 1, 1].liquid.inclH2O));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusEfforts">Conditions.ByConnector.FaceBus.Single.FaceBusEfforts</a> caSource[caFP.n_x, n_z](
      gas(
      <font color="blue">each </font>inclH2O=true,
      <font color="blue">each </font>inclO2=true,
      H2O(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(caSource.gas.H2O.normalOut.y - <font color="red">fill</font>(
              zI*caStoich*p_H2O_ca_in/(4*p*n_O2*A_ca),
              caFP.n_x,
              n_z)) .* A_ca_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T)),
      O2(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(caSource.gas.O2.normalOut.y - <font color="red">fill</font>(
              zI*caStoich/(4*A_ca),
              caFP.n_x,
              n_z)) .* A_ca_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.force</a>,

        <font color="blue">each </font>thermalSet(y=T))), <font color="blue">each </font>liquid(inclH2O=caFP.subregions[1, 1, 1].liquid.inclH2O));

<a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> caSink[caFP.n_x, n_z](gas(
      <font color="blue">each </font>inclH2O=true,
      <font color="blue">each </font>inclO2=true,
      H2O(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_ca_out_noneq*A_ca_seg .* caSink.gas.H2O.face.rho ./ (
              caSink.gas.H2O.face.rho + caSink.gas.O2.face.rho))),
      O2(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_ca_out_noneq*A_ca_seg .* caSink.gas.O2.face.rho ./ (
              caSink.gas.H2O.face.rho + caSink.gas.O2.face.rho)))), <font color="blue">each </font>liquid(
        inclH2O=caFP.subregions[1, 1, 1].liquid.inclH2O));

  <font color="blue">inner </font><a href="FCSys_Conditions.html#FCSys.Conditions.Environment">Conditions.Environment</a> environment(analysis=true, T=T) <font color="darkgreen">
    &quot;Environmental conditions&quot;</font>;

  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> anPressSet(y(unit=&quot;m/(l.T2)&quot;) =
      environment.p) <font color="darkgreen">&quot;Setpoint for the total anode outlet pressure&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> caPressSet(y(unit=&quot;m/(l.T2)&quot;) =
      environment.p) <font color="darkgreen">&quot;Setpoint for the total cathode outlet pressure&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> anThermoPress(y(unit=&quot;m/(l.T2)&quot;) = <font color="red">sum</font>
      ((anSink.gas.H2.materialOut.y + anSink.gas.H2O.materialOut.y) .* <font color="red">
      outerProduct</font>(anFP.L_x, L_z))/A_an) <font color="darkgreen">
    &quot;Thermodynamic pressure at the anode outlet&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> caThermoPress(y(unit=&quot;m/(l.T2)&quot;) = <font color="red">sum</font>
      ((caSink.gas.H2O.materialOut.y + caSink.gas.O2.materialOut.y) .* A_ca_seg)
      /A_ca) <font color="darkgreen">&quot;Thermodynamic pressure at the cathode outlet&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Math.html#Modelica.Blocks.Math.Feedback">Modelica.Blocks.Math.Feedback</a> anNoneqSet;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Math.html#Modelica.Blocks.Math.Feedback">Modelica.Blocks.Math.Feedback</a> caNoneqSet;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Continuous.html#Modelica.Blocks.Continuous.FirstOrder">Modelica.Blocks.Continuous.FirstOrder</a> anValveDynamics(initType=Modelica.Blocks.Types.Init.InitialOutput,
      T=2) <font color="darkgreen">&quot;Dynamics of the anode exit valve&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Continuous.html#Modelica.Blocks.Continuous.FirstOrder">Modelica.Blocks.Continuous.FirstOrder</a> caValveDynamics(initType=Modelica.Blocks.Types.Init.InitialOutput,
      T=2) <font color="darkgreen">&quot;Dynamics of the cathode exit valve&quot;</font>;
<font color="blue">protected </font>
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> p_an_out_noneq(unit=&quot;m/(l.T2)&quot;) <font color="darkgreen">
    &quot;Nonequilibrium pressure at the anode outlet&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> p_ca_out_noneq(unit=&quot;m/(l.T2)&quot;) <font color="darkgreen">
    &quot;Nonequilibrium pressure at the cathode outlet&quot;</font>;
<font color="blue">equation </font>
  <font color="red">connect</font>(anFP.xPositive, anGDL.xNegative);
  <font color="red">connect</font>(anGDL.xPositive, anCL.xNegative);

  <font color="red">connect</font>(anCL.xPositive, PEM.xNegative);

  <font color="red">connect</font>(PEM.xPositive, caCL.xNegative);

  <font color="red">connect</font>(caCL.xPositive, caGDL.xNegative);

  <font color="red">connect</font>(caGDL.xPositive, caFP.xNegative);

  <font color="red">connect</font>(anSource.face, anFP.yNegative);
  <font color="red">connect</font>(anSink.face, anFP.yPositive);
  <font color="red">connect</font>(caSource.face, caFP.yNegative);
  <font color="red">connect</font>(caSink.face, caFP.yPositive);
  <font color="red">connect</font>(anBC.face, anFP.xNegative);

  <font color="red">connect</font>(caFP.xPositive, caBC.face);

  <font color="red">connect</font>(anValveDynamics.y, p_an_out_noneq);
  <font color="red">connect</font>(caValveDynamics.y, p_ca_out_noneq);
  <font color="red">connect</font>(caPressSet.y, caNoneqSet.u1);
  <font color="red">connect</font>(caThermoPress.y, caNoneqSet.u2);
  <font color="red">connect</font>(caNoneqSet.y, caValveDynamics.u);
  <font color="red">connect</font>(anPressSet.y, anNoneqSet.u1);
  <font color="red">connect</font>(anNoneqSet.u2, anThermoPress.y);
  <font color="red">connect</font>(anNoneqSet.y, anValveDynamics.u);
<font color="blue">end </font>FPToFPO2;
</pre>
<hr>

<h2><img src="images/FCSys.Regions.Examples.FPToFPLinearizeI.png" alt="FCSys.Regions.Examples.FPToFPLinearize" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Regions.Examples.FPToFPLinearize"></a><a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples">FCSys.Regions.Examples</a>.FPToFPLinearize</h2>
<b>Test one flow plate to the other</b><p>
<img src="images/FCSys.Regions.Examples.FPToFPLinearizeD.png" alt="FCSys.Regions.Examples.FPToFPLinearize">

<h3>Information</h3>

Extends from <a href="FCSys_Icons_Blocks.html#FCSys.Icons.Blocks.Continuous">FCSys.Icons.Blocks.Continuous</a> (Icon for a continuous-time block).
<p>

<h3>Parameters</h3>

<p>
<table border=1 cellspacing=0 cellpadding=2>
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>n_O2</td><td>0.21</td><td>[1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>anStoich</td><td>1.5</td><td>Anode stoichiometric ratio [1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>caStoich</td><td>2.0</td><td>Cathode stoichiometric ratio [1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>anInletRH</td><td>0.8</td><td>[1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>caInletRH</td><td>0.5</td><td>[1]</td></tr>
<tr><td>Real</td><td>T_degC</td><td>60</td><td>&nbsp;</td></tr>
<tr><td>Real</td><td>p_kPag</td><td>48.3</td><td>&nbsp;</td></tr>
<TR bgcolor="#e0e0e0"><TD colspan=4>Geometry</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Length</a></td><td>L_y[:]</td><td>{U.m}</td><td>Lengths along the channel [l]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Length</a></td><td>L_z[:]</td><td>{5*U.mm}</td><td>Lengths across the channel [l]</td></tr>
</table>
<p>

<h3>Connectors</h3>

<p>
<table border=1 cellspacing=0 cellpadding=2>
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td>output <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutput">RealOutput</a></td><td>w_V</td><td>&nbsp;</td></tr>
<tr><td>input <a href="FCSys_Connectors.html#FCSys.Connectors.RealInput">RealInput</a></td><td>zJ_Apercm2_small</td><td>&nbsp;</td></tr>
</table>
<p>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> FPToFPLinearize <font color="darkgreen">&quot;Test one flow plate to the other&quot;</font>

  <font color="blue">extends </font><a href="FCSys_Icons_Blocks.html#FCSys.Icons.Blocks.Continuous">FCSys.Icons.Blocks.Continuous</a>;

  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutput">Connectors.RealOutput</a> w_V=w[1, 1]/U.V;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealInput">Connectors.RealInput</a> zJ_Apercm2_small;

  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> n_O2=0.21;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> anStoich=1.5 <font color="darkgreen">&quot;Anode stoichiometric ratio&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> caStoich=2.0 <font color="darkgreen">&quot;Cathode stoichiometric ratio&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> anInletRH=0.8;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> caInletRH=0.5;
  <font color="blue">parameter </font>Real T_degC=60;
  <font color="blue">parameter </font>Real p_kPag=48.3;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.TemperatureAbsolute">Q.TemperatureAbsolute</a> T=<font color="red">U.from_degC</font>(T_degC);
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p=<font color="red">U.from_kPag</font>(p_kPag);
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p_H2O_an_in=anInletRH*<font color="red">
      Modelica.Media.Air.MoistAir.saturationPressureLiquid</font>(T/U.K)*U.Pa <font color="darkgreen">
    &quot;Pressure of H2O vapor&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p_H2O_ca_in=caInletRH*<font color="red">
      Modelica.Media.Air.MoistAir.saturationPressureLiquid</font>(T/U.K)*U.Pa <font color="darkgreen">
    &quot;Pressure of H2O vapor&quot;</font>;

  <a href="FCSys_Quantities.html#FCSys.Quantities.Potential">Q.Potential</a> w[n_y, n_z]=(anBC.graphite.'e-'.face.mPhidot[1] ./ anBC.graphite.
      'e-'.face.rho - caBC.graphite.'e-'.face.mPhidot[1] ./ caBC.graphite.'e-'.face.rho)
      /PEM.A[Axis.x] <font color="darkgreen">&quot;Potential&quot;</font>;
  <a href="FCSys_Quantities.html#FCSys.Quantities.CurrentAreic">Q.CurrentAreic</a> zJ[n_y, n_z]=-anBC.graphite.'e-'.face.phi[1] .* anBC.graphite.
      'e-'.face.rho <font color="darkgreen">&quot;Current density&quot;</font>;
  <a href="FCSys_Quantities.html#FCSys.Quantities.Number">Q.Number</a> zJ_Apercm2[n_y, n_z]=zJ*U.cm^2/U.A <font color="darkgreen">
    &quot;Electrical current density, in A/cm2&quot;</font>;
  <a href="FCSys_Quantities.html#FCSys.Quantities.Current">Q.Current</a> zI=<font color="red">sum</font>(zJ .* <font color="red">outerProduct</font>(L_y, L_z)) <font color="darkgreen">&quot;Total electrical current&quot;</font>;

  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Q.Length</a> L_y[:]={U.m} <font color="darkgreen">&quot;Lengths along the channel&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Q.Length</a> L_z[:]={5*U.mm} <font color="darkgreen">&quot;Lengths across the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Integer n_y=<font color="red">size</font>(L_y, 1) <font color="darkgreen">
    &quot;Number of regions along the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Integer n_z=<font color="red">size</font>(L_z, 1) <font color="darkgreen">
    &quot;Number of regions across the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_an_seg[anFP.n_x, n_z]=<font color="red">outerProduct</font>(anFP.L_x, L_z) <font color="darkgreen">
    &quot;Areas of the segments over the xz plane of the anode flow plate&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_ca_seg[caFP.n_x, n_z]=<font color="red">outerProduct</font>(caFP.L_x, L_z) <font color="darkgreen">
    &quot;Areas of the segments over the xz plane of the cathode flow plate&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_an=<font color="red">sum</font>(anFP.L_x)*<font color="red">sum</font>(L_z) <font color="darkgreen">
    &quot;Total cross-sectional area of the anode flow plate in the xz plane&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_ca=<font color="red">sum</font>(caFP.L_x)*<font color="red">sum</font>(L_z) <font color="darkgreen">
    &quot;Total cross-sectional area of the cathode flow plate in the xz plane&quot;</font>;

  <a href="FCSys_Regions_AnFPs.html#FCSys.Regions.AnFPs.AnFP">AnFPs.AnFP</a> anFP(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(gas(H2O(T_IC=T)), graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_AnGDLs.html#FCSys.Regions.AnGDLs.AnGDL">AnGDLs.AnGDL</a> anGDL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(gas(H2O(T_IC=T)), graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_AnCLs.html#FCSys.Regions.AnCLs.AnCL">AnCLs.AnCL</a> anCL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(
      ionomer(&#39;SO3-&#39;(T_IC=T)),
      gas(H2O(T_IC=T)),
      graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_PEMs.html#FCSys.Regions.PEMs.PEM">PEMs.PEM</a> PEM(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(ionomer(&#39;H+&#39;(initTransX=InitTranslational.none), &#39;SO3-&#39;(T_IC=T))));

  <a href="FCSys_Regions_CaCLs.html#FCSys.Regions.CaCLs.CaCL">CaCLs.CaCL</a> caCL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(
      ionomer(&#39;SO3-&#39;(T_IC=T)),
      gas(H2O(T_IC=T)),
      graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_CaGDLs.html#FCSys.Regions.CaGDLs.CaGDL">CaGDLs.CaGDL</a> caGDL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(gas(H2O(T_IC=T)), graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_CaFPs.html#FCSys.Regions.CaFPs.CaFP">CaFPs.CaFP</a> caFP(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(gas(H2O(T_IC=T)), graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> anBC[n_y, n_z](<font color="blue">each </font>
      graphite(
      &#39;inclC+&#39;=true,
      &#39;incle-&#39;=true,
      &#39;C+&#39;(<font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,
          thermalSet(y=T)),
      &#39;e-&#39;(<font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,
          thermalSet(y=T))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> caBC[n_y, n_z](<font color="blue">each </font>
      graphite(
      &#39;inclC+&#39;=true,
      &#39;incle-&#39;=true,
      &#39;C+&#39;(<font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,
          thermalSet(y=T)),
      &#39;e-&#39;(
        <font color="blue">redeclare </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        normalSet(y=-(1 + currFilt.y)*U.A/U.cm^2),
        <font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,

        thermalSet(y=T))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusEfforts">Conditions.ByConnector.FaceBus.Single.FaceBusEfforts</a> anSource[anFP.n_x, n_z](
      gas(
      <font color="blue">each </font>inclH2=true,
      <font color="blue">each </font>inclH2O=true,
      H2(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(anSource.gas.H2.normalOut.y - <font color="red">fill</font>(
              zI*anStoich/(2*A_an),
              anFP.n_x,
              n_z)) .* A_an_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T)),
      H2O(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(anSource.gas.H2O.normalOut.y - <font color="red">fill</font>(
              zI*anStoich*p_H2O_an_in/(2*(environment.p - environment.p_H2O)*
                A_an),
              anFP.n_x,
              n_z)) .* A_an_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> anSink[anFP.n_x, n_z](gas(
      <font color="blue">each </font>inclH2=true,
      <font color="blue">each </font>inclH2O=true,
      H2(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_an_out_noneq*A_an_seg .* anSink.gas.H2.face.rho ./ (
              anSink.gas.H2.face.rho + anSink.gas.H2O.face.rho))),
      H2O(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_an_out_noneq*A_an_seg .* anSink.gas.H2O.face.rho ./ (
              anSink.gas.H2.face.rho + anSink.gas.H2O.face.rho)))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusEfforts">Conditions.ByConnector.FaceBus.Single.FaceBusEfforts</a> caSource[caFP.n_x, n_z](
      gas(
      <font color="blue">each </font>inclH2O=true,
      <font color="blue">each </font>inclN2=true,
      <font color="blue">each </font>inclO2=true,
      H2O(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(caSource.gas.H2O.normalOut.y - <font color="red">fill</font>(
              zI*caStoich*p_H2O_ca_in/(4*p*n_O2*A_ca),
              caFP.n_x,
              n_z)) .* A_ca_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T)),
      N2(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(caSource.gas.N2.normalOut.y - <font color="red">fill</font>(
              zI*caStoich*(p - p*n_O2 - p_H2O_ca_in)/(4*p*n_O2*A_ca),
              caFP.n_x,
              n_z)) .* A_ca_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T)),
      O2(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(caSource.gas.O2.normalOut.y - <font color="red">fill</font>(
              zI*caStoich/(4*A_ca),
              caFP.n_x,
              n_z)) .* A_ca_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.force</a>,

        <font color="blue">each </font>thermalSet(y=T))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> caSink[caFP.n_x, n_z](gas(
      <font color="blue">each </font>inclH2O=true,
      <font color="blue">each </font>inclN2=true,
      <font color="blue">each </font>inclO2=true,
      H2O(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_ca_out_noneq*A_ca_seg .* caSink.gas.H2O.face.rho ./ (
              caSink.gas.H2O.face.rho + caSink.gas.N2.face.rho + caSink.gas.O2.face.rho))),

      N2(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_ca_out_noneq*A_ca_seg .* caSink.gas.N2.face.rho ./ (
              caSink.gas.H2O.face.rho + caSink.gas.N2.face.rho + caSink.gas.O2.face.rho))),

      O2(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_ca_out_noneq*A_ca_seg .* caSink.gas.O2.face.rho ./ (
              caSink.gas.H2O.face.rho + caSink.gas.N2.face.rho + caSink.gas.O2.face.rho)))));

<font color="blue">inner </font><a href="FCSys_Conditions.html#FCSys.Conditions.Environment">Conditions.Environment</a> environment(analysis=true) <font color="darkgreen">
    &quot;Environmental conditions&quot;</font>;

  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> anPressSet(y(unit=&quot;m/(l.T2)&quot;) =
      environment.p) <font color="darkgreen">&quot;Setpoint for the total anode outlet pressure&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> caPressSet(y(unit=&quot;m/(l.T2)&quot;) =
      environment.p) <font color="darkgreen">&quot;Setpoint for the total cathode outlet pressure&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> anThermoPress(y(unit=&quot;m/(l.T2)&quot;) = <font color="red">sum</font>
      ((anSink.gas.H2.materialOut.y + anSink.gas.H2O.materialOut.y) .* <font color="red">
      outerProduct</font>(anFP.L_x, L_z))/A_an) <font color="darkgreen">
    &quot;Thermodynamic pressure at the anode outlet&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> caThermoPress(y(unit=&quot;m/(l.T2)&quot;) = <font color="red">sum</font>
      ((caSink.gas.H2O.materialOut.y + caSink.gas.N2.materialOut.y + caSink.gas.O2.materialOut.y)
       .* A_ca_seg)/A_ca) <font color="darkgreen">&quot;Thermodynamic pressure at the cathode outlet&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Math.html#Modelica.Blocks.Math.Feedback">Modelica.Blocks.Math.Feedback</a> anNoneqSet;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Math.html#Modelica.Blocks.Math.Feedback">Modelica.Blocks.Math.Feedback</a> caNoneqSet;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Continuous.html#Modelica.Blocks.Continuous.FirstOrder">Modelica.Blocks.Continuous.FirstOrder</a> anValveDynamics(initType=Modelica.Blocks.Types.Init.InitialOutput,
      T=2) <font color="darkgreen">&quot;Dynamics of the anode exit valve&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Continuous.html#Modelica.Blocks.Continuous.FirstOrder">Modelica.Blocks.Continuous.FirstOrder</a> caValveDynamics(initType=Modelica.Blocks.Types.Init.InitialOutput,
      T=2) <font color="darkgreen">&quot;Dynamics of the cathode exit valve&quot;</font>;
<font color="blue">protected </font>
  <a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p_an_out_noneq <font color="darkgreen">
    &quot;Nonequilibrium pressure at the anode outlet&quot;</font>;
  <a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p_ca_out_noneq <font color="darkgreen">
    &quot;Nonequilibrium pressure at the cathode outlet&quot;</font>;
<font color="blue">public </font>
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Continuous.html#Modelica.Blocks.Continuous.FirstOrder">Modelica.Blocks.Continuous.FirstOrder</a> currFilt(initType=Modelica.Blocks.Types.Init.InitialOutput,
      T=1e-6);
<font color="blue">equation </font>
  <font color="red">connect</font>(anFP.xPositive, anGDL.xNegative);
  <font color="red">connect</font>(anGDL.xPositive, anCL.xNegative);

  <font color="red">connect</font>(anCL.xPositive, PEM.xNegative);

  <font color="red">connect</font>(PEM.xPositive, caCL.xNegative);

  <font color="red">connect</font>(caCL.xPositive, caGDL.xNegative);

  <font color="red">connect</font>(caGDL.xPositive, caFP.xNegative);

  <font color="red">connect</font>(anSource.face, anFP.yNegative);
  <font color="red">connect</font>(anSink.face, anFP.yPositive);
  <font color="red">connect</font>(caSource.face, caFP.yNegative);
  <font color="red">connect</font>(caSink.face, caFP.yPositive);
  <font color="red">connect</font>(anBC.face, anFP.xNegative);

  <font color="red">connect</font>(caFP.xPositive, caBC.face);

  anValveDynamics.y = p_an_out_noneq;
  caValveDynamics.y = p_ca_out_noneq;
  <font color="red">connect</font>(caPressSet.y, caNoneqSet.u1);
  <font color="red">connect</font>(caThermoPress.y, caNoneqSet.u2);
  <font color="red">connect</font>(caNoneqSet.y, caValveDynamics.u);
  <font color="red">connect</font>(anPressSet.y, anNoneqSet.u1);
  <font color="red">connect</font>(anNoneqSet.u2, anThermoPress.y);
  <font color="red">connect</font>(anNoneqSet.y, anValveDynamics.u);
  <font color="red">connect</font>(zJ_Apercm2_small, currFilt.u);

<font color="blue">end </font>FPToFPLinearize;
</pre>
<hr>

<h2><img src="images/FCSys.Regions.Examples.FPToFPSineI.png" alt="FCSys.Regions.Examples.FPToFPSine" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Regions.Examples.FPToFPSine"></a><a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples">FCSys.Regions.Examples</a>.FPToFPSine</h2>
<b>Test one flow plate to the other</b><p>
<img src="images/FCSys.Regions.Examples.FPToFPSineD.png" alt="FCSys.Regions.Examples.FPToFPSine">

<h3>Information</h3>

Extends from <a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a> (Icon for runnable examples).
<p>

<h3>Parameters</h3>

<p>
<table border=1 cellspacing=0 cellpadding=2>
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>n_O2</td><td>0.21</td><td>[1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>anStoich</td><td>1.5</td><td>Anode stoichiometric ratio [1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>caStoich</td><td>2.0</td><td>Cathode stoichiometric ratio [1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>anInletRH</td><td>0.8</td><td>[1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>caInletRH</td><td>0.5</td><td>[1]</td></tr>
<tr><td>Real</td><td>T_degC</td><td>60</td><td>&nbsp;</td></tr>
<tr><td>Real</td><td>p_kPag</td><td>48.3</td><td>&nbsp;</td></tr>
<TR bgcolor="#e0e0e0"><TD colspan=4>Geometry</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Length</a></td><td>L_y[:]</td><td>{U.m}</td><td>Lengths along the channel [l]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Length</a></td><td>L_z[:]</td><td>{5*U.mm}</td><td>Lengths across the channel [l]</td></tr>
</table>
<p>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> FPToFPSine <font color="darkgreen">&quot;Test one flow plate to the other&quot;</font>

  <font color="blue">extends </font><a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a>;

  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> n_O2=0.21;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> anStoich=1.5 <font color="darkgreen">&quot;Anode stoichiometric ratio&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> caStoich=2.0 <font color="darkgreen">&quot;Cathode stoichiometric ratio&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> anInletRH=0.8;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> caInletRH=0.5;
  <font color="blue">parameter </font>Real T_degC=60;
  <font color="blue">parameter </font>Real p_kPag=48.3;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.TemperatureAbsolute">Q.TemperatureAbsolute</a> T=<font color="red">U.from_degC</font>(T_degC);
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p=<font color="red">U.from_kPag</font>(p_kPag);
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p_H2O_an_in=anInletRH*<font color="red">
      Modelica.Media.Air.MoistAir.saturationPressureLiquid</font>(T/U.K)*U.Pa <font color="darkgreen">
    &quot;Pressure of H2O vapor&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p_H2O_ca_in=caInletRH*<font color="red">
      Modelica.Media.Air.MoistAir.saturationPressureLiquid</font>(T/U.K)*U.Pa <font color="darkgreen">
    &quot;Pressure of H2O vapor&quot;</font>;

  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Potential">Q.Potential</a> w[n_y, n_z]=caBC.graphite.'e-'.face.mPhidot[1] ./ (caBC.graphite.
      'e-'.face.rho*PEM.A[Axis.x]) - anBC.graphite.'e-'.face.mPhidot[1] ./ (
      anBC.graphite.'e-'.face.rho*PEM.A[Axis.x]) <font color="darkgreen">&quot;Potential&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.CurrentAreic">Q.CurrentAreic</a> zJ[n_y, n_z]=-anBC.graphite.'e-'.face.phi[1] .* anBC.graphite.
      'e-'.face.rho <font color="darkgreen">&quot;Current density&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Number">Q.Number</a> zJ_Apercm2[n_y, n_z]=zJ*U.cm^2/U.A <font color="darkgreen">
    &quot;Electrical current density, in A/cm2&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Current">Q.Current</a> zI=<font color="red">sum</font>(zJ .* <font color="red">outerProduct</font>(L_y, L_z)) <font color="darkgreen">
    &quot;Total electrical current&quot;</font>;

  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Q.Length</a> L_y[:]={U.m} <font color="darkgreen">&quot;Lengths along the channel&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Q.Length</a> L_z[:]={5*U.mm} <font color="darkgreen">&quot;Lengths across the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Integer n_y=<font color="red">size</font>(L_y, 1) <font color="darkgreen">
    &quot;Number of regions along the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Integer n_z=<font color="red">size</font>(L_z, 1) <font color="darkgreen">
    &quot;Number of regions across the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_an_seg[anFP.n_x, n_z]=<font color="red">outerProduct</font>(anFP.L_x, L_z) <font color="darkgreen">
    &quot;Areas of the segments over the xz plane of the anode flow plate&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_ca_seg[caFP.n_x, n_z]=<font color="red">outerProduct</font>(caFP.L_x, L_z) <font color="darkgreen">
    &quot;Areas of the segments over the xz plane of the cathode flow plate&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_an=<font color="red">sum</font>(anFP.L_x)*<font color="red">sum</font>(L_z) <font color="darkgreen">
    &quot;Total cross-sectional area of the anode flow plate in the xz plane&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_ca=<font color="red">sum</font>(caFP.L_x)*<font color="red">sum</font>(L_z) <font color="darkgreen">
    &quot;Total cross-sectional area of the cathode flow plate in the xz plane&quot;</font>;

  <a href="FCSys_Regions_AnFPs.html#FCSys.Regions.AnFPs.AnFP">AnFPs.AnFP</a> anFP(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(gas(H2O(T_IC=T)), graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_AnGDLs.html#FCSys.Regions.AnGDLs.AnGDL">AnGDLs.AnGDL</a> anGDL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(gas(H2O(T_IC=T)), graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_AnCLs.html#FCSys.Regions.AnCLs.AnCL">AnCLs.AnCL</a> anCL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(
      ionomer(&#39;SO3-&#39;(T_IC=T)),
      gas(H2O(T_IC=T)),
      graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_PEMs.html#FCSys.Regions.PEMs.PEM">PEMs.PEM</a> PEM(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(ionomer(&#39;H+&#39;(initTransX=InitTranslational.none), &#39;SO3-&#39;(T_IC=T))));

  <a href="FCSys_Regions_CaCLs.html#FCSys.Regions.CaCLs.CaCL">CaCLs.CaCL</a> caCL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(
      ionomer(&#39;SO3-&#39;(T_IC=T)),
      gas(H2O(T_IC=T)),
      graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_CaGDLs.html#FCSys.Regions.CaGDLs.CaGDL">CaGDLs.CaGDL</a> caGDL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(gas(H2O(T_IC=T)), graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_CaFPs.html#FCSys.Regions.CaFPs.CaFP">CaFPs.CaFP</a> caFP(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(gas(H2O(T_IC=T)), graphite(&#39;C+&#39;(T_IC=T))));

  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.Ramp">Modelica.Blocks.Sources.Ramp</a> A(
    height=-U.A/U.cm^2,
    duration=100.1,
    startTime=0.1);
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.Sine">Modelica.Blocks.Sources.Sine</a> B(
    amplitude=0.1*U.A/U.cm^2,
    freqHz=0.1,
    startTime=110);
  Real yset=A.y + B.y;

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> anBC[n_y, n_z](<font color="blue">each </font>
      graphite(
      &#39;inclC+&#39;=true,
      &#39;incle-&#39;=true,
      &#39;C+&#39;(<font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,
          thermalSet(y=T)),
      &#39;e-&#39;(
        <font color="blue">redeclare </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        normalSet(y=yset),
        <font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,

        thermalSet(y=T))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> caBC[n_y, n_z](<font color="blue">each </font>
      graphite(
      &#39;inclC+&#39;=true,
      &#39;incle-&#39;=true,
      &#39;C+&#39;(<font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,
          thermalSet(y=T)),
      &#39;e-&#39;(<font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,
          thermalSet(y=T))));
  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusEfforts">Conditions.ByConnector.FaceBus.Single.FaceBusEfforts</a> anSource[anFP.n_x, n_z](
      gas(
      <font color="blue">each </font>inclH2=true,
      <font color="blue">each </font>inclH2O=true,
      H2(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(anSource.gas.H2.normalOut.y - <font color="red">fill</font>(
              zI*anStoich/(2*A_an),
              anFP.n_x,
              n_z)) .* A_an_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T)),
      H2O(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(anSource.gas.H2O.normalOut.y - <font color="red">fill</font>(
              zI*anStoich*p_H2O_an_in/(2*(environment.p - environment.p_H2O)*
                A_an),
              anFP.n_x,
              n_z)) .* A_an_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T))), <font color="blue">each </font>liquid(inclH2O=anFP.subregions[1, 1, 1].liquid.inclH2O));

<a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> anSink[anFP.n_x, n_z](gas(
      <font color="blue">each </font>inclH2=true,
      <font color="blue">each </font>inclH2O=true,
      H2(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_an_out_noneq*A_an_seg .* anSink.gas.H2.face.rho ./ (
              anSink.gas.H2.face.rho + anSink.gas.H2O.face.rho))),
      H2O(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_an_out_noneq*A_an_seg .* anSink.gas.H2O.face.rho ./ (
              anSink.gas.H2.face.rho + anSink.gas.H2O.face.rho)))), <font color="blue">each </font>liquid(
        inclH2O=anFP.subregions[1, 1, 1].liquid.inclH2O));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusEfforts">Conditions.ByConnector.FaceBus.Single.FaceBusEfforts</a> caSource[caFP.n_x, n_z](
      gas(
      <font color="blue">each </font>inclH2O=true,
      <font color="blue">each </font>inclN2=true,
      <font color="blue">each </font>inclO2=true,
      H2O(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(caSource.gas.H2O.normalOut.y - <font color="red">fill</font>(
              zI*caStoich*p_H2O_ca_in/(4*p*n_O2*A_ca),
              caFP.n_x,
              n_z)) .* A_ca_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T)),
      N2(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(caSource.gas.N2.normalOut.y - <font color="red">fill</font>(
              zI*caStoich*(p - p*n_O2 - p_H2O_ca_in)/(4*p*n_O2*A_ca),
              caFP.n_x,
              n_z)) .* A_ca_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T)),
      O2(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(caSource.gas.O2.normalOut.y - <font color="red">fill</font>(
              zI*caStoich/(4*A_ca),
              caFP.n_x,
              n_z)) .* A_ca_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.force</a>,

        <font color="blue">each </font>thermalSet(y=T))), <font color="blue">each </font>liquid(inclH2O=caFP.subregions[1, 1, 1].liquid.inclH2O));

<a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> caSink[caFP.n_x, n_z](gas(
      <font color="blue">each </font>inclH2O=true,
      <font color="blue">each </font>inclN2=true,
      <font color="blue">each </font>inclO2=true,
      H2O(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_ca_out_noneq*A_ca_seg .* caSink.gas.H2O.face.rho ./ (
              caSink.gas.H2O.face.rho + caSink.gas.N2.face.rho + caSink.gas.O2.face.rho))),

      N2(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_ca_out_noneq*A_ca_seg .* caSink.gas.N2.face.rho ./ (
              caSink.gas.H2O.face.rho + caSink.gas.N2.face.rho + caSink.gas.O2.face.rho))),

      O2(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_ca_out_noneq*A_ca_seg .* caSink.gas.O2.face.rho ./ (
              caSink.gas.H2O.face.rho + caSink.gas.N2.face.rho + caSink.gas.O2.face.rho)))),
      <font color="blue">each </font>liquid(inclH2O=caFP.subregions[1, 1, 1].liquid.inclH2O));

  <font color="blue">inner </font><a href="FCSys_Conditions.html#FCSys.Conditions.Environment">Conditions.Environment</a> environment(analysis=true) <font color="darkgreen">
    &quot;Environmental conditions&quot;</font>;

  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> anPressSet(y(unit=&quot;m/(l.T2)&quot;) =
      environment.p) <font color="darkgreen">&quot;Setpoint for the total anode outlet pressure&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> caPressSet(y(unit=&quot;m/(l.T2)&quot;) =
      environment.p) <font color="darkgreen">&quot;Setpoint for the total cathode outlet pressure&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> anThermoPress(y(unit=&quot;m/(l.T2)&quot;) = <font color="red">sum</font>
      ((anSink.gas.H2.materialOut.y + anSink.gas.H2O.materialOut.y) .* <font color="red">
      outerProduct</font>(anFP.L_x, L_z))/A_an) <font color="darkgreen">
    &quot;Thermodynamic pressure at the anode outlet&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> caThermoPress(y(unit=&quot;m/(l.T2)&quot;) = <font color="red">sum</font>
      ((caSink.gas.H2O.materialOut.y + caSink.gas.N2.materialOut.y + caSink.gas.O2.materialOut.y)
       .* A_ca_seg)/A_ca) <font color="darkgreen">&quot;Thermodynamic pressure at the cathode outlet&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Math.html#Modelica.Blocks.Math.Feedback">Modelica.Blocks.Math.Feedback</a> anNoneqSet;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Math.html#Modelica.Blocks.Math.Feedback">Modelica.Blocks.Math.Feedback</a> caNoneqSet;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Continuous.html#Modelica.Blocks.Continuous.FirstOrder">Modelica.Blocks.Continuous.FirstOrder</a> anValveDynamics(initType=Modelica.Blocks.Types.Init.InitialOutput,
      T=2) <font color="darkgreen">&quot;Dynamics of the anode exit valve&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Continuous.html#Modelica.Blocks.Continuous.FirstOrder">Modelica.Blocks.Continuous.FirstOrder</a> caValveDynamics(initType=Modelica.Blocks.Types.Init.InitialOutput,
      T=2) <font color="darkgreen">&quot;Dynamics of the cathode exit valve&quot;</font>;
<font color="blue">protected </font>
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> p_an_out_noneq(unit=&quot;m/(l.T2)&quot;) <font color="darkgreen">
    &quot;Nonequilibrium pressure at the anode outlet&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> p_ca_out_noneq(unit=&quot;m/(l.T2)&quot;) <font color="darkgreen">
    &quot;Nonequilibrium pressure at the cathode outlet&quot;</font>;
<font color="blue">equation </font>
  <font color="red">connect</font>(anFP.xPositive, anGDL.xNegative);
  <font color="red">connect</font>(anGDL.xPositive, anCL.xNegative);

  <font color="red">connect</font>(anCL.xPositive, PEM.xNegative);

  <font color="red">connect</font>(PEM.xPositive, caCL.xNegative);

  <font color="red">connect</font>(caCL.xPositive, caGDL.xNegative);

  <font color="red">connect</font>(caGDL.xPositive, caFP.xNegative);

  <font color="red">connect</font>(anSource.face, anFP.yNegative);
  <font color="red">connect</font>(anSink.face, anFP.yPositive);
  <font color="red">connect</font>(caSource.face, caFP.yNegative);
  <font color="red">connect</font>(caSink.face, caFP.yPositive);
  <font color="red">connect</font>(anBC.face, anFP.xNegative);

  <font color="red">connect</font>(caFP.xPositive, caBC.face);

  <font color="red">connect</font>(anValveDynamics.y, p_an_out_noneq);
  <font color="red">connect</font>(caValveDynamics.y, p_ca_out_noneq);
  <font color="red">connect</font>(caPressSet.y, caNoneqSet.u1);
  <font color="red">connect</font>(caThermoPress.y, caNoneqSet.u2);
  <font color="red">connect</font>(caNoneqSet.y, caValveDynamics.u);
  <font color="red">connect</font>(anPressSet.y, anNoneqSet.u1);
  <font color="red">connect</font>(anNoneqSet.u2, anThermoPress.y);
  <font color="red">connect</font>(anNoneqSet.y, anValveDynamics.u);
<font color="blue">end </font>FPToFPSine;
</pre>
<hr>

<h2><img src="images/FCSys.Regions.Examples.FPToFPSineI.png" alt="FCSys.Regions.Examples.FPToFPPulse" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Regions.Examples.FPToFPPulse"></a><a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples">FCSys.Regions.Examples</a>.FPToFPPulse</h2>
<b>Test one flow plate to the other</b><p>
<img src="images/FCSys.Regions.Examples.FPToFPPulseD.png" alt="FCSys.Regions.Examples.FPToFPPulse">

<h3>Information</h3>

Extends from <a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a> (Icon for runnable examples).
<p>

<h3>Parameters</h3>

<p>
<table border=1 cellspacing=0 cellpadding=2>
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>n_O2</td><td>0.21</td><td>[1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>anStoich</td><td>1.5</td><td>Anode stoichiometric ratio [1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>caStoich</td><td>2.0</td><td>Cathode stoichiometric ratio [1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>anInletRH</td><td>0.8</td><td>[1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>caInletRH</td><td>0.5</td><td>[1]</td></tr>
<tr><td>Real</td><td>T_degC</td><td>60</td><td>&nbsp;</td></tr>
<tr><td>Real</td><td>p_kPag</td><td>48.3</td><td>&nbsp;</td></tr>
<TR bgcolor="#e0e0e0"><TD colspan=4>Geometry</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Length</a></td><td>L_y[:]</td><td>{U.m}</td><td>Lengths along the channel [l]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Length</a></td><td>L_z[:]</td><td>{5*U.mm}</td><td>Lengths across the channel [l]</td></tr>
</table>
<p>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> FPToFPPulse <font color="darkgreen">&quot;Test one flow plate to the other&quot;</font>

  <font color="blue">extends </font><a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> n_O2=0.21;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> anStoich=1.5 <font color="darkgreen">&quot;Anode stoichiometric ratio&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> caStoich=2.0 <font color="darkgreen">&quot;Cathode stoichiometric ratio&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> anInletRH=0.8;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> caInletRH=0.5;
  <font color="blue">parameter </font>Real T_degC=60;
  <font color="blue">parameter </font>Real p_kPag=48.3;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.TemperatureAbsolute">Q.TemperatureAbsolute</a> T=<font color="red">U.from_degC</font>(T_degC);
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p=<font color="red">U.from_kPag</font>(p_kPag);
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p_H2O_an_in=anInletRH*<font color="red">
      Modelica.Media.Air.MoistAir.saturationPressureLiquid</font>(T/U.K)*U.Pa <font color="darkgreen">
    &quot;Pressure of H2O vapor&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p_H2O_ca_in=caInletRH*<font color="red">
      Modelica.Media.Air.MoistAir.saturationPressureLiquid</font>(T/U.K)*U.Pa <font color="darkgreen">
    &quot;Pressure of H2O vapor&quot;</font>;

  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Potential">Q.Potential</a> w[n_y, n_z]=(anBC.graphite.'e-'.face.mPhidot[1] ./ anBC.graphite.
      'e-'.face.rho - caBC.graphite.'e-'.face.mPhidot[1] ./ caBC.graphite.'e-'.face.rho)
      /PEM.A[Axis.x] <font color="darkgreen">&quot;Potential&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.CurrentAreic">Q.CurrentAreic</a> zJ[n_y, n_z]=-anBC.graphite.'e-'.face.phi[1] .* anBC.graphite.
      'e-'.face.rho <font color="darkgreen">&quot;Current density&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Number">Q.Number</a> zJ_Apercm2[n_y, n_z]=zJ*U.cm^2/U.A <font color="darkgreen">
    &quot;Electrical current density, in A/cm2&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Current">Q.Current</a> zI=<font color="red">sum</font>(zJ .* <font color="red">outerProduct</font>(L_y, L_z)) <font color="darkgreen">
    &quot;Total electrical current&quot;</font>;

  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Q.Length</a> L_y[:]={U.m} <font color="darkgreen">&quot;Lengths along the channel&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Q.Length</a> L_z[:]={5*U.mm} <font color="darkgreen">&quot;Lengths across the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Integer n_y=<font color="red">size</font>(L_y, 1) <font color="darkgreen">
    &quot;Number of regions along the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Integer n_z=<font color="red">size</font>(L_z, 1) <font color="darkgreen">
    &quot;Number of regions across the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_an_seg[anFP.n_x, n_z]=<font color="red">outerProduct</font>(anFP.L_x, L_z) <font color="darkgreen">
    &quot;Areas of the segments over the xz plane of the anode flow plate&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_ca_seg[caFP.n_x, n_z]=<font color="red">outerProduct</font>(caFP.L_x, L_z) <font color="darkgreen">
    &quot;Areas of the segments over the xz plane of the cathode flow plate&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_an=<font color="red">sum</font>(anFP.L_x)*<font color="red">sum</font>(L_z) <font color="darkgreen">
    &quot;Total cross-sectional area of the anode flow plate in the xz plane&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_ca=<font color="red">sum</font>(caFP.L_x)*<font color="red">sum</font>(L_z) <font color="darkgreen">
    &quot;Total cross-sectional area of the cathode flow plate in the xz plane&quot;</font>;

  <a href="FCSys_Regions_AnFPs.html#FCSys.Regions.AnFPs.AnFP">AnFPs.AnFP</a> anFP(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(gas(H2O(T_IC=T)), graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_AnGDLs.html#FCSys.Regions.AnGDLs.AnGDL">AnGDLs.AnGDL</a> anGDL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(gas(H2O(T_IC=T)), graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_AnCLs.html#FCSys.Regions.AnCLs.AnCL">AnCLs.AnCL</a> anCL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(
      ionomer(&#39;SO3-&#39;(T_IC=T)),
      gas(H2O(T_IC=T)),
      graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_PEMs.html#FCSys.Regions.PEMs.PEM">PEMs.PEM</a> PEM(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(ionomer(&#39;H+&#39;(initTransX=InitTranslational.none), &#39;SO3-&#39;(T_IC=T))));

  <a href="FCSys_Regions_CaCLs.html#FCSys.Regions.CaCLs.CaCL">CaCLs.CaCL</a> caCL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(
      ionomer(&#39;SO3-&#39;(T_IC=T)),
      gas(H2O(T_IC=T)),
      graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_CaGDLs.html#FCSys.Regions.CaGDLs.CaGDL">CaGDLs.CaGDL</a> caGDL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(gas(H2O(T_IC=T)), graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_CaFPs.html#FCSys.Regions.CaFPs.CaFP">CaFPs.CaFP</a> caFP(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(gas(H2O(T_IC=T)), graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> anBC[n_y, n_z](<font color="blue">each </font>
      graphite(
      &#39;inclC+&#39;=true,
      &#39;incle-&#39;=true,
      &#39;C+&#39;(<font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,
          thermalSet(y=T)),
      &#39;e-&#39;(<font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,
          thermalSet(y=T))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> caBC[n_y, n_z](<font color="blue">each </font>
      graphite(
      &#39;inclC+&#39;=true,
      &#39;incle-&#39;=true,
      &#39;C+&#39;(<font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,
          thermalSet(y=T)),
      &#39;e-&#39;(
        <font color="blue">redeclare </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,

        thermalSet(y=T),
        normalSet(y=-firstOrder.y))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusEfforts">Conditions.ByConnector.FaceBus.Single.FaceBusEfforts</a> anSource[anFP.n_x, n_z](
      gas(
      <font color="blue">each </font>inclH2=true,
      <font color="blue">each </font>inclH2O=true,
      H2(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(anSource.gas.H2.normalOut.y - <font color="red">fill</font>(
              zI*anStoich/(2*A_an),
              anFP.n_x,
              n_z)) .* A_an_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T)),
      H2O(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(anSource.gas.H2O.normalOut.y - <font color="red">fill</font>(
              zI*anStoich*p_H2O_an_in/(2*(environment.p - environment.p_H2O)*
                A_an),
              anFP.n_x,
              n_z)) .* A_an_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> anSink[anFP.n_x, n_z](gas(
      <font color="blue">each </font>inclH2=true,
      <font color="blue">each </font>inclH2O=true,
      H2(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_an_out_noneq*A_an_seg .* anSink.gas.H2.face.rho ./ (
              anSink.gas.H2.face.rho + anSink.gas.H2O.face.rho))),
      H2O(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_an_out_noneq*A_an_seg .* anSink.gas.H2O.face.rho ./ (
              anSink.gas.H2.face.rho + anSink.gas.H2O.face.rho)))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusEfforts">Conditions.ByConnector.FaceBus.Single.FaceBusEfforts</a> caSource[caFP.n_x, n_z](
      gas(
      <font color="blue">each </font>inclH2O=true,
      <font color="blue">each </font>inclN2=true,
      <font color="blue">each </font>inclO2=true,
      H2O(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(caSource.gas.H2O.normalOut.y - <font color="red">fill</font>(
              zI*caStoich*p_H2O_ca_in/(4*p*n_O2*A_ca),
              caFP.n_x,
              n_z)) .* A_ca_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T)),
      N2(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(caSource.gas.N2.normalOut.y - <font color="red">fill</font>(
              zI*caStoich*(p - p*n_O2 - p_H2O_ca_in)/(4*p*n_O2*A_ca),
              caFP.n_x,
              n_z)) .* A_ca_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T)),
      O2(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(caSource.gas.O2.normalOut.y - <font color="red">fill</font>(
              zI*caStoich/(4*A_ca),
              caFP.n_x,
              n_z)) .* A_ca_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.force</a>,

        <font color="blue">each </font>thermalSet(y=T))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> caSink[caFP.n_x, n_z](gas(
      <font color="blue">each </font>inclH2O=true,
      <font color="blue">each </font>inclN2=true,
      <font color="blue">each </font>inclO2=true,
      H2O(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_ca_out_noneq*A_ca_seg .* caSink.gas.H2O.face.rho ./ (
              caSink.gas.H2O.face.rho + caSink.gas.N2.face.rho + caSink.gas.O2.face.rho))),

      N2(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_ca_out_noneq*A_ca_seg .* caSink.gas.N2.face.rho ./ (
              caSink.gas.H2O.face.rho + caSink.gas.N2.face.rho + caSink.gas.O2.face.rho))),

      O2(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_ca_out_noneq*A_ca_seg .* caSink.gas.O2.face.rho ./ (
              caSink.gas.H2O.face.rho + caSink.gas.N2.face.rho + caSink.gas.O2.face.rho)))));

<font color="blue">inner </font><a href="FCSys_Conditions.html#FCSys.Conditions.Environment">Conditions.Environment</a> environment(analysis=true) <font color="darkgreen">
    &quot;Environmental conditions&quot;</font>;

  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> anPressSet(y(unit=&quot;m/(l.T2)&quot;) =
      environment.p) <font color="darkgreen">&quot;Setpoint for the total anode outlet pressure&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> caPressSet(y(unit=&quot;m/(l.T2)&quot;) =
      environment.p) <font color="darkgreen">&quot;Setpoint for the total cathode outlet pressure&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> anThermoPress(y(unit=&quot;m/(l.T2)&quot;) = <font color="red">sum</font>
      ((anSink.gas.H2.materialOut.y + anSink.gas.H2O.materialOut.y) .* <font color="red">
      outerProduct</font>(anFP.L_x, L_z))/A_an) <font color="darkgreen">
    &quot;Thermodynamic pressure at the anode outlet&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> caThermoPress(y(unit=&quot;m/(l.T2)&quot;) = <font color="red">sum</font>
      ((caSink.gas.H2O.materialOut.y + caSink.gas.N2.materialOut.y + caSink.gas.O2.materialOut.y)
       .* A_ca_seg)/A_ca) <font color="darkgreen">&quot;Thermodynamic pressure at the cathode outlet&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Math.html#Modelica.Blocks.Math.Feedback">Modelica.Blocks.Math.Feedback</a> anNoneqSet;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Math.html#Modelica.Blocks.Math.Feedback">Modelica.Blocks.Math.Feedback</a> caNoneqSet;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Continuous.html#Modelica.Blocks.Continuous.FirstOrder">Modelica.Blocks.Continuous.FirstOrder</a> anValveDynamics(initType=Modelica.Blocks.Types.Init.InitialOutput,
      T=2) <font color="darkgreen">&quot;Dynamics of the anode exit valve&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Continuous.html#Modelica.Blocks.Continuous.FirstOrder">Modelica.Blocks.Continuous.FirstOrder</a> caValveDynamics(initType=Modelica.Blocks.Types.Init.InitialOutput,
      T=2) <font color="darkgreen">&quot;Dynamics of the cathode exit valve&quot;</font>;

<font color="blue">protected </font>
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> p_an_out_noneq(unit=&quot;m/(l.T2)&quot;) <font color="darkgreen">
    &quot;Nonequilibrium pressure at the anode outlet&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> p_ca_out_noneq(unit=&quot;m/(l.T2)&quot;) <font color="darkgreen">
    &quot;Nonequilibrium pressure at the cathode outlet&quot;</font>;
<font color="blue">public </font>
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.Pulse">Modelica.Blocks.Sources.Pulse</a> pulse(
    amplitude=0.8*U.A/U.cm^2,
    period=10,
    width=50);
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Continuous.html#Modelica.Blocks.Continuous.FirstOrder">Modelica.Blocks.Continuous.FirstOrder</a> firstOrder(k=0.001);
<font color="blue">equation </font>

  <font color="red">connect</font>(anFP.xPositive, anGDL.xNegative);
  <font color="red">connect</font>(anGDL.xPositive, anCL.xNegative);

  <font color="red">connect</font>(anCL.xPositive, PEM.xNegative);

  <font color="red">connect</font>(PEM.xPositive, caCL.xNegative);

  <font color="red">connect</font>(caCL.xPositive, caGDL.xNegative);

  <font color="red">connect</font>(caGDL.xPositive, caFP.xNegative);

  <font color="red">connect</font>(anSource.face, anFP.yNegative);
  <font color="red">connect</font>(anSink.face, anFP.yPositive);
  <font color="red">connect</font>(caSource.face, caFP.yNegative);
  <font color="red">connect</font>(caSink.face, caFP.yPositive);
  <font color="red">connect</font>(anBC.face, anFP.xNegative);

  <font color="red">connect</font>(caFP.xPositive, caBC.face);

  <font color="red">connect</font>(anValveDynamics.y, p_an_out_noneq);
  <font color="red">connect</font>(caValveDynamics.y, p_ca_out_noneq);
  <font color="red">connect</font>(caPressSet.y, caNoneqSet.u1);
  <font color="red">connect</font>(caThermoPress.y, caNoneqSet.u2);
  <font color="red">connect</font>(caNoneqSet.y, caValveDynamics.u);
  <font color="red">connect</font>(anPressSet.y, anNoneqSet.u1);
  <font color="red">connect</font>(anNoneqSet.u2, anThermoPress.y);
  <font color="red">connect</font>(anNoneqSet.y, anValveDynamics.u);
  <font color="red">connect</font>(pulse.y, firstOrder.u);
<font color="blue">end </font>FPToFPPulse;
</pre>
<hr>

<h2><a name="FCSys.Regions.Examples.Conn"></a><a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples">FCSys.Regions.Examples</a>.Conn</h2>

<p>

<h3>Contents</h3>

<p>
<table border=1 cellspacing=0 cellpadding=2>
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td>Real</td><td>Ndot_exch</td><td>Total exchange current</td></tr>
<tr><td>flow Real</td><td>Ndot</td><td>Current into this species</td></tr>
</table>
<p>

<h3>Modelica definition</h3>

<pre>
<font color="blue">connector</font> Conn

  Real Ndot_exch <font color="darkgreen">&quot;Total exchange current&quot;</font>;
  <font color="blue">flow </font>Real Ndot <font color="darkgreen">&quot;Current into this species&quot;</font>;

<font color="blue">end </font>Conn;
</pre>
<hr>

<h2><img src="images/FCSys.Regions.Examples.ModI.png" alt="FCSys.Regions.Examples.Mod" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Regions.Examples.Mod"></a><a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples">FCSys.Regions.Examples</a>.Mod</h2>
<img src="images/FCSys.Regions.Examples.ModD.png" alt="FCSys.Regions.Examples.Mod">
<p>

<h3>Parameters</h3>

<p>
<table border=1 cellspacing=0 cellpadding=2>
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td>Real</td><td>Ndot</td><td>-1</td><td>Incoming current due to this species</td></tr>
</table>
<p>

<h3>Connectors</h3>

<p>
<table border=1 cellspacing=0 cellpadding=2>
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples.Conn">Conn</a></td><td>conn</td><td>&nbsp;</td></tr>
</table>
<p>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> Mod

  <font color="blue">parameter </font>Real Ndot=-1 <font color="darkgreen">&quot;Incoming current due to this species&quot;</font>;
  Real Ndot_other <font color="darkgreen">&quot;Incoming current due to the other species&quot;</font>;

  <a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples.Conn">Conn</a> conn;

<font color="blue">equation </font>
  conn.Ndot_exch = Ndot - Ndot_other;
  conn.Ndot = Ndot + Ndot_other;

<font color="blue">end </font>Mod;
</pre>
<hr>

<h2><a name="FCSys.Regions.Examples.TestMod"></a><a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples">FCSys.Regions.Examples</a>.TestMod</h2>

<img src="images/FCSys.Regions.Examples.TestModD.png" alt="FCSys.Regions.Examples.TestMod">
<p>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> TestMod

  <a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples.Mod">Mod</a> mod;
  <a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples.Mod">Mod</a> mod1;
<font color="blue">equation </font>
  <font color="red">connect</font>(mod.conn, mod1.conn);
<font color="blue">end </font>TestMod;
</pre>
<hr>

<h2><img src="images/FCSys.Regions.Examples.FPToFPVoltageI.png" alt="FCSys.Regions.Examples.FPToFPVoltage" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Regions.Examples.FPToFPVoltage"></a><a href="FCSys_Regions_Examples.html#FCSys.Regions.Examples">FCSys.Regions.Examples</a>.FPToFPVoltage</h2>
<b>Test one flow plate to the other</b><p>
<img src="images/FCSys.Regions.Examples.FPToFPVoltageD.png" alt="FCSys.Regions.Examples.FPToFPVoltage">

<h3>Information</h3>

Extends from <a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a> (Icon for runnable examples).
<p>

<h3>Parameters</h3>

<p>
<table border=1 cellspacing=0 cellpadding=2>
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>n_O2</td><td>0.21</td><td>[1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>anStoich</td><td>1.5</td><td>Anode stoichiometric ratio [1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>caStoich</td><td>2.0</td><td>Cathode stoichiometric ratio [1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>anInletRH</td><td>0.8</td><td>[1]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">NumberAbsolute</a></td><td>caInletRH</td><td>0.5</td><td>[1]</td></tr>
<tr><td>Real</td><td>T_degC</td><td>60</td><td>&nbsp;</td></tr>
<tr><td>Real</td><td>p_kPag</td><td>48.3</td><td>&nbsp;</td></tr>
<TR bgcolor="#e0e0e0"><TD colspan=4>Geometry</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Length</a></td><td>L_y[:]</td><td>fill(U.m/1, 1)</td><td>Lengths along the channel [l]</td></tr>
<tr><td><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Length</a></td><td>L_z[:]</td><td>{5*U.mm}</td><td>Lengths across the channel [l]</td></tr>
</table>
<p>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> FPToFPVoltage <font color="darkgreen">&quot;Test one flow plate to the other&quot;</font>

  <font color="blue">extends </font><a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> n_O2=0.21;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> anStoich=1.5 <font color="darkgreen">&quot;Anode stoichiometric ratio&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> caStoich=2.0 <font color="darkgreen">&quot;Cathode stoichiometric ratio&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> anInletRH=0.8;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.NumberAbsolute">Q.NumberAbsolute</a> caInletRH=0.5;
  <font color="blue">parameter </font>Real T_degC=60;
  <font color="blue">parameter </font>Real p_kPag=48.3;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.TemperatureAbsolute">Q.TemperatureAbsolute</a> T=<font color="red">U.from_degC</font>(T_degC);
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p=<font color="red">U.from_kPag</font>(p_kPag);
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p_H2O_an_in=anInletRH*<font color="red">
      Modelica.Media.Air.MoistAir.saturationPressureLiquid</font>(T/U.K)*U.Pa <font color="darkgreen">
    &quot;Pressure of H2O vapor&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.PressureAbsolute">Q.PressureAbsolute</a> p_H2O_ca_in=caInletRH*<font color="red">
      Modelica.Media.Air.MoistAir.saturationPressureLiquid</font>(T/U.K)*U.Pa <font color="darkgreen">
    &quot;Pressure of H2O vapor&quot;</font>;

  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Potential">Q.Potential</a> w[n_y, n_z]=(anBC.graphite.'e-'.face.mPhidot[1] ./ anBC.graphite.
      'e-'.face.rho - caBC.graphite.'e-'.face.mPhidot[1] ./ caBC.graphite.'e-'.face.rho)
      /PEM.A[Axis.x] <font color="darkgreen">&quot;Potential&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.CurrentAreic">Q.CurrentAreic</a> zJ[n_y, n_z]=-anBC.graphite.'e-'.face.phi[1] .* anBC.graphite.
      'e-'.face.rho <font color="darkgreen">&quot;Current density&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Number">Q.Number</a> zJ_Apercm2[n_y, n_z]=zJ*U.cm^2/U.A <font color="darkgreen">
    &quot;Electrical current density, in A/cm2&quot;</font>;
  <font color="blue">output </font><a href="FCSys_Quantities.html#FCSys.Quantities.Current">Q.Current</a> zI=<font color="red">sum</font>(zJ .* <font color="red">outerProduct</font>(L_y, L_z)) <font color="darkgreen">
    &quot;Total electrical current&quot;</font>;
  <a href="FCSys_Quantities.html#FCSys.Quantities.Current">Q.Current</a> I_H2_an_in=zI*anStoich/2;
  <a href="FCSys_Quantities.html#FCSys.Quantities.Current">Q.Current</a> I_O2_ca_in=zI*caStoich/4;

  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Q.Length</a> L_y[:]=<font color="red">fill</font>(U.m/1, 1) <font color="darkgreen">&quot;Lengths along the channel&quot;</font>;
  <font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Length">Q.Length</a> L_z[:]={5*U.mm} <font color="darkgreen">&quot;Lengths across the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Integer n_y=<font color="red">size</font>(L_y, 1) <font color="darkgreen">
    &quot;Number of regions along the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font>Integer n_z=<font color="red">size</font>(L_z, 1) <font color="darkgreen">
    &quot;Number of regions across the channel&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_an_seg[anFP.n_x, n_z]=<font color="red">outerProduct</font>(anFP.L_x, L_z) <font color="darkgreen">
    &quot;Areas of the segments over the xz plane of the anode flow plate&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_ca_seg[caFP.n_x, n_z]=<font color="red">outerProduct</font>(caFP.L_x, L_z) <font color="darkgreen">
    &quot;Areas of the segments over the xz plane of the cathode flow plate&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_an=<font color="red">sum</font>(anFP.L_x)*<font color="red">sum</font>(L_z) <font color="darkgreen">
    &quot;Total cross-sectional area of the anode flow plate in the xz plane&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><a href="FCSys_Quantities.html#FCSys.Quantities.Area">Q.Area</a> A_ca=<font color="red">sum</font>(caFP.L_x)*<font color="red">sum</font>(L_z) <font color="darkgreen">
    &quot;Total cross-sectional area of the cathode flow plate in the xz plane&quot;</font>;

  <a href="FCSys_Regions_AnFPs.html#FCSys.Regions.AnFPs.AnFP">AnFPs.AnFP</a> anFP(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(
      gas(H2(p_IC=p - p_H2O_an_in), H2O(T_IC=T, p_IC=p_H2O_an_in)),
      liquid(H2O(T_IC=T)),
      graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_AnGDLs.html#FCSys.Regions.AnGDLs.AnGDL">AnGDLs.AnGDL</a> anGDL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(
      gas(H2(p_IC=p - p_H2O_an_in), H2O(
          T_IC=T,
          p_IC=p_H2O_an_in,
          initTransY=InitTranslational.velocitySS)),
      liquid(H2O(T_IC=T)),
      graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_AnCLs.html#FCSys.Regions.AnCLs.AnCL">AnCLs.AnCL</a> anCL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(
      ionomer(&#39;SO3-&#39;(T_IC=T)),
      gas(H2(p_IC=p - p_H2O_an_in), H2O(T_IC=T, p_IC=p_H2O_an_in)),
      liquid(H2O(T_IC=T)),
      graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_PEMs.html#FCSys.Regions.PEMs.PEM">PEMs.PEM</a> PEM(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(ionomer(&#39;H+&#39;(initTransX=InitTranslational.none), &#39;SO3-&#39;(T_IC=T))));

  <a href="FCSys_Regions_CaCLs.html#FCSys.Regions.CaCLs.CaCL">CaCLs.CaCL</a> caCL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(
      ionomer(&#39;SO3-&#39;(T_IC=T)),
      gas(
        H2O(T_IC=T, p_IC=p_H2O_ca_in),
        N2(p_IC=(p - p_H2O_ca_in)*(1 - environment.n_O2)),
        O2(p_IC=(p - p_H2O_ca_in)*environment.n_O2)),
      liquid(H2O(T_IC=T)),
      graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_CaGDLs.html#FCSys.Regions.CaGDLs.CaGDL">CaGDLs.CaGDL</a> caGDL(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(
      gas(
        H2O(T_IC=T, p_IC=p_H2O_ca_in),
        N2(p_IC=(p - p_H2O_ca_in)*(1 - environment.n_O2)),
        O2(p_IC=(p - p_H2O_ca_in)*environment.n_O2)),
      liquid(H2O(T_IC=T)),
      graphite(&#39;C+&#39;(T_IC=T))));

  <a href="FCSys_Regions_CaFPs.html#FCSys.Regions.CaFPs.CaFP">CaFPs.CaFP</a> caFP(
    <font color="blue">final </font>L_y=L_y,
    <font color="blue">final </font>L_z=L_z,
    Subregion(
      gas(
        H2O(T_IC=T, p_IC=p_H2O_ca_in),
        N2(p_IC=(p - p_H2O_ca_in)*(1 - environment.n_O2)),
        O2(p_IC=(p - p_H2O_ca_in)*environment.n_O2)),
      liquid(H2O(T_IC=T)),
      graphite(&#39;C+&#39;(T_IC=T))));
  <font color="darkgreen">//initTransY=InitTranslational.velocitySS</font>
  <font color="darkgreen">//,initTransY=InitTranslational.velocitySS</font>

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> anBC[n_y, n_z](<font color="blue">each </font>
      graphite(
      &#39;inclC+&#39;=true,
      &#39;incle-&#39;=true,
      &#39;C+&#39;(<font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,
          thermalSet(y=T)),
      &#39;e-&#39;(<font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,
          thermalSet(y=T))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> caBC[n_y, n_z](<font color="blue">each </font>
      graphite(
      &#39;inclC+&#39;=true,
      &#39;incle-&#39;=true,
      &#39;C+&#39;(<font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,
          thermalSet(y=T)),
      &#39;e-&#39;(
        <font color="blue">redeclare </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">Conditions.ByConnector.Face.Single.TranslationalNormal.force</a>,

        <font color="blue">redeclare </font><a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.Ramp">Modelica.Blocks.Sources.Ramp</a> normalSet(
          height=(8.55651e7 - 4.76856e7)*U.N,
          duration=225.1,
          offset=-8.55651e7*U.N,
          startTime=10.1),
        <font color="blue">redeclare </font><font color="blue">function</font> thermalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Thermal.html#FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature">FCSys.Conditions.ByConnector.Face.Single.Thermal.temperature</a>,

        thermalSet(y=T))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusEfforts">Conditions.ByConnector.FaceBus.Single.FaceBusEfforts</a> anSource[anFP.n_x, n_z](
      gas(
      <font color="blue">each </font>inclH2=true,
      <font color="blue">each </font>inclH2O=true,
      H2(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(anSource.gas.H2.normalOut.y - <font color="red">fill</font>(
              I_H2_an_in/A_an,
              anFP.n_x,
              n_z)) .* A_an_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T)),
      H2O(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(anSource.gas.H2O.normalOut.y - <font color="red">fill</font>(
              I_H2_an_in*p_H2O_an_in/((p - p_H2O_an_in)*A_an),
              anFP.n_x,
              n_z)) .* A_an_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> anSink[anFP.n_x, n_z](gas(
      <font color="blue">each </font>inclH2=true,
      <font color="blue">each </font>inclH2O=true,
      H2(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_an_out_noneq*A_an_seg .* anSink.gas.H2.face.rho ./ (
              anSink.gas.H2.face.rho + anSink.gas.H2O.face.rho))),
      H2O(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_an_out_noneq*A_an_seg .* anSink.gas.H2O.face.rho ./ (
              anSink.gas.H2.face.rho + anSink.gas.H2O.face.rho)))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusEfforts">Conditions.ByConnector.FaceBus.Single.FaceBusEfforts</a> caSource[caFP.n_x, n_z](
      gas(
      <font color="blue">each </font>inclH2O=true,
      <font color="blue">each </font>inclN2=true,
      <font color="blue">each </font>inclO2=true,
      H2O(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(caSource.gas.H2O.normalOut.y - <font color="red">fill</font>(
              I_O2_ca_in*p_H2O_ca_in/((p - p_H2O_ca_in)*n_O2*A_ca),
              caFP.n_x,
              n_z)) .* A_ca_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T)),
      N2(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(caSource.gas.N2.normalOut.y - <font color="red">fill</font>(
              I_O2_ca_in*(1 - n_O2)/(n_O2*A_ca),
              caFP.n_x,
              n_z)) .* A_ca_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.Translational.force</a>,

        <font color="blue">each </font>thermalSet(y=T)),
      O2(
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.current">FCSys.Conditions.ByConnector.Face.Single.Material.current</a>,

        materialSet(y=(caSource.gas.O2.normalOut.y - <font color="red">fill</font>(
              I_O2_ca_in/A_ca,
              caFP.n_x,
              n_z)) .* A_ca_seg),
        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_TranslationalNormal.html#FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.currentDensity</a>,

        <font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> normalSpec = <a href="FCSys_Conditions_ByConnector_Face_Single_Translational.html#FCSys.Conditions.ByConnector.Face.Single.Translational.force">FCSys.Conditions.ByConnector.Face.Single.TranslationalNormal.force</a>,

        <font color="blue">each </font>thermalSet(y=T))));

  <a href="FCSys_Conditions_ByConnector_FaceBus_Single.html#FCSys.Conditions.ByConnector.FaceBus.Single.FaceBusFlows">Conditions.ByConnector.FaceBus.Single.FaceBusFlows</a> caSink[caFP.n_x, n_z](gas(
      <font color="blue">each </font>inclH2O=true,
      <font color="blue">each </font>inclN2=true,
      <font color="blue">each </font>inclO2=true,
      H2O(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_ca_out_noneq*A_ca_seg .* caSink.gas.H2O.face.rho ./ (
              caSink.gas.H2O.face.rho + caSink.gas.N2.face.rho + caSink.gas.O2.face.rho))),

      N2(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_ca_out_noneq*A_ca_seg .* caSink.gas.N2.face.rho ./ (
              caSink.gas.H2O.face.rho + caSink.gas.N2.face.rho + caSink.gas.O2.face.rho))),

      O2(<font color="blue">redeclare </font><font color="blue">each </font><font color="blue">function</font> materialMeas = <a href="FCSys_Conditions_ByConnector_Face_Single_Material.html#FCSys.Conditions.ByConnector.Face.Single.Material.pressure">FCSys.Conditions.ByConnector.Face.Single.Material.pressure</a>
            (<font color="blue">redeclare </font><font color="blue">package</font> Data = <a href="FCSys_Characteristics_IdealGas.html#FCSys.Characteristics.IdealGas">FCSys.Characteristics.IdealGas</a>),
          normalSet(y=p_ca_out_noneq*A_ca_seg .* caSink.gas.O2.face.rho ./ (
              caSink.gas.H2O.face.rho + caSink.gas.N2.face.rho + caSink.gas.O2.face.rho)))));

<font color="blue">inner </font><a href="FCSys_Conditions.html#FCSys.Conditions.Environment">Conditions.Environment</a> environment(analysis=true, p=48.3*U.kPa + U.atm)
    <font color="darkgreen">&quot;Environmental conditions&quot;</font>;

  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> anPressSet(y(unit=&quot;m/(l.T2)&quot;) = p) <font color="darkgreen">
    &quot;Setpoint for the total anode outlet pressure&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> caPressSet(y(unit=&quot;m/(l.T2)&quot;) = p) <font color="darkgreen">
    &quot;Setpoint for the total cathode outlet pressure&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> anThermoPress(y(unit=&quot;m/(l.T2)&quot;) = <font color="red">sum</font>
      ((anSink.gas.H2.materialOut.y + anSink.gas.H2O.materialOut.y) .* <font color="red">
      outerProduct</font>(anFP.L_x, L_z))/A_an) <font color="darkgreen">
    &quot;Thermodynamic pressure at the anode outlet&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.RealExpression">Modelica.Blocks.Sources.RealExpression</a> caThermoPress(y(unit=&quot;m/(l.T2)&quot;) = <font color="red">sum</font>
      ((caSink.gas.H2O.materialOut.y + caSink.gas.N2.materialOut.y + caSink.gas.O2.materialOut.y)
       .* A_ca_seg)/A_ca) <font color="darkgreen">&quot;Thermodynamic pressure at the cathode outlet&quot;</font>;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Math.html#Modelica.Blocks.Math.Feedback">Modelica.Blocks.Math.Feedback</a> anNoneqSet;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Math.html#Modelica.Blocks.Math.Feedback">Modelica.Blocks.Math.Feedback</a> caNoneqSet;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Continuous.html#Modelica.Blocks.Continuous.FirstOrder">Modelica.Blocks.Continuous.FirstOrder</a> anValveDynamics(initType=Modelica.Blocks.Types.Init.InitialOutput,
      T=1) <font color="darkgreen">&quot;Dynamics of the anode exit valve&quot;</font>;

<font color="blue">protected </font>
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> p_an_out_noneq(unit=&quot;m/(l.T2)&quot;) <font color="darkgreen">
    &quot;Nonequilibrium pressure at the anode outlet&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> p_ca_out_noneq(unit=&quot;m/(l.T2)&quot;) <font color="darkgreen">
    &quot;Nonequilibrium pressure at the cathode outlet&quot;</font>;
<font color="blue">public </font>
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Continuous.html#Modelica.Blocks.Continuous.FirstOrder">Modelica.Blocks.Continuous.FirstOrder</a> caValveDynamics(initType=Modelica.Blocks.Types.Init.InitialOutput,
      T=1) <font color="darkgreen">&quot;Dynamics of the cathode exit valve&quot;</font>;
<font color="blue">equation </font>

  <font color="red">connect</font>(anFP.xPositive, anGDL.xNegative);
  <font color="red">connect</font>(anGDL.xPositive, anCL.xNegative);

  <font color="red">connect</font>(anCL.xPositive, PEM.xNegative);

  <font color="red">connect</font>(PEM.xPositive, caCL.xNegative);

  <font color="red">connect</font>(caCL.xPositive, caGDL.xNegative);

  <font color="red">connect</font>(caGDL.xPositive, caFP.xNegative);

  <font color="red">connect</font>(anSource.face, anFP.yNegative);
  <font color="red">connect</font>(anSink.face, anFP.yPositive);
  <font color="red">connect</font>(caSource.face, caFP.yNegative);
  <font color="red">connect</font>(caSink.face, caFP.yPositive);
  <font color="red">connect</font>(anBC.face, anFP.xNegative);

  <font color="red">connect</font>(caFP.xPositive, caBC.face);

  <font color="red">connect</font>(anValveDynamics.y, p_an_out_noneq);
  <font color="red">connect</font>(caPressSet.y, caNoneqSet.u1);
  <font color="red">connect</font>(caThermoPress.y, caNoneqSet.u2);
  <font color="red">connect</font>(anPressSet.y, anNoneqSet.u1);
  <font color="red">connect</font>(anNoneqSet.u2, anThermoPress.y);
  <font color="red">connect</font>(anNoneqSet.y, anValveDynamics.u);
  <font color="red">connect</font>(caValveDynamics.y, p_ca_out_noneq);
  <font color="red">connect</font>(caNoneqSet.y, caValveDynamics.u);
<font color="blue">end </font>FPToFPVoltage;
</pre>
      </div>
    </div>
  </div>
</div>
<div class="footer">
  &copy; Copyright 2012&ndash;2013, Kevin Davies, Georgia Tech Research Corporation. Last updated Tue Aug  6 13:07:13 2013.
</div>
</body>
</html>
