<html>
<head>
<title>FCSys.Conditions.TestStands</title>
<meta name="keywords" content="fuel cell library, FCSys, fuel cell, PEM, proton exchange membrane, polymer exchange membrance, PEMFC, Modelica, Dymola, electrochemistry">
<meta name="date" content="2013-4-2">
<meta name="description" content="Test stands">
<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="stylesheets/ModelicaDoc.css">
<link rel="shortcut icon" href="../resources/documentation/favicon.ico">
<script type="text/javascript" src="javascripts/analytics.js"></script>
</head>
<body>
<div class="sidebar">
  <div class="sidebarwrapper">
  <a href="index.html"><p class="sidebar-title">FCSys</p></a>
  <p class="logo"><a href="index.html">
    <img src="images/icon.gif" class="logo" alt="Logo" width=150>
  </a></p>

<h3>Table of Contents</h3>

<ul>
    <li><a href="FCSys_UsersGuide.html">User's Guide</a></li>
    <li><a href="FCSys_Blocks.html">Blocks</a></li>
    <li><a href="FCSys_Conditions.html">Conditions</a></li>
    <li><a href="FCSys_Assemblies.html">Assemblies</a></li>
    <li><a href="FCSys_Regions.html">Regions</a></li>
    <li><a href="FCSys_Subregions.html">Subregions</a></li>
    <li><a href="FCSys_Connectors.html">Connectors</a></li>
    <li><a href="FCSys_Characteristics.html">Characteristics</a></li>
    <li><a href="FCSys_Units.html">Units</a></li>
    <li><a href="FCSys_Quantities.html">Quantities</a></li>
    <li><a href="FCSys_BaseClasses.html">BaseClasses</a></li>
    </ul>

  <h3>Download</h3>
    <ul>
      <li>Latest: <a href="release/FCSys-2.0.zip" rel="nofollow">FCSys-2.0.zip</a> (**Please check back soon or contact kdavies4 at gmail.com.)</li>
    </ul>
  </div>
</div>

<div class="document">
  <div class="documentwrapper">
    <div class="bodywrapper">
      <div class="body">

<h2><a name="FCSys.Conditions.TestStands"></a><a href="FCSys_Conditions.html#FCSys.Conditions">FCSys.Conditions</a>.TestStands</h2>

<b>Test stands</b>

<h3>Information</h3>

Extends from <a href="http://build.openmodelica.org/Documentation/Modelica.Icons.Package.html#Modelica.Icons.Package">Modelica.Icons.Package</a> (Icon for standard packages), <a href="FCSys_BaseClasses_Icons.html#FCSys.BaseClasses.Icons.PackageUnderConstruction">FCSys.BaseClasses.Icons.PackageUnderConstruction</a> (Overlay to indicate that a package is in development).

<h3>Package Content</h3>

<table border=1 cellspacing=0 cellpadding=2 >
<tr><th>Name</th><th>Description</th></tr>
<tr><td><img src="images/FCSys.Conditions.TestStands.TestProfileS.png" alt="FCSys.Conditions.TestStands.TestProfile" width=20  height=20 align=top>&nbsp;<a href="FCSys_Conditions_TestStands.html#FCSys.Conditions.TestStands.TestProfile">TestProfile</a>
</td><td>Cell test profile</td></tr>
<tr><td><img src="images/FCSys.Conditions.TestStands.ReplayS.png" alt="FCSys.Conditions.TestStands.Replay" width=20  height=20 align=top>&nbsp;<a href="FCSys_Conditions_TestStands.html#FCSys.Conditions.TestStands.Replay">Replay</a>
</td><td>Regenerate signals recorded from HNEI&#39;s Greenlight FC test stand</td></tr>
<tr><td><img src="images/FCSys.Conditions.TestStands.BaseClassesS.png" alt="FCSys.Conditions.TestStands.BaseClasses" width=20  height=20 align=top>&nbsp;<a href="FCSys_Conditions_TestStands_BaseClasses.html#FCSys.Conditions.TestStands.BaseClasses">BaseClasses</a>
</td><td>Base classes (not generally for direct use)</td></tr>
</table>
<hr>

<h2><img src="images/FCSys.Conditions.TestStands.TestProfileI.png" alt="FCSys.Conditions.TestStands.TestProfile" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Conditions.TestStands.TestProfile"></a><a href="FCSys_Conditions_TestStands.html#FCSys.Conditions.TestStands">FCSys.Conditions.TestStands</a>.TestProfile</h2>
<b>Cell test profile</b><p>
<img src="images/FCSys.Conditions.TestStands.TestProfileD.png" alt="FCSys.Conditions.TestStands.TestProfile">

<h3>Information</h3>

Extends from <a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a> (Icon for runnable examples), <a href="FCSys_Conditions_TestStands_BaseClasses.html#FCSys.Conditions.TestStands.BaseClasses.PartialTestStandNoIO">BaseClasses.PartialTestStandNoIO</a> (Partial cell test stand without inputs/outputs).
<p>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> TestProfile <font color="darkgreen">&quot;Cell test profile&quot;</font>
  <font color="blue">extends </font><a href="http://build.openmodelica.org/Documentation/Modelica.Icons.html#Modelica.Icons.Example">Modelica.Icons.Example</a>;
  <font color="blue">extends </font><a href="FCSys_Conditions_TestStands_BaseClasses.html#FCSys.Conditions.TestStands.BaseClasses.PartialTestStandNoIO">BaseClasses.PartialTestStandNoIO</a>;

<font color="blue">end </font>TestProfile;
</pre>
<hr>

<h2><img src="images/FCSys.Conditions.TestStands.ReplayI.png" alt="FCSys.Conditions.TestStands.Replay" align=RIGHT border=1 width=80  height=80 >
<a name="FCSys.Conditions.TestStands.Replay"></a><a href="FCSys_Conditions_TestStands.html#FCSys.Conditions.TestStands">FCSys.Conditions.TestStands</a>.Replay</h2>
<b>Regenerate signals recorded from HNEI&#39;s Greenlight FC test stand</b><p>
<img src="images/FCSys.Conditions.TestStands.ReplayD.png" alt="FCSys.Conditions.TestStands.Replay">

<h3>Information</h3>

Extends from <a href="FCSys_BaseClasses_Icons_Blocks.html#FCSys.BaseClasses.Icons.Blocks.ContinuousShort">FCSys.BaseClasses.Icons.Blocks.ContinuousShort</a> (Short icon for a continuous block).
<p>

<h3>Parameters</h3>

<p>
<table border=1 cellspacing=0 cellpadding=2>
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td>Integer</td><td>n</td><td>1</td><td>index of the data set</td></tr>
<tr><td>Boolean</td><td>terminateMaxTime</td><td>true</td><td>Terminate at maximum time of source data</td></tr>
</table>
<p>

<h3>Connectors</h3>

<p>
<table border=1 cellspacing=0 cellpadding=2>
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputBus">RealOutputBus</a></td><td>y</td><td>Output signals as a bus</td></tr>
</table>
<p>

<h3>Modelica definition</h3>

<pre>
<font color="blue">model</font> Replay <font color="darkgreen">
  &quot;Regenerate signals recorded from HNEI&#39;s Greenlight FC test stand&quot;</font>
  <font color="blue">extends </font><a href="FCSys_BaseClasses_Icons_Blocks.html#FCSys.BaseClasses.Icons.Blocks.ContinuousShort">FCSys.BaseClasses.Icons.Blocks.ContinuousShort</a>;

  <font color="blue">parameter </font>Integer n(<font color="blue">final </font>min=1) = 1 <font color="darkgreen">&quot;index of the data set&quot;</font>;
  <font color="blue">parameter </font>Boolean terminateMaxTime=true <font color="darkgreen">
    &quot;Terminate at maximum time of source data&quot;</font>;

  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Sources.html#Modelica.Blocks.Sources.CombiTimeTable">Modelica.Blocks.Sources.CombiTimeTable</a> combiTimeTable(
    tableOnFile=true,
    extrapolation=Modelica.Blocks.Types.Extrapolation.HoldLastPoint,
    tableName=&quot;data&quot; + <font color="red">String</font>(n),
    fileName=&quot;FCSys/test/LOOCV/data.mat&quot;,
    columns=2:19,
    smoothness=Modelica.Blocks.Types.Smoothness.LinearSegments) <font color="darkgreen">
    &quot;Block to load and replay data&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputBus">Connectors.RealOutputBus</a> y <font color="darkgreen">&quot;Output signals as a bus&quot;</font>;

<font color="blue">protected </font>
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Math.html#Modelica.Blocks.Math.Add">Modelica.Blocks.Math.Add</a> sumAnMFC;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Math.html#Modelica.Blocks.Math.Add">Modelica.Blocks.Math.Add</a> sumCaMFC;

  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Math.html#Modelica.Blocks.Math.Gain">Modelica.Blocks.Math.Gain</a> from_V(k=U.V);
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Math.html#Modelica.Blocks.Math.Gain">Modelica.Blocks.Math.Gain</a> &#39;from1_%&#39;(k=U.'%');
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Math.html#Modelica.Blocks.Math.Gain">Modelica.Blocks.Math.Gain</a> &#39;from2_%&#39;(k=U.'%');
  <a href="FCSys_Blocks_UnitConversions.html#FCSys.Blocks.UnitConversions.From_kPag">Blocks.UnitConversions.From_kPag</a> from1_kPag;
  <a href="FCSys_Blocks_UnitConversions.html#FCSys.Blocks.UnitConversions.From_kPag">Blocks.UnitConversions.From_kPag</a> from2_kPag;
  <a href="FCSys_Blocks_UnitConversions.html#FCSys.Blocks.UnitConversions.From_kPag">Blocks.UnitConversions.From_kPag</a> from3_kPag;
  <a href="FCSys_Blocks_UnitConversions.html#FCSys.Blocks.UnitConversions.From_kPag">Blocks.UnitConversions.From_kPag</a> from4_kPag;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Math.html#Modelica.Blocks.Math.Gain">Modelica.Blocks.Math.Gain</a> from1_LPM(k=U.L/U.min);
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Math.html#Modelica.Blocks.Math.Gain">Modelica.Blocks.Math.Gain</a> from2_LPM(k=U.L/U.min);
  <a href="FCSys_Blocks_UnitConversions.html#FCSys.Blocks.UnitConversions.From_degC">Blocks.UnitConversions.From_degC</a> from1_degC;
  <a href="FCSys_Blocks_UnitConversions.html#FCSys.Blocks.UnitConversions.From_degC">Blocks.UnitConversions.From_degC</a> from2_degC;
  <a href="FCSys_Blocks_UnitConversions.html#FCSys.Blocks.UnitConversions.From_degC">Blocks.UnitConversions.From_degC</a> from3_degC;
  <a href="FCSys_Blocks_UnitConversions.html#FCSys.Blocks.UnitConversions.From_degC">Blocks.UnitConversions.From_degC</a> from4_degC;
  <a href="FCSys_Blocks_UnitConversions.html#FCSys.Blocks.UnitConversions.From_degC">Blocks.UnitConversions.From_degC</a> from5_degC;
  <a href="FCSys_Blocks_UnitConversions.html#FCSys.Blocks.UnitConversions.From_degC">Blocks.UnitConversions.From_degC</a> from6_degC;
  <a href="http://build.openmodelica.org/Documentation/Modelica.Blocks.Math.html#Modelica.Blocks.Math.Gain">Modelica.Blocks.Math.Gain</a> from_A(k=U.A);

  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> v(<font color="blue">final </font>unit=&quot;l2.m/(N.T2)&quot;) <font color="darkgreen">
    &quot;CVM Cell 1 Voltage&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> RHAnFPNegX(
    <font color="blue">final </font>unit=&quot;1&quot;,
    displayUnit=&quot;%&quot;,
    <font color="blue">final </font>min=0) <font color="darkgreen">&quot;Anode inlet RH&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> RHCaFPNegX(
    <font color="blue">final </font>unit=&quot;1&quot;,
    displayUnit=&quot;%&quot;,
    <font color="blue">final </font>min=0) <font color="darkgreen">&quot;Cathode inlet RH&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> p_anFPNegY(<font color="blue">final </font>unit=&quot;m/(l.T2)&quot;) <font color="darkgreen">
    &quot;Pressure anode inlet&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> p_anFPPosY(<font color="blue">final </font>unit=&quot;m/(l.T2)&quot;, <font color="blue">final </font>min=0) <font color="darkgreen">
    &quot;Pressure anode outlet&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> p_caFPNegY(<font color="blue">final </font>unit=&quot;m/(l.T2)&quot;) <font color="darkgreen">
    &quot;Pressure cathode inlet&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> p_caFPPosY(<font color="blue">final </font>unit=&quot;m/(l.T2)&quot;, <font color="blue">final </font>min=0) <font color="darkgreen">
    &quot;Pressure anode outlet&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> Vdot_anFPNegY_H2(<font color="blue">final </font>unit=&quot;l3/T&quot;) <font color="darkgreen">
    &quot;Flow anode H2 MFC&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> Vdot_caFPNegY_air(<font color="blue">final </font>unit=&quot;l3/T&quot;) <font color="darkgreen">
    &quot;Flow cathode H2 MFC&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> T_anFPNegY(
    <font color="blue">final </font>unit=&quot;l2.m/(N.T2)&quot;,
    displayUnit=&quot;K&quot;,
    <font color="blue">final </font>min=0) <font color="darkgreen">&quot;Temperature anode inlet&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> T_anFPPosY(
    <font color="blue">final </font>unit=&quot;l2.m/(N.T2)&quot;,
    displayUnit=&quot;K&quot;,
    <font color="blue">final </font>min=0) <font color="darkgreen">&quot;Temperature anode outlet&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> T_caFPNegY(
    <font color="blue">final </font>unit=&quot;l2.m/(N.T2)&quot;,
    displayUnit=&quot;K&quot;,
    <font color="blue">final </font>min=0) <font color="darkgreen">&quot;Temperature cathode inlet&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> T_caFPPosY(
    <font color="blue">final </font>unit=&quot;l2.m/(N.T2)&quot;,
    displayUnit=&quot;K&quot;,
    <font color="blue">final </font>min=0) <font color="darkgreen">&quot;Temperature cathode outlet&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> T_anFPX(
    <font color="blue">final </font>unit=&quot;l2.m/(N.T2)&quot;,
    displayUnit=&quot;K&quot;,
    <font color="blue">final </font>min=0) <font color="darkgreen">&quot;Temperature end plate anode&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> T_caFPX(
    <font color="blue">final </font>unit=&quot;l2.m/(N.T2)&quot;,
    displayUnit=&quot;K&quot;,
    <font color="blue">final </font>min=0) <font color="darkgreen">&quot;Temperature end plate cathode&quot;</font>;
  <a href="FCSys_Connectors.html#FCSys.Connectors.RealOutputInternal">Connectors.RealOutputInternal</a> I(<font color="blue">final </font>unit=&quot;N/T&quot;) <font color="darkgreen">&quot;Measured load&quot;</font>;

<font color="blue">equation </font>
  <font color="darkgreen">//  Terminate as desired</font>
  <font color="blue">if </font>terminateMaxTime<font color="blue"> then</font>
    <font color="blue">when </font>time &gt; combiTimeTable.t_max<font color="blue"> then</font>
      <font color="red">terminate</font>(&quot;The end of the data has been reached.&quot;);
    <font color="blue">end when</font>;
  <font color="blue">end if</font>;

  <font color="darkgreen">// Connections from source to unit conversion</font>
  <font color="red">connect</font>(from_V.u, combiTimeTable.y[1]);

  <font color="red">connect</font>('from1_%'.u, combiTimeTable.y[2]);

  <font color="red">connect</font>('from2_%'.u, combiTimeTable.y[3]);

  <font color="red">connect</font>(from1_kPag.u, combiTimeTable.y[4]);
  <font color="red">connect</font>(from2_kPag.u, combiTimeTable.y[5]);
  <font color="red">connect</font>(from3_kPag.u, combiTimeTable.y[6]);
  <font color="red">connect</font>(from4_kPag.u, combiTimeTable.y[7]);
  <font color="red">connect</font>(sumAnMFC.u1, combiTimeTable.y[8]);
  <font color="red">connect</font>(sumAnMFC.u2, combiTimeTable.y[9]);
  <font color="red">connect</font>(sumCaMFC.u1, combiTimeTable.y[10]);
  <font color="red">connect</font>(sumCaMFC.u2, combiTimeTable.y[11]);
  <font color="red">connect</font>(from1_degC.u, combiTimeTable.y[12]);
  <font color="red">connect</font>(from2_degC.u, combiTimeTable.y[13]);
  <font color="red">connect</font>(from3_degC.u, combiTimeTable.y[14]);
  <font color="red">connect</font>(from4_degC.u, combiTimeTable.y[15]);
  <font color="red">connect</font>(from5_degC.u, combiTimeTable.y[16]);
  <font color="red">connect</font>(from6_degC.u, combiTimeTable.y[17]);
  <font color="red">connect</font>(from_A.u, combiTimeTable.y[18]);

  <font color="darkgreen">// Connections from unit conversion to internal outputs</font>
  <font color="red">connect</font>(v, from_V.y);
  <font color="red">connect</font>(RHAnFPNegX, 'from1_%'.y);
  <font color="red">connect</font>(RHCaFPNegX, 'from2_%'.y);
  <font color="red">connect</font>(p_anFPNegY, from1_kPag.y);
  <font color="red">connect</font>(p_anFPPosY, from2_kPag.y);
  <font color="red">connect</font>(p_caFPNegY, from3_kPag.y);
  <font color="red">connect</font>(p_caFPPosY, from4_kPag.y);
  <font color="red">connect</font>(Vdot_anFPNegY_H2, from1_LPM.y);
  <font color="red">connect</font>(Vdot_caFPNegY_air, from2_LPM.y);
  <font color="red">connect</font>(T_anFPNegY, from1_degC.y);
  <font color="red">connect</font>(T_anFPPosY, from2_degC.y);
  <font color="red">connect</font>(T_caFPNegY, from3_degC.y);
  <font color="red">connect</font>(T_caFPPosY, from4_degC.y);
  <font color="red">connect</font>(T_anFPX, from5_degC.y);
  <font color="red">connect</font>(T_caFPX, from6_degC.y);
  <font color="red">connect</font>(I, from_A.y);

  <font color="darkgreen">// Summations</font>
  <font color="red">connect</font>(sumAnMFC.y, from1_LPM.u);

  <font color="red">connect</font>(sumCaMFC.y, from2_LPM.u);

  <font color="darkgreen">// Connections from internal outputs to public output</font>
  <font color="red">connect</font>(v, y.v);

  <font color="red">connect</font>(RHAnFPNegX, y.RHAnFPNegX);

  <font color="red">connect</font>(RHCaFPNegX, y.RHCaFPNegX);

  <font color="red">connect</font>(p_anFPNegY, y.p_anFPNegY);

  <font color="red">connect</font>(p_anFPPosY, y.p_anFPPosY);

  <font color="red">connect</font>(p_caFPNegY, y.p_caFPNegY);

  <font color="red">connect</font>(p_caFPPosY, y.p_caFPPosY);

  <font color="red">connect</font>(Vdot_anFPNegY_H2, y.Vdot_anFPNegY_H2);

  <font color="red">connect</font>(Vdot_caFPNegY_air, y.Vdot_caFPNegY_air);
  <font color="red">connect</font>(T_anFPNegY, y.T_anFPNegY);
  <font color="red">connect</font>(T_anFPPosY, y.T_anFPPosY);
  <font color="red">connect</font>(T_caFPNegY, y.T_caFPNegY);
  <font color="red">connect</font>(T_caFPPosY, y.T_caFPPosY);
  <font color="red">connect</font>(T_anFPX, y.T_anFPX);

  <font color="red">connect</font>(T_caFPX, y.T_caFPX);

  <font color="red">connect</font>(I, y.I);
<font color="blue">end </font>Replay;
</pre>
      </div>
    </div>
  </div>
</div>
<div class="footer">
  &copy; Copyright 2012, Kevin Davies, Georgia Tech Research Corporation. Last updated Tue Apr  2 18:49:40 2013.
</div>
</body>
</html>
